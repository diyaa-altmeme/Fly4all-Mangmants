(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{13496:(e,s,a)=>{"use strict";a.d(s,{$m:()=>o,As:()=>c,nD:()=>d,ub:()=>x});var l=a(95155),r=a(12115),t=a(58609),n=a(59007),i=a(64269);let d=t.bL,c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,l.jsx)(t.q7,{ref:s,className:(0,i.cn)("border-b",a),...r})});c.displayName="AccordionItem";let o=r.forwardRef((e,s)=>{let{className:a,children:r,...d}=e;return(0,l.jsx)(t.Y9,{className:"flex",children:(0,l.jsxs)(t.l9,{ref:s,className:(0,i.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:no-underline data-[state=open]:text-primary [&[data-state=open]>svg]:rotate-180",a),...d,children:[r,(0,l.jsx)(n.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});o.displayName=t.l9.displayName;let x=r.forwardRef((e,s)=>{let{className:a,children:r,...n}=e;return(0,l.jsx)(t.UC,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:(0,l.jsx)("div",{className:(0,i.cn)("pb-4 pt-0",a),children:r})})});x.displayName=t.UC.displayName},15237:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>T});var l=a(95155),r=a(12115),t=a(85897),n=a(3998),i=a(86948),d=a(50346),c=a(47974),o=a(89679),x=a(10639),m=a(5225),u=a(12941),h=a(93169),j=a(40671),f=a(90576),p=a(36204),N=a(26991),g=a(98128),v=a(47734),b=a(73697),w=a(16533),y=a(20243),S=a(30926);let k=(0,S.createServerReference)("40ae0e29432bdb6b52ae7940272edc3e9227a621b7",S.callServer,void 0,S.findSourceMapURL,"getUserProfileStats"),A=(0,S.createServerReference)("6047a1a74fab99054e5a53a2c2e7f64dabaacec2d3",S.callServer,void 0,S.findSourceMapURL,"getNotificationsForUser");var C=a(41895),R=a(76422),U=a(52619),E=a.n(U),B=a(86259),L=a(64269),Z=a(20063),_=a(16601),P=a(80187),$=a(27446),z=a(23451),D=a(38220),W=a(11647),F=a(13496);function K(e){let{user:s}=e;return s&&s.permissions?"admin"===s.role?(0,l.jsx)("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200",children:(0,l.jsx)("p",{className:"font-bold text-green-700 dark:text-green-300",children:"لديك صلاحيات مدير النظام الكاملة."})}):(0,l.jsx)(F.nD,{type:"multiple",className:"w-full space-y-2",children:D.Mh.map(e=>{let a=e.permissions.filter(e=>s.permissions.includes(e.id));return 0===a.length?null:(0,l.jsxs)(F.As,{value:e.id,children:[(0,l.jsx)(F.$m,{className:"p-3 bg-muted/50 rounded-md font-bold hover:no-underline",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(e.icon,{className:"h-5 w-5 text-primary"}),e.name]})}),(0,l.jsx)(F.ub,{className:"p-4",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(e=>(0,l.jsx)(W.E,{variant:"secondary",children:e.name},e.id))})})]},e.id)})}):(0,l.jsx)("p",{children:"لا توجد صلاحيات لعرضها."})}let M=e=>{let{icon:s,label:a,value:r,currency:t,colorClass:n}=e;return(0,l.jsxs)("div",{className:"flex items-center p-4 bg-background rounded-2xl border shadow-sm hover:shadow-lg transition-all hover:-translate-y-1",children:[(0,l.jsx)("div",{className:(0,L.cn)("p-3 rounded-full mr-4",n),children:(0,l.jsx)(s,{className:"h-6 w-6 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground font-bold",children:a}),(0,l.jsxs)("div",{className:"text-2xl font-bold",children:[r," ",(0,l.jsx)("span",{className:"text-sm",children:t})]})]})]})},O=e=>{let{user:s,boxes:a,roles:r,onUserUpdated:m}=e;return(0,l.jsxs)(i.Zp,{className:"overflow-hidden",children:[(0,l.jsx)("div",{className:"relative h-32 bg-gradient-to-r from-primary to-accent",children:(0,l.jsxs)(t.eu,{className:"w-28 h-28 border-4 border-background absolute -bottom-14 right-6 shadow-md",children:[(0,l.jsx)(t.BK,{src:s.avatarUrl,alt:s.name}),(0,l.jsx)(t.q5,{className:"text-4xl",children:(0,l.jsx)(d.A,{className:"h-20 w-20 text-muted-foreground"})})]})}),(0,l.jsx)(i.aR,{className:"pt-20",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[(0,l.jsxs)("div",{className:"text-center sm:text-right w-full sm:w-auto",children:[(0,l.jsx)(i.ZB,{className:"text-2xl sm:text-3xl font-bold",children:s.name}),(0,l.jsxs)(i.BT,{className:"text-sm sm:text-base text-muted-foreground mt-1",children:["@",s.username," | ",s.position||"موظف"]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center sm:justify-start gap-2 sm:gap-4 mt-2 text-sm text-muted-foreground",children:[(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.A,{className:"h-4 w-4"})," ",s.email]}),(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(o.A,{className:"h-4 w-4"})," ",s.phone]}),(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.A,{className:"h-4 w-4"})," ",s.department||"القسم العام"]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[(0,l.jsx)(_.A,{isEditing:!0,user:s,boxes:a,roles:r,onUserUpdated:m,children:(0,l.jsx)(n.$,{variant:"outline",className:"w-full sm:w-auto",children:"تعديل الملف الشخصي"})}),(0,l.jsx)(n.$,{className:"w-full sm:w-auto",children:"تغيير كلمة المرور"})]})]})})]})};function T(){let[e,s]=(0,r.useState)(null),[a,t]=(0,r.useState)([]),[d,c]=(0,r.useState)([]),[o,x]=(0,r.useState)(null),[S,U]=(0,r.useState)([]),[L,_]=(0,r.useState)(!0),D=(0,Z.useRouter)(),{user:W}=(0,z.A)(),F=r.useCallback(async()=>{if(_(!0),!W)return void _(!1);if(!("role"in W)){D.push("/"),_(!1);return}s(W);let[e,a,l,r]=await Promise.all([k(W.name),A(W.uid,{limit:5}),(0,P.c)(),(0,$.O)()]);x(e),U(a),t(l),c(r),_(!1)},[D,W]);return((0,r.useEffect)(()=>{F()},[F]),L)?(0,l.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,l.jsx)(y.E,{className:"h-48 w-full rounded-2xl"}),(0,l.jsx)(y.E,{className:"h-24 w-full rounded-2xl"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,l.jsx)(y.E,{className:"h-64 w-full lg:col-span-2 rounded-2xl"}),(0,l.jsx)(y.E,{className:"h-64 w-full rounded-2xl"})]})]}):e?(e.attendance,e.baseSalary,e.bonuses,e.deductions,null==o||o.totalProfit,(0,l.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,l.jsx)(O,{user:e,boxes:a,roles:d,onUserUpdated:F}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsx)(M,{icon:m.A,label:"السندات المدخلة",value:(null==o?void 0:o.vouchersCount)||0,colorClass:"bg-blue-500"}),(0,l.jsx)(M,{icon:u.A,label:"التذاكر المدخلة",value:(null==o?void 0:o.bookingsCount)||0,colorClass:"bg-orange-500"}),(0,l.jsx)(M,{icon:h.A,label:"الفيز المدخلة",value:(null==o?void 0:o.visasCount)||0,colorClass:"bg-fuchsia-500"}),(0,l.jsx)(M,{icon:j.A,label:"إجمالي الأرباح",value:(null==o?void 0:o.totalProfit.toFixed(2))||"0.00",currency:"USD",colorClass:"bg-green-500"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 items-start",children:[(0,l.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"الصلاحيات الممنوحة"}),(0,l.jsx)(i.BT,{children:"قائمة بالصلاحيات التي يمكنك الوصول إليها في النظام بناءً على دورك."})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsx)(K,{user:e})})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsx)(i.ZB,{children:"النشاط العام"}),(0,l.jsx)(i.BT,{children:"عدد العمليات التي قمت بها خلال الأشهر الماضية."})]}),(0,l.jsx)(i.Wu,{className:"h-72",children:(0,l.jsx)(N.u,{width:"100%",height:"100%",children:(0,l.jsxs)(g.E,{data:[],children:[(0,l.jsx)(v.W,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,l.jsx)(b.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,l.jsx)(w.y,{dataKey:"total",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsx)(i.aR,{children:(0,l.jsx)(i.ZB,{children:"آخر الإشعارات"})}),(0,l.jsx)(i.Wu,{children:0===S.length?(0,l.jsx)("p",{className:"text-muted-foreground text-center p-4",children:"لا توجد إشعارات."}):(0,l.jsx)("div",{className:"space-y-4",children:S.map((e,s)=>(0,l.jsxs)(r.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"p-2 bg-muted rounded-full",children:(0,l.jsx)(f.A,{className:"h-5 w-5 text-primary"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(E(),{href:e.link||"#",className:"font-semibold hover:underline",children:e.title}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:e.body}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,C.m)(new Date(e.createdAt),{addSuffix:!0,locale:R.ar})})]})]}),s<S.length-1&&(0,l.jsx)(B.Separator,{})]},e.id))})}),(0,l.jsx)(i.wL,{children:(0,l.jsx)(n.$,{asChild:!0,variant:"secondary",className:"w-full",children:(0,l.jsxs)(E(),{href:"/notifications",children:["عرض كل الإشعارات",(0,l.jsx)(p.A,{className:"h-4 w-4 mr-2"})]})})})]})]})]})):(0,l.jsx)("div",{children:"لم يتم العثور على بيانات المستخدم."})}},86259:(e,s,a)=>{"use strict";a.d(s,{Separator:()=>i});var l=a(95155),r=a(12115),t=a(57268),n=a(64269);let i=r.forwardRef((e,s)=>{let{className:a,orientation:r="horizontal",decorative:i=!0,...d}=e;return(0,l.jsx)(t.b,{ref:s,decorative:i,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...d})});i.displayName=t.b.displayName},93199:(e,s,a)=>{Promise.resolve().then(a.bind(a,15237))}},e=>{e.O(0,[9135,7210,4909,9625,315,5111,4127,9967,1374,783,8994,2619,43,1583,4175,8503,4762,4271,8441,1255,7358],()=>e(e.s=93199)),_N_E=e.O()}]);