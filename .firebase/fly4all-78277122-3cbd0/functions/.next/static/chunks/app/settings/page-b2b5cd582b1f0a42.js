(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4662],{24896:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});var n=a(95155),t=a(93037),c=a(34486);function r(){return(0,n.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,n.jsx)(c.P.div,{animate:{y:[0,-10,0],rotate:[0,5,0,-5,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:(0,n.jsx)(t.A,{className:"h-16 w-16 text-primary"})})})}},31868:(e,s,a)=>{"use strict";a.d(s,{default:()=>o});var n=a(95155),t=a(12115),c=a(20063),r=a(18332),l=a(7545),i=a(23451),d=a(24896);function o(e){let{children:s,requiredPermission:a}=e,{user:o,loading:x,hasPermission:u}=(0,i.A)(),m=(0,c.useRouter)(),[h,j]=(0,t.useState)(!1);return((0,t.useEffect)(()=>{if(!x){if(!o)return void m.replace("/auth/login");a&&!u(a)?j(!1):j(!0)}},[o,x,a,u,m]),x||!h)?x||h||!o?(0,n.jsx)(d.A,{}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,n.jsxs)(r.Fc,{variant:"destructive",className:"max-w-md",children:[(0,n.jsx)(l.A,{className:"h-4 w-4"}),(0,n.jsx)(r.XL,{children:"وصول مرفوض!"}),(0,n.jsx)(r.TN,{children:"ليس لديك الصلاحية المطلوبة للوصول إلى هذه الصفحة. يرجى التواصل مع مدير النظام."})]})}):(0,n.jsx)(n.Fragment,{children:s})}},35656:(e,s,a)=>{"use strict";a.d(s,{l:()=>t});var n=a(30926);let t=(0,n.createServerReference)("40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3",n.callServer,void 0,n.findSourceMapURL,"getUsers")},37030:(e,s,a)=>{"use strict";a.d(s,{S:()=>t});var n=a(30926);let t=(0,n.createServerReference)("7f4587568c1e868c07486b8dc08163d3dd703caa89",n.callServer,void 0,n.findSourceMapURL,"getChartOfAccounts")},41732:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>c});var n=a(12115),t=a(20063);function c(){let e=(0,t.useRouter)();return(0,n.useEffect)(()=>{e.push("/coming-soon")},[e]),null}},51479:(e,s,a)=>{Promise.resolve().then(a.bind(a,69347))},52514:(e,s,a)=>{"use strict";a.d(s,{f:()=>t});var n=a(30926);let t=(0,n.createServerReference)("009987d8158f99de874014e543c2eb4bd257578535",n.callServer,void 0,n.findSourceMapURL,"getWhatsappAccounts")},59564:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var n=a(95155),t=a(12115),c=a(86948),r=a(3998),l=a(92033),i=a(73180),d=a(30926);let o=(0,d.createServerReference)("00f8105cf2df698dda196c821059bffd2c12bb65d6",d.callServer,void 0,d.findSourceMapURL,"getSequences"),x=(0,d.createServerReference)("60bfff327e3bf73dac5fa7bb6d2690e1fed6e5cf56",d.callServer,void 0,d.findSourceMapURL,"updateSequence");var u=a(15894),m=a(20243),h=a(87270),j=a(65142),p=a(60013);function f(){let[e,s]=(0,t.useState)([]),[a,d]=(0,t.useState)(!0),[f,v]=(0,t.useState)({}),{toast:g}=(0,u.dj)(),b=(0,t.useCallback)(async()=>{d(!0);try{let e=await o();s(e)}catch(e){g({title:"خطأ",description:"فشل تحميل بيانات التسلسل.",variant:"destructive"})}finally{d(!1)}},[g]);(0,t.useEffect)(()=>{b()},[b]);let N=(e,a,n)=>{let t="value"===a?parseInt(n,10)||0:n.toUpperCase();s((0,p.jM)(s=>{let n=s.find(s=>s.id===e);n&&(n[a]=t)}))},S=async e=>{v(s=>({...s,[e.id]:!0}));try{let s=await x(e.id,{prefix:e.prefix,value:e.value,label:e.label});s.success?g({title:'تم تحديث تسلسل "'.concat(e.label,'"')}):g({title:"خطأ",description:s.error,variant:"destructive"})}catch(e){g({title:"خطأ",description:e.message,variant:"destructive"})}finally{v(s=>({...s,[e.id]:!1}))}};return(0,n.jsxs)(c.Zp,{children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:"عدادات الفواتير"}),(0,n.jsx)(c.BT,{children:"الرقم التالي في التسلسل سيكون الرقم الظاهر هنا + 1. قم بتعديل البادئة أو الرقم ثم اضغط حفظ للصف."})]}),(0,n.jsx)(c.Wu,{children:a?(0,n.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,n.jsx)(m.E,{className:"h-12 w-full"},s))}):(0,n.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,n.jsxs)(h.XI,{children:[(0,n.jsx)(h.A0,{children:(0,n.jsxs)(h.Hj,{children:[(0,n.jsx)(h.nd,{children:"نوع السند"}),(0,n.jsx)(h.nd,{children:"البادئة الحالية"}),(0,n.jsx)(h.nd,{children:"الرقم الحالي"}),(0,n.jsx)(h.nd,{children:"تعديل البادئة"}),(0,n.jsx)(h.nd,{children:"إعادة تعيين الرقم"}),(0,n.jsx)(h.nd,{className:"text-center",children:"إجراء"})]})}),(0,n.jsx)(h.BF,{children:e.map(e=>(0,n.jsxs)(h.Hj,{children:[(0,n.jsx)(h.nA,{className:"font-semibold",children:e.label}),(0,n.jsx)(h.nA,{className:"font-mono text-primary",children:e.prefix}),(0,n.jsx)(h.nA,{className:"font-mono",children:e.value}),(0,n.jsx)(h.nA,{children:(0,n.jsx)(j.p,{value:e.prefix,onChange:s=>N(e.id,"prefix",s.target.value),className:"w-24 font-mono"})}),(0,n.jsx)(h.nA,{children:(0,n.jsx)(j.p,{type:"number",value:e.value,onChange:s=>N(e.id,"value",s.target.value),className:"w-32 font-mono"})}),(0,n.jsx)(h.nA,{className:"text-center",children:(0,n.jsx)(r.$,{size:"sm",onClick:()=>S(e),disabled:f[e.id],children:f[e.id]?(0,n.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(i.A,{className:"h-4 w-4"})})})]},e.prefix))})]})})})]})}},65006:(e,s,a)=>{"use strict";a.d(s,{A:()=>Z});var n=a(95155),t=a(12115),c=a(3998),r=a(51834),l=a(45444),i=a(86948),d=a(22452),o=a(92033),x=a(28263),u=a(88964),m=a(13630),h=a(15894),j=a(73180),p=a(22544),f=a(54879),v=a(66942),g=a(41052),b=a(65142),N=a(44846),S=a(30926);let A=(0,S.createServerReference)("60ab3d606e7fd8fc4042d526bde8444e0d642058ea",S.callServer,void 0,S.findSourceMapURL,"updateWhatsappAccount"),w=(0,S.createServerReference)("40084f2c4ea3e6de914d9ccec37e1cc9e6c948440a",S.callServer,void 0,S.findSourceMapURL,"addWhatsappAccount");var y=a(11186);let C=f.Ik({name:f.Yj().min(2,"اسم الحساب مطلوب."),provider:f.k5(["ultramsg","green-api"]).default("ultramsg"),idInstance:f.Yj().min(5,"معرف النسخة مطلوب."),apiTokenInstance:f.Yj().min(10,"التوكن مطلوب."),isDefault:f.zM().default(!1)});function R(e){let{isEditing:s=!1,account:a,onSaveSuccess:l,children:i}=e,[d,x]=(0,t.useState)(!1),{toast:u}=(0,h.dj)(),m=(0,p.mN)({resolver:(0,v.u)(C),defaultValues:s&&a?a:{name:"",provider:"ultramsg",idInstance:"",apiTokenInstance:"",isDefault:!1}}),{isSubmitting:f}=m.formState,S=async e=>{try{let n;if((n=s&&a?await A(a.id,e):await w(e)).success)u({title:"تم ".concat(s?"تحديث":"إضافة"," الحساب بنجاح")}),l(),x(!1);else throw Error(n.error)}catch(e){u({title:"خطأ",description:e.message,variant:"destructive"})}};return(0,n.jsxs)(r.lG,{open:d,onOpenChange:x,children:[(0,n.jsx)(r.zM,{asChild:!0,children:i}),(0,n.jsx)(r.Cf,{className:"sm:max-w-md",children:(0,n.jsx)(g.lV,{...m,children:(0,n.jsxs)("form",{onSubmit:m.handleSubmit(S),children:[(0,n.jsxs)(r.c7,{children:[(0,n.jsx)(r.L3,{children:s?"تعديل حساب":"إضافة حساب جديد"}),(0,n.jsx)(r.rr,{children:"أدخل بيانات حساب WhatsApp الخاص بك."})]}),(0,n.jsxs)("div",{className:"py-4 grid gap-4",children:[(0,n.jsx)(g.zB,{control:m.control,name:"provider",render:e=>{let{field:s}=e;return(0,n.jsxs)(g.eI,{children:[(0,n.jsx)(g.lR,{children:"مزود الخدمة"}),(0,n.jsxs)(y.l6,{onValueChange:s.onChange,value:s.value,children:[(0,n.jsx)(g.MJ,{children:(0,n.jsx)(y.bq,{children:(0,n.jsx)(y.yv,{})})}),(0,n.jsxs)(y.gC,{children:[(0,n.jsx)(y.eb,{value:"ultramsg",children:"ultramsg.com"}),(0,n.jsx)(y.eb,{value:"green-api",children:"green-api.com"})]})]}),(0,n.jsx)(g.C5,{})]})}}),(0,n.jsx)(g.zB,{control:m.control,name:"name",render:e=>{let{field:s}=e;return(0,n.jsxs)(g.eI,{children:[(0,n.jsx)(g.lR,{children:"الاسم المميز للحساب"}),(0,n.jsx)(g.MJ,{children:(0,n.jsx)(b.p,{...s,placeholder:"مثال: حساب الشركة الرئيسي"})}),(0,n.jsx)(g.C5,{})]})}}),(0,n.jsx)(g.zB,{control:m.control,name:"idInstance",render:e=>{let{field:s}=e;return(0,n.jsxs)(g.eI,{children:[(0,n.jsx)(g.lR,{children:"Instance ID"}),(0,n.jsx)(g.MJ,{children:(0,n.jsx)(b.p,{...s})}),(0,n.jsx)(g.C5,{})]})}}),(0,n.jsx)(g.zB,{control:m.control,name:"apiTokenInstance",render:e=>{let{field:s}=e;return(0,n.jsxs)(g.eI,{children:[(0,n.jsx)(g.lR,{children:"Token"}),(0,n.jsx)(g.MJ,{children:(0,n.jsx)(b.p,{type:"password",...s})}),(0,n.jsx)(g.C5,{})]})}}),(0,n.jsx)(g.zB,{control:m.control,name:"isDefault",render:e=>{let{field:s}=e;return(0,n.jsxs)(g.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,n.jsx)(g.lR,{children:"تعيين كافتراضي"}),(0,n.jsx)(g.MJ,{children:(0,n.jsx)(N.d,{checked:s.value,onCheckedChange:s.onChange})})]})}})]}),(0,n.jsx)(r.Es,{children:(0,n.jsxs)(c.$,{type:"submit",disabled:f,children:[f?(0,n.jsx)(o.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,n.jsx)(j.A,{className:"me-2 h-4 w-4"}),s?"حفظ التعديلات":"إضافة الحساب"]})})]})})})]})}var I=a(52514);let k=(0,S.createServerReference)("40bebf67ac032a6829a4f046709f724a00a4f8d315",S.callServer,void 0,S.findSourceMapURL,"deleteWhatsappAccount");var L=a(6259),M=a(98053),_=a(64269),E=a(11647);function B(e){let{onSaveSuccess:s}=e,[a,r]=(0,t.useState)([]),[l,j]=(0,t.useState)(!0),{toast:p}=(0,h.dj)(),f=(0,t.useCallback)(async()=>{j(!0);let e=await (0,I.f)();e.success&&e.accounts?r(e.accounts):p({title:"خطأ",description:e.error,variant:"destructive"}),j(!1)},[p]);(0,t.useEffect)(()=>{f()},[f]);let v=()=>{f(),s()},g=async e=>{let s=await k(e);s.success?(p({title:"تم حذف الحساب بنجاح"}),v()):p({title:"خطأ",description:s.error,variant:"destructive"})};return(0,n.jsxs)(i.Zp,{className:"border-none shadow-none",children:[(0,n.jsxs)(i.aR,{className:"flex flex-row justify-between items-start px-0",children:[(0,n.jsx)("div",{children:(0,n.jsx)(i.ZB,{className:"text-lg",children:"حسابات WhatsApp"})}),(0,n.jsx)(R,{onSaveSuccess:v,children:(0,n.jsxs)(c.$,{size:"sm",children:[(0,n.jsx)(d.A,{className:"me-2 h-4 w-4"}),"إضافة حساب"]})})]}),(0,n.jsx)(i.Wu,{className:"p-0",children:l?(0,n.jsx)("div",{className:"flex justify-center p-8",children:(0,n.jsx)(o.A,{className:"animate-spin"})}):0===a.length?(0,n.jsx)("p",{className:"text-muted-foreground text-center p-8",children:"لا توجد حسابات مضافة."}):(0,n.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/50",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("p",{className:"font-semibold",children:e.name}),(0,n.jsx)(E.E,{variant:"outline",children:e.provider||"ultramsg"})]}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground font-mono",children:e.idInstance})]}),(0,n.jsxs)(L.rI,{children:[(0,n.jsx)(L.ty,{asChild:!0,children:(0,n.jsx)(c.$,{variant:"ghost",size:"icon",children:(0,n.jsx)(x.A,{className:"h-4 w-4"})})}),(0,n.jsxs)(L.SQ,{children:[(0,n.jsx)(R,{isEditing:!0,account:e,onSaveSuccess:v,children:(0,n.jsxs)(L._2,{onSelect:e=>e.preventDefault(),children:[(0,n.jsx)(u.A,{className:"me-2 h-4 w-4"}),"تعديل"]})}),(0,n.jsxs)(M.Lt,{children:[(0,n.jsx)(M.tv,{asChild:!0,children:(0,n.jsxs)(L._2,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,n.jsx)(m.A,{className:"me-2 h-4 w-4"}),"حذف"]})}),(0,n.jsxs)(M.EO,{children:[(0,n.jsxs)(M.wd,{children:[(0,n.jsx)(M.r7,{children:"هل أنت متأكد؟"}),(0,n.jsx)(M.$v,{children:"سيتم حذف الحساب بشكل دائم ولا يمكن التراجع عن هذا الإجراء."})]}),(0,n.jsxs)(M.ck,{children:[(0,n.jsx)(M.Zr,{children:"إلغاء"}),(0,n.jsx)(M.Rx,{onClick:()=>g(e.id),className:(0,_.cn)((0,c.r)({variant:"destructive"})),children:"نعم، احذف"})]})]})]})]})]})]},e.id))})})]})}function Z(e){let{onSaveSuccess:s}=e,[a,i]=(0,t.useState)(!1);return(0,n.jsxs)(r.lG,{open:a,onOpenChange:i,children:[(0,n.jsx)(r.zM,{asChild:!0,children:(0,n.jsxs)(c.$,{variant:"outline",children:[(0,n.jsx)(l.A,{className:"me-2 h-4 w-4"}),"الإعدادات"]})}),(0,n.jsxs)(r.Cf,{className:"max-w-2xl",children:[(0,n.jsxs)(r.c7,{children:[(0,n.jsx)(r.L3,{children:"إعدادات الحملات"}),(0,n.jsx)(r.rr,{children:"إدارة حسابات WhatsApp المتصلة بالنظام."})]}),(0,n.jsx)("div",{className:"py-4",children:(0,n.jsx)(B,{onSaveSuccess:()=>{s()}})})]})]})}},69347:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ex});var n=a(95155),t=a(12115),c=a(96133),r=a(37030),l=a(35656),i=a(80187),d=a(30926);let o=(0,d.createServerReference)("406c8a5fa8b6f219b1d6c0d2ed6d4215e348e5c534",d.callServer,void 0,d.findSourceMapURL,"getClients");var x=a(75660),u=a(31868),m=a(86948),h=a(80358),j=a(79805),p=a(98039),f=a(6943),v=a(5468),g=a(11064),b=a(55958),N=a(86933),S=a(18844),A=a(5264),w=a(86017),y=a(17482),C=a(5225),R=a(32373),I=a(65006),k=a(92033),L=a(50984),M=a(78770),_=a(60334),E=a(36653),B=a(56397);let Z=(0,d.createServerReference)("0004c295195cb02aa74b7e03b9ab47835262f651f3",d.callServer,void 0,d.findSourceMapURL,"checkSystemHealth");var D=a(30940),T=a(3998),W=a(64269),U=a(44846),z=a(76444),$=a(15894),J=a(20243);let F=e=>{let{title:s,description:a,status:t,onTest:c,isTesting:r}=e;if(r)return(0,n.jsxs)(m.Zp,{className:"flex-1",children:[(0,n.jsx)(m.aR,{className:"pb-4",children:(0,n.jsx)(m.ZB,{className:"text-base",children:s})}),(0,n.jsx)(m.Wu,{children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(k.A,{className:"h-5 w-5 animate-spin"}),(0,n.jsx)("span",{children:"جاري فحص الاتصال..."})]})}),(0,n.jsx)(m.wL,{children:(0,n.jsx)(T.$,{onClick:c,disabled:!0,variant:"outline",size:"sm",children:"إعادة الفحص"})})]});if(!t)return(0,n.jsxs)(m.Zp,{className:"flex-1",children:[(0,n.jsx)(m.aR,{className:"pb-4",children:(0,n.jsx)(m.ZB,{className:"text-base",children:s})}),(0,n.jsx)(m.Wu,{children:(0,n.jsx)("div",{className:"flex items-center gap-2 text-muted-foreground",children:(0,n.jsx)("span",{children:"جاهز للفحص..."})})}),(0,n.jsx)(m.wL,{children:(0,n.jsx)(T.$,{onClick:c,variant:"outline",size:"sm",children:"بدء الفحص"})})]});let l=t.success?L.A:M.A,i=t.success?"text-green-500":"text-red-500";return(0,n.jsxs)(m.Zp,{className:"flex-1",children:[(0,n.jsx)(m.aR,{className:"pb-4",children:(0,n.jsx)(m.ZB,{className:"text-base",children:s})}),(0,n.jsxs)(m.Wu,{children:[(0,n.jsxs)("div",{className:(0,W.cn)("flex items-center gap-2 font-semibold",i),children:[(0,n.jsx)(l,{className:"h-5 w-5"}),(0,n.jsx)("span",{children:t.message})]}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:a})]}),(0,n.jsx)(m.wL,{children:(0,n.jsxs)(T.$,{onClick:c,disabled:r,variant:"outline",size:"sm",children:[r?(0,n.jsx)(k.A,{className:"me-2 h-4 w-4 animate-spin"}):null,"إعادة الفحص"]})})]})};var O=a(96595),q=a(65142),G=a(40671),P=a(73180),V=a(11186),X=a(78236),H=a(93773),Y=a(658),Q=a(59564),K=a(41732),ee=a(49732);let es=[{id:"accounting",name:"الإعدادات المحاسبية والمالية",icon:h.A,subItems:[{id:"accounting_sequences",name:"تسلسل الفواتير",icon:j.A,component:Q.default},{id:"accounting_currencies",name:"العملات",icon:p.A,component:function(e){let{settings:s,onSettingsChanged:a}=e,[c,r]=(0,t.useState)(s.currencySettings||{defaultCurrency:"USD",exchangeRates:{},currencies:[]}),[l,i]=(0,t.useState)(!1),{toast:d}=(0,$.dj)();(0,t.useEffect)(()=>{r(s.currencySettings||{defaultCurrency:"USD",exchangeRates:{},currencies:[]})},[s]);let o=async()=>{i(!0),(await (0,D.X)({currencySettings:c})).success?(d({title:"تم حفظ إعدادات العملات بنجاح"}),a()):d({title:"خطأ",description:"لم يتم حفظ الإعدادات",variant:"destructive"}),i(!1)};return(0,n.jsxs)(m.Zp,{children:[(0,n.jsxs)(m.aR,{children:[(0,n.jsx)(m.ZB,{children:"إعدادات العملات وأسعار الصرف"}),(0,n.jsx)(m.BT,{children:"تحديد العملة الافتراضية للنظام وإدارة أسعار الصرف بين العملات المختلفة."})]}),(0,n.jsxs)(m.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-1.5 max-w-sm",children:[(0,n.jsx)(z.J,{children:"العملة الافتراضية للنظام"}),(0,n.jsxs)(V.l6,{value:c.defaultCurrency,onValueChange:e=>{r(s=>({...s,defaultCurrency:e}))},children:[(0,n.jsx)(V.bq,{children:(0,n.jsx)(V.yv,{})}),(0,n.jsx)(V.gC,{children:c.currencies.map(e=>(0,n.jsxs)(V.eb,{value:e.code,children:[e.name," (",e.symbol,")"]},e.code))})]})]}),(0,n.jsxs)("div",{className:"space-y-2 pt-4 border-t",children:[(0,n.jsx)(z.J,{className:"font-semibold",children:"أسعار الصرف"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(c.exchangeRates).map(e=>{let[s,a]=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[(0,n.jsxs)(z.J,{htmlFor:"rate-".concat(s),children:["سعر صرف ",s.replace("_"," إلى ")]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(G.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)(q.p,{id:"rate-".concat(s),type:"number",step:"any",value:a,onChange:e=>((e,s)=>{let a=parseFloat(s)||0;r(s=>({...s,exchangeRates:{...s.exchangeRates,[e]:a}}))})(s,e.target.value),className:"pl-8"})]})]},s)})})]})]}),(0,n.jsx)(m.wL,{className:"justify-end",children:(0,n.jsxs)(T.$,{onClick:o,disabled:l,children:[l&&(0,n.jsx)(k.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,n.jsx)(P.A,{className:"me-2 h-4 w-4"}),"حفظ الإعدادات"]})})]})}}]},{id:"relations",name:"إعدادات العلاقات",icon:f.A,subItems:[{id:"relations_fields",name:"إدارة الحقول والاستيراد",icon:v.A,component:O.A},{id:"client_permissions",name:"صلاحيات العملاء",icon:g.A,component:K.default}]},{id:"external_integrations",name:"الربط الخارجي (API)",icon:b.A,subItems:[{id:"api_whatsapp",name:"WhatsApp",icon:N.A,component:function(e){let{settings:s,onSettingsChanged:a}=e;return(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsx)(m.Zp,{children:(0,n.jsxs)(m.aR,{children:[(0,n.jsx)(m.ZB,{children:"الربط مع الخدمات الخارجية (API)"}),(0,n.jsx)(m.BT,{children:"إدارة بيانات الاتصال مع الخدمات الخارجية مثل WhatsApp."}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(I.A,{onSaveSuccess:a})})]})})})}}]},{id:"system",name:"النظام والحالة",icon:S.A,subItems:[{id:"system_status",name:"حالة الاتصال",icon:S.A,component:function(e){let{settings:s,onSettingsChanged:a}=e,[c,r]=(0,t.useState)([]),[l,i]=(0,t.useState)(!0),[d,o]=(0,t.useState)(s.databaseStatus||{isDatabaseConnected:!0}),[x,u]=(0,t.useState)(!1),{toast:h}=(0,$.dj)(),j=(0,t.useCallback)(async()=>{i(!0),r(await Z()),i(!1)},[]);(0,t.useEffect)(()=>{j()},[j]);let p=async e=>{u(!0);let s={isDatabaseConnected:e};(await (0,D.X)({databaseStatus:s})).success?(o(s),h({title:"تم ".concat(e?"إعادة وصل":"قطع"," الاتصال بنجاح")}),a()):h({title:"خطأ",description:"لم يتم تغيير حالة الاتصال.",variant:"destructive"}),u(!1)},f=c.find(e=>"Firebase"===e.service)||null,v=c.find(e=>"Google Drive"===e.service)||null;return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(m.Zp,{children:[(0,n.jsxs)(m.aR,{children:[(0,n.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)(S.A,{className:"h-5 w-5 text-muted-foreground"})," حالة اتصال قاعدة البيانات"]}),(0,n.jsx)(m.BT,{children:"استخدم هذا المفتاح لقطع أو إعادة وصل الاتصال بقاعدة البيانات في كامل التطبيق. مفيد لحل مشاكل الحصة (Quota) أو التوقف المؤقت."})]}),(0,n.jsx)(m.Wu,{children:null===d||l?(0,n.jsx)(J.E,{className:"h-10 w-48"}):(0,n.jsxs)("div",{className:"flex items-center gap-4 rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:(0,W.cn)("flex items-center gap-2 font-semibold",d.isDatabaseConnected?"text-green-500":"text-red-500"),children:[d.isDatabaseConnected?(0,n.jsx)(_.A,{className:"h-5 w-5"}):(0,n.jsx)(E.A,{className:"h-5 w-5"}),(0,n.jsxs)("span",{children:["حالة الاتصال: ",d.isDatabaseConnected?"متصل":"غير متصل"]})]}),(0,n.jsx)("div",{className:"flex-grow"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(z.J,{htmlFor:"db-connection-switch",children:d.isDatabaseConnected?"قطع الاتصال":"إعادة الاتصال"}),(0,n.jsx)(U.d,{id:"db-connection-switch",checked:d.isDatabaseConnected,onCheckedChange:p,disabled:x})]})]})})]}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,n.jsx)(F,{title:"Firebase (قاعدة البيانات)",description:"يتحقق من قدرة الخادم على الاتصال بقاعدة بيانات Firestore باستخدام بيانات الاعتماد المخزنة.",status:f,onTest:j,isTesting:l}),(0,n.jsx)(F,{title:"Google Drive (أرشيف الملفات)",description:"يتحقق من قدرة الخادم على الاتصال بـ Google Drive لرفع الملفات.",status:v,onTest:j,isTesting:l})]}),(0,n.jsx)(m.Zp,{children:(0,n.jsxs)(m.aR,{children:[(0,n.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)(B.A,{className:"h-5 w-5 text-muted-foreground"})," بيانات الاعتماد (Credentials)"]}),(0,n.jsx)(m.BT,{children:"يعتمد هذا النظام على بيانات اعتماد (ملف خدمة) يتم تخزينها بشكل آمن على الخادم كمتغيرات بيئة (Environment Variables) ولا يمكن عرضها أو تعديلها من هنا للحفاظ على الأمان. للربط، يجب تزويد المطورين بملف الخدمة الصحيح من Google Cloud Console."})]})})]})}}]}],ea=[{id:"themes",name:"الثيمات والألوان",icon:A.A,subItems:[{id:"themes_general",name:"الثيمات العامة",icon:w.A,component:ee.A}]},{id:"branding",name:"العلامة التجارية والأصول",icon:y.A,subItems:[{id:"assets_management",name:"إدارة الأصول",icon:y.A,component:H.A},{id:"invoice_design",name:"تصميم الفاتورة",icon:C.A,component:X.A}]},{id:"landing_page",name:"صفحة الهبوط",icon:R.A,subItems:[{id:"landing_page_settings",name:"إعدادات المحتوى",icon:v.A,component:Y.A}]}];var en=a(90109),et=a(13496);function ec(e){let{sections:s,activeSection:a,setActiveSection:t,searchTerm:c,setSearchTerm:r}=e;return(0,n.jsxs)("aside",{className:"border-e bg-card p-4 space-y-4 rounded-lg h-full sticky top-20",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(en.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)(q.p,{placeholder:"بحث في الإعدادات...",className:"ps-10",value:c,onChange:e=>r(e.target.value)})]}),(0,n.jsx)(et.nD,{type:"multiple",className:"w-full",defaultValue:s.map(e=>e.id),children:s.map(e=>{let s=e.icon;return(0,n.jsxs)(et.As,{value:e.id,className:"border-b-0",children:[(0,n.jsx)(et.$m,{className:"py-3 px-2 font-bold text-base hover:no-underline rounded-md data-[state=open]:text-primary justify-between",children:(0,n.jsxs)("div",{className:"flex items-center gap-3 justify-start w-full",children:[(0,n.jsx)(s,{className:"h-5 w-5"}),(0,n.jsx)("span",{children:e.name})]})}),(0,n.jsx)(et.ub,{className:"pr-4 border-r-2 border-primary/50 mr-4",children:(0,n.jsx)("nav",{dir:"rtl",className:"flex flex-col gap-1 mt-2",children:e.subItems.map(e=>{let s=e.icon;return(0,n.jsxs)(T.$,{variant:"ghost",onClick:()=>t(e.id),className:(0,W.cn)("justify-start gap-3 font-semibold",a===e.id&&"bg-primary/10 text-primary"),children:[(0,n.jsx)(s,{className:"h-4 w-4"}),e.name]},e.id)})})})]},e.id)})})]})}function er(e){let[s,a]=(0,t.useState)(""),[c,r]=(0,t.useState)("themes_general"),l=(0,t.useMemo)(()=>[...es,...ea],[]),i=(0,t.useMemo)(()=>s?l.map(e=>{let a=e.subItems.filter(a=>a.name.toLowerCase().includes(s.toLowerCase())||e.name.toLowerCase().includes(s.toLowerCase()));return{...e,subItems:a}}).filter(e=>e.subItems.length>0):l,[s,l]),d=(0,t.useMemo)(()=>{var e,s;for(let e of l){let s=e.subItems.find(e=>e.id===c);if(s)return s.component}return(null==(s=ea[0])||null==(e=s.subItems[0])?void 0:e.component)||null},[c,l]);return(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[280px,1fr] gap-6 items-start",children:[(0,n.jsx)(ec,{sections:i,activeSection:c,setActiveSection:r,searchTerm:s,setSearchTerm:a}),(0,n.jsx)("main",{className:"space-y-6",children:(0,n.jsx)(m.Zp,{children:(0,n.jsx)(m.Wu,{className:"pt-6",children:d?(0,n.jsx)(d,{...e}):(0,n.jsx)("div",{children:"الرجاء اختيار قسم من القائمة."})})})})]})}var el=a(7545),ei=a(18332),ed=a(48182);function eo(){let[e,s]=(0,t.useState)(null),[a,d]=(0,t.useState)([]),[u,m]=(0,t.useState)([]),[h,j]=(0,t.useState)([]),[p,f]=(0,t.useState)([]),[v,g]=(0,t.useState)([]),[b,N]=(0,t.useState)([]),[S,A]=(0,t.useState)(!0),[w,y]=(0,t.useState)(null),C=(0,t.useCallback)(async()=>{A(!0),y(null);try{let[e,a,n,t,u,h]=await Promise.all([(0,c.m)(),(0,r.S)(),(0,l.l)(),(0,i.c)(),o({all:!0,includeInactive:!0}),(0,x.r)()]);s(e),d(a),m(n),j(t),f(u.clients);let p=u.clients.filter(e=>"supplier"===e.relationType||"both"===e.relationType);g(p),N(h.accounts||[])}catch(e){console.error("Error loading settings page data:",e),y(e.message||"فشل تحميل البيانات!")}finally{A(!1)}},[]);if((0,t.useEffect)(()=>{C()},[C]),S)return(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(J.E,{className:"h-[600px] w-full"})});if(w||!e)return(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)(ei.Fc,{variant:"destructive",children:[(0,n.jsx)(el.A,{className:"h-4 w-4"}),(0,n.jsx)(ei.XL,{children:"فشل تحميل البيانات!"}),(0,n.jsxs)(ei.TN,{children:["حدث خطأ غير متوقع أثناء محاولة تحميل بيانات الإعدادات. يرجى مراجعة سجلات الخادم أو المحاولة مرة أخرى لاحقًا.",(0,n.jsx)("pre",{className:"mt-2 text-xs bg-black/10 p-2 rounded-md",children:w})]})]})});let R=(null==e?void 0:e.financeAccounts)?(0,ed.uJ)(e.financeAccounts):null;return(0,n.jsx)(er,{initialSettings:e,chartOfAccounts:a,financeMap:null!=R?R:(0,ed.uJ)(null),users:u,boxes:h,clients:p,suppliers:v,exchanges:b})}function ex(){return(0,n.jsx)(u.default,{requiredPermission:"settings:read",children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"الإعدادات العامة"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"تحكم في جميع جوانب النظام من هذه الواجهة المركزية."})]}),(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)(J.E,{className:"h-[600px] w-full"}),children:(0,n.jsx)(eo,{})})]})})}},75660:(e,s,a)=>{"use strict";a.d(s,{r:()=>t});var n=a(30926);let t=(0,n.createServerReference)("7fff34be9ad53d22bcedbe289fd19cffbcbb61a920",n.callServer,void 0,n.findSourceMapURL,"getExchanges")},80187:(e,s,a)=>{"use strict";a.d(s,{c:()=>t});var n=a(30926);let t=(0,n.createServerReference)("7f085acd10c7b589563e59e7e18d605a9cf6eb6b56",n.callServer,void 0,n.findSourceMapURL,"getBoxes")}},e=>{e.O(0,[9135,7210,3524,4909,9625,315,5111,4127,9967,1374,783,4223,8994,43,84,13,4486,1636,5239,9926,1079,9875,4762,2312,8821,1532,8441,1255,7358],()=>e(e.s=51479)),_N_E=e.O()}]);