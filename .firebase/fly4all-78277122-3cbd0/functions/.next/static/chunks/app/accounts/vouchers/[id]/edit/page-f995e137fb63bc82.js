(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8476],{7545:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])},19056:(e,t,r)=>{"use strict";r.d(t,{H:()=>n});var a=r(77565);function n(e,t){var r;let n,y,m=null!=(r=null==t?void 0:t.additionalDigits)?r:2,p=function(e){let t,r={},a=e.split(i.dateTimeDelimiter);if(a.length>2)return r;if(/:/.test(a[0])?t=a[0]:(r.date=a[0],t=a[1],i.timeZoneDelimiter.test(r.date)&&(r.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length))),t){let e=i.timezone.exec(t);e?(r.time=t.replace(e[1],""),r.timezone=e[1]):r.time=t}return r}(e);if(p.date){let e=function(e,t){let r=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=e.match(r);if(!a)return{year:NaN,restDateString:""};let n=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:null===i?n:100*i,restDateString:e.slice((a[1]||a[2]).length)}}(p.date,m);n=function(e,t){var r,a,n,i,l,u,d;if(null===t)return new Date(NaN);let y=e.match(s);if(!y)return new Date(NaN);let m=!!y[4],p=c(y[1]),f=c(y[2])-1,v=c(y[3]),g=c(y[4]),x=c(y[5])-1;if(m){return(r=g,a=x,r>=1&&r<=53&&a>=0&&a<=6)?function(e,t,r){let a=new Date(0);a.setUTCFullYear(e,0,4);let n=a.getUTCDay()||7;return a.setUTCDate(a.getUTCDate()+((t-1)*7+r+1-n)),a}(t,g,x):new Date(NaN)}{let e=new Date(0);return(n=t,i=f,l=v,i>=0&&i<=11&&l>=1&&l<=(o[i]||(h(n)?29:28))&&(u=t,(d=p)>=1&&d<=(h(u)?366:365)))?(e.setUTCFullYear(t,f,Math.max(p,v)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!n||isNaN(n.getTime()))return new Date(NaN);let f=n.getTime(),v=0;if(p.time&&isNaN(v=function(e){var t,r,n;let i=e.match(l);if(!i)return NaN;let s=d(i[1]),u=d(i[2]),c=d(i[3]);return(t=s,r=u,n=c,24===t?0===r&&0===n:n>=0&&n<60&&r>=0&&r<60&&t>=0&&t<25)?s*a.s0+u*a.Cg+1e3*c:NaN}(p.time)))return new Date(NaN);if(p.timezone){if(isNaN(y=function(e){var t;if("Z"===e)return 0;let r=e.match(u);if(!r)return 0;let n="+"===r[1]?-1:1,i=parseInt(r[2]),s=r[3]&&parseInt(r[3])||0;return(t=s)>=0&&t<=59?n*(i*a.s0+s*a.Cg):NaN}(p.timezone)))return new Date(NaN)}else{let e=new Date(f+v),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(f+v+y)}let i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},s=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,u=/^([+-])(\d{2})(?::?(\d{2}))?$/;function c(e){return e?parseInt(e):1}function d(e){return e&&parseFloat(e.replace(",","."))||0}let o=[31,null,31,30,31,30,31,31,30,31,30,31];function h(e){return e%400==0||e%4==0&&e%100!=0}},20063:(e,t,r)=>{"use strict";var a=r(47260);r.o(a,"notFound")&&r.d(t,{notFound:function(){return a.notFound}}),r.o(a,"redirect")&&r.d(t,{redirect:function(){return a.redirect}}),r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},22452:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},27314:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},35765:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155);r(12115);var n=r(20063),i=r(86948),s=r(96346),l=r(77679),u=r(98389),c=r(21161),d=r(19056);function o(e){let{voucher:t,clients:r,suppliers:o,boxes:h,users:y,settings:m}=e,p=(0,n.useRouter)();t||(0,n.notFound)();let f=()=>{p.push("/accounts/vouchers/list"),p.refresh()};return(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsxs)(i.ZB,{children:["تعديل السند: ",t.invoiceNumber||t.id]}),(0,a.jsx)(i.BT,{children:"قم بتعديل بيانات السند. سيتم حفظ التغييرات وتحديث السجلات."})]}),(0,a.jsx)(i.Wu,{children:(()=>{let e=(e=>{let t={...e.originalData||e,id:e.id,date:e.date?(0,d.H)(e.date):new Date};return"journal_voucher"===e.voucherType?{...t,entries:[...(e.debitEntries||[]).map(e=>({...e,debit:e.amount,credit:0})),...(e.creditEntries||[]).map(e=>({...e,credit:e.amount,debit:0}))]}:t})(t);switch(t.voucherType){case"journal_from_standard_receipt":return(0,a.jsx)(s.A,{isEditing:!0,initialData:e,onVoucherUpdated:f,selectedCurrency:t.currency});case"journal_from_payment":return(0,a.jsx)(l.A,{isEditing:!0,initialData:e,onVoucherUpdated:f,selectedCurrency:t.currency});case"journal_from_expense":return(0,a.jsx)(u.A,{isEditing:!0,initialData:e,onVoucherUpdated:f,boxes:h,selectedCurrency:t.currency});case"journal_voucher":return(0,a.jsx)(c.A,{isEditing:!0,initialData:e,onVoucherUpdated:f,selectedCurrency:t.currency});default:return(0,a.jsxs)("p",{children:["نوع السند غير مدعوم للتعديل حاليًا: ",t.voucherType]})}})()})]})}},44381:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},45767:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(30926);let n=(0,a.createServerReference)("7fc073ecd1a2a3a687a33b240d39c28a9944119247",a.callServer,void 0,a.findSourceMapURL,"getVoucherById")},63263:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},76251:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]])},87703:(e,t,r)=>{Promise.resolve().then(r.bind(r,96153))},88397:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]])},94972:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},96153:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(95155),n=r(12115),i=r(20063),s=r(45767),l=r(9012),u=r(80187),c=r(96133),d=r(35765),o=r(18332),h=r(7545),y=r(35656),m=r(20243);function p(){let e=(0,i.useParams)(),t=Array.isArray(e.id)?e.id[0]:e.id,[r,p]=(0,n.useState)(!0),[f,v]=(0,n.useState)(null),[g,x]=(0,n.useState)(null),N=(0,n.useCallback)(async()=>{if(t){p(!0);try{let[e,r,a,n,d]=await Promise.all([(0,s.Z)(t),(0,l.L)({all:!0}),(0,y.l)(),(0,u.c)(),(0,c.m)()]);if(!e)return void(0,i.notFound)();let o=r.clients,h=o.filter(e=>"client"===e.relationType||"both"===e.relationType),m=o.filter(e=>"supplier"===e.relationType||"both"===e.relationType);x({voucher:e,clients:h,suppliers:m,boxes:n,users:a,settings:d})}catch(e){v(e.message||"Failed to load voucher data.")}finally{p(!1)}}},[t]);return((0,n.useEffect)(()=>{N()},[N]),r)?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(m.E,{className:"h-24 w-full"}),(0,a.jsx)(m.E,{className:"h-96 w-full"})]}):f||!g?(0,a.jsxs)(o.Fc,{variant:"destructive",children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsx)(o.XL,{children:"حدث خطأ!"}),(0,a.jsx)(o.TN,{children:f||"فشل تحميل بيانات السند أو البيانات المرتبطة به."})]}):(0,a.jsx)(d.A,{voucher:g.voucher,clients:g.clients,suppliers:g.suppliers,boxes:g.boxes,users:g.users,settings:g.settings})}}},e=>{e.O(0,[9135,7210,4909,9625,315,5111,4127,9967,1374,783,4223,8994,43,2612,5672,4762,2500,4608,8441,1255,7358],()=>e(e.s=87703)),_N_E=e.O()}]);