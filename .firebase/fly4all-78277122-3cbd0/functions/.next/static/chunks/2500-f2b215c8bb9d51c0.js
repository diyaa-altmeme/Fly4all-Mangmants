"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2500],{5470:(e,a,t)=>{t.d(a,{Z:()=>p,z:()=>f});var r=t(95155),s=t(12115),l=t(9012),n=t(80187),d=t(35656),o=t(96133),i=t(23451),c=t(75660);let u=(0,s.createContext)({data:null,loaded:!1,fetchData:async()=>{},refreshData:async()=>{}}),f=e=>{let{children:a}=e,[t,f]=(0,s.useState)(null),[p,m]=(0,s.useState)(!1),[x,y]=(0,s.useState)(!1),{user:h,loading:b}=(0,i.A)(),g=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!x&&(!p||e)){y(!0);try{let[e,a,t,r,s]=await Promise.all([(0,l.L)({all:!0,includeInactive:!1,relationType:"all"}),(0,n.c)(),(0,d.l)({all:!0}),(0,o.m)(),(0,c.r)()]),i=e.clients,u=i.filter(e=>"client"===e.relationType||"both"===e.relationType),p=i.filter(e=>"supplier"===e.relationType||"both"===e.relationType),x=s.accounts||[];f({clients:u,suppliers:p,boxes:a,users:t,exchanges:x,settings:r}),m(!0)}catch(e){console.error("Failed to load initial voucher navigation data:",e)}finally{y(!1)}}},[x,p]);(0,s.useEffect)(()=>{b||!h||"isClient"in h&&h.isClient||g()},[h,b,g]);let v=(0,s.useCallback)(async()=>{await g(!0)},[g]);return(0,r.jsx)(u.Provider,{value:{data:t,loaded:p,fetchData:g,refreshData:v},children:a})},p=()=>{let e=(0,s.useContext)(u);if(void 0===e)throw Error("useVoucherNav must be used within a VoucherNavProvider");return e}},9012:(e,a,t)=>{t.d(a,{L:()=>s});var r=t(30926);let s=(0,r.createServerReference)("400e621b7f78c4800cffc85d668ca10cd73eb6853c",r.callServer,void 0,r.findSourceMapURL,"getClients")},11186:(e,a,t)=>{t.d(a,{bq:()=>f,eb:()=>y,gC:()=>x,l6:()=>c,yv:()=>u});var r=t(95155),s=t(12115),l=t(47887),n=t(59007),d=t(42614),o=t(72251),i=t(64269);let c=l.bL;l.YJ;let u=l.WT,f=s.forwardRef((e,a)=>{let{className:t,children:s,...d}=e;return(0,r.jsxs)(l.l9,{ref:a,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...d,children:[s,(0,r.jsx)(l.In,{asChild:!0,children:(0,r.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=l.l9.displayName;let p=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.PP,{ref:a,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})});p.displayName=l.PP.displayName;let m=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.wn,{ref:a,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})});m.displayName=l.wn.displayName;let x=s.forwardRef((e,a)=>{let{className:t,children:s,position:n="popper",...d}=e;return(0,r.jsx)(l.ZL,{children:(0,r.jsxs)(l.UC,{ref:a,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...d,children:[(0,r.jsx)(p,{}),(0,r.jsx)(l.LM,{className:(0,i.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(m,{})]})})});x.displayName=l.UC.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.JU,{ref:a,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})}).displayName=l.JU.displayName;let y=s.forwardRef((e,a)=>{let{className:t,children:s,...n}=e;return(0,r.jsxs)(l.q7,{ref:a,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.VF,{children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(l.p4,{children:s})]})});y.displayName=l.q7.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.wv,{ref:a,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=l.wv.displayName},11647:(e,a,t)=>{t.d(a,{E:()=>d});var r=t(95155);t(12115);var s=t(83101),l=t(64269);let n=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:a,variant:t,...s}=e;return(0,r.jsx)("span",{className:(0,l.cn)(n({variant:t}),a),...s})}},23639:(e,a,t)=>{t.d(a,{j:()=>T});var r=t(95155),s=t(12115),l=t(30848),n=t(92033),d=t(72251),o=t(33173),i=t(36204),c=t(64269),u=t(3998),f=t(41808),p=t(90109);t(51834);let m=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(f.uB,{ref:a,className:(0,c.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...s})});m.displayName=f.uB.displayName;let x=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,r.jsx)(f.uB.Input,{ref:a,className:(0,c.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...s})]})});x.displayName=f.uB.Input.displayName;let y=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(f.uB.List,{ref:a,className:(0,c.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...s})});y.displayName=f.uB.List.displayName;let h=s.forwardRef((e,a)=>(0,r.jsx)(f.uB.Empty,{ref:a,className:"py-6 text-center text-sm",...e}));h.displayName=f.uB.Empty.displayName;let b=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(f.uB.Group,{ref:a,className:(0,c.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s})});b.displayName=f.uB.Group.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(f.uB.Separator,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-border",t),...s})}).displayName=f.uB.Separator.displayName;let g=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(f.uB.Item,{ref:a,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-primary aria-selected:text-primary-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",t),...s})});g.displayName=f.uB.Item.displayName;var v=t(26333),N=t(50732),w=t(30926);w.callServer,w.findSourceMapURL;var j=t(5470),C=t(11647);let R=e=>{let{children:a}=e;return(0,r.jsx)("div",{className:"py-1 px-2 text-xs text-center text-muted-foreground bg-muted/50 border-t",children:a})};function T(e){let{searchAction:a,options:t,value:f,onValueChange:p,placeholder:w,disabled:T=!1,includeInactive:S=!1}=e,[k,L]=s.useState(!1),[M,A]=s.useState(""),[B,E]=s.useState(!1);(0,N.d)(M,400);let[U,z]=s.useState(0),{data:F,loaded:_}=(0,j.Z)(),I=s.useMemo(()=>{if(t)return t;if(!_)return[];let e=e=>"".concat(e.name).concat(e.code?" (".concat(e.code,")"):""),r=[];if(_)switch(a){case"clients":r=(F.clients||[]).filter(e=>"client"===e.relationType||"both"===e.relationType).map(a=>({value:a.id,label:e(a),relationType:a.relationType,paymentType:a.paymentType}));break;case"suppliers":r=(F.suppliers||[]).filter(e=>"supplier"===e.relationType||"both"===e.relationType).map(a=>({value:a.id,label:e(a),relationType:a.relationType,paymentType:a.paymentType}));break;case"users":r=(F.users||[]).map(e=>({value:e.uid,label:e.name,email:e.email}));break;case"boxes":r=(F.boxes||[]).map(e=>({value:e.id,label:e.name}));break;default:r=[...(F.clients||[]).map(a=>({value:a.id,label:e(a),relationType:a.relationType,paymentType:a.paymentType})),...(F.suppliers||[]).map(a=>({value:a.id,label:e(a),relationType:a.relationType,paymentType:a.paymentType})),...(F.boxes||[]).map(e=>({value:e.id,label:"صندوق: ".concat(e.name)}))]}return r.sort((e,a)=>(a.useCount||0)-(e.useCount||0))},[t,F,_,a]),P=s.useMemo(()=>I.find(e=>(null==e?void 0:e.value)===f),[I,f]),V=e=>{let a=J.find(a=>a.value.toLowerCase()===e.toLowerCase());p(a?a.value:""),A(""),L(!1)},J=s.useMemo(()=>{if(!M)return z(0),I;let e=M.toLowerCase(),a=I.filter(a=>a.label.toLowerCase().includes(e)||a.arabicName&&a.arabicName.toLowerCase().includes(e)||a.city&&a.city.toLowerCase().includes(e)||a.email&&a.email.toLowerCase().includes(e));return z(0),a},[I,M]),D=s.useMemo(()=>{let e=10*U;return J.slice(e,e+10)},[J,U,10]),Z=Math.ceil(J.length/10),q=null==t?void 0:t.some(e=>e.country&&e.city);return(0,r.jsxs)(v.AM,{open:k,onOpenChange:L,children:[(0,r.jsx)(v.Wv,{asChild:!0,children:(0,r.jsxs)(u.$,{variant:"outline",role:"combobox","aria-expanded":k,className:"w-full justify-between h-8",disabled:T,children:[(0,r.jsx)("span",{className:(0,c.cn)("truncate",!P&&"text-muted-foreground"),children:P?q?P.value:P.label:w||"Select..."}),(0,r.jsx)(l.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,r.jsx)(v.hl,{className:"min-w-[var(--radix-popover-trigger-width)] w-auto p-0",children:(0,r.jsxs)(m,{shouldFilter:!1,children:[(0,r.jsx)(x,{placeholder:w||"بحث...",value:M,onValueChange:A}),(0,r.jsxs)(y,{children:[B&&(0,r.jsx)("div",{className:"p-2 flex justify-center",children:(0,r.jsx)(n.A,{className:"h-5 w-5 animate-spin"})}),!B&&0===D.length&&(0,r.jsx)(h,{children:"لا توجد نتائج."}),(0,r.jsx)(b,{children:D.map((e,a)=>(0,r.jsx)(g,{value:e.value,onSelect:V,className:(0,c.cn)("flex justify-between items-center",q?"p-2":""),children:q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex-grow text-right",children:[(0,r.jsx)("p",{className:"font-bold text-sm",children:e.arabicName||e.city}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.arabicCountry||e.country})]}),(0,r.jsx)(C.E,{variant:"secondary",className:"font-mono text-sm px-2 py-1 ml-3",children:e.value})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:(0,c.cn)("mr-2 h-4 w-4",f===e.value?"opacity-100":"opacity-0")}),(0,r.jsx)("span",{children:e.label})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.paymentType&&(0,r.jsx)(C.E,{variant:"outline",children:(e=>{switch(e){case"cash":return"نقدي";case"credit":return"آجل";default:return""}})(e.paymentType)}),e.relationType&&(0,r.jsx)(C.E,{variant:"secondary",children:(e=>{switch(e){case"client":return"عميل";case"supplier":return"مورد";case"both":return"عميل ومورد";default:return""}})(e.relationType)})]})]})},"".concat(e.value,"-").concat(a)))})]}),J.length>10&&(0,r.jsx)(R,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,r.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>z(e=>Math.max(0,e-1)),disabled:0===U,children:(0,r.jsx)(o.A,{className:"h-4 w-4"})}),(0,r.jsxs)("span",{children:["صفحة ",U+1," من ",Z]}),(0,r.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>z(e=>Math.min(Z-1,e+1)),disabled:U>=Z-1,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})})]})})]})})]})}},26333:(e,a,t)=>{t.d(a,{AM:()=>d,Wv:()=>o,hl:()=>i});var r=t(95155),s=t(12115),l=t(82286),n=t(64269);let d=l.bL,o=l.l9,i=s.forwardRef((e,a)=>{let{className:t,align:s="center",sideOffset:d=4,...o}=e;return(0,r.jsx)(l.ZL,{children:(0,r.jsx)(l.UC,{ref:a,align:s,sideOffset:d,className:(0,n.cn)("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})})});i.displayName=l.UC.displayName},35656:(e,a,t)=>{t.d(a,{l:()=>s});var r=t(30926);let s=(0,r.createServerReference)("40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3",r.callServer,void 0,r.findSourceMapURL,"getUsers")},50732:(e,a,t)=>{t.d(a,{d:()=>s});var r=t(12115);function s(e,a){let[t,s]=(0,r.useState)(e);return(0,r.useEffect)(()=>{let t=setTimeout(()=>{s(e)},a);return()=>{clearTimeout(t)}},[e,a]),t}},51834:(e,a,t)=>{t.d(a,{Cf:()=>p,Es:()=>x,HM:()=>u,L3:()=>y,c7:()=>m,lG:()=>o,rr:()=>h,zM:()=>i});var r=t(95155),s=t(12115),l=t(89511),n=t(26615),d=t(64269);let o=l.bL,i=l.l9,c=l.ZL,u=l.bm,f=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.hJ,{ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});f.displayName=l.hJ.displayName;let p=s.forwardRef((e,a)=>{let{className:t,children:s,showCloseButton:o=!0,...i}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(f,{}),(0,r.jsxs)(l.UC,{ref:a,className:(0,d.cn)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),onOpenAutoFocus:e=>e.preventDefault(),...i,children:[s,o&&(0,r.jsxs)(l.bm,{className:"absolute left-4 top-4 rounded-full p-1.5 opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground bg-muted hover:bg-muted/80",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=l.UC.displayName;let m=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-right",a),...t})};m.displayName="DialogHeader";let x=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 rtl:space-x-reverse",a),...t})};x.displayName="DialogFooter";let y=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.hE,{ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});y.displayName=l.hE.displayName;let h=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.VY,{ref:a,className:(0,d.cn)("text-sm text-muted-foreground",t),...s})});h.displayName=l.VY.displayName},65142:(e,a,t)=>{t.d(a,{p:()=>n});var r=t(95155),s=t(12115),l=t(64269);let n=s.forwardRef((e,a)=>{let{className:t,type:s,...n}=e;return(0,r.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-lg border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...n})});n.displayName="Input"},75660:(e,a,t)=>{t.d(a,{r:()=>s});var r=t(30926);let s=(0,r.createServerReference)("7fff34be9ad53d22bcedbe289fd19cffbcbb61a920",r.callServer,void 0,r.findSourceMapURL,"getExchanges")},76444:(e,a,t)=>{t.d(a,{J:()=>i});var r=t(95155),s=t(12115),l=t(10489),n=t(83101),d=t(64269);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(l.b,{ref:a,className:(0,d.cn)(o(),t),...s})});i.displayName=l.b.displayName},80187:(e,a,t)=>{t.d(a,{c:()=>s});var r=t(30926);let s=(0,r.createServerReference)("7f085acd10c7b589563e59e7e18d605a9cf6eb6b56",r.callServer,void 0,r.findSourceMapURL,"getBoxes")},96133:(e,a,t)=>{t.d(a,{m:()=>s});var r=t(30926);let s=(0,r.createServerReference)("7fe3cedf8b5b39f6ca6561f08402f1ad7a82ecff97",r.callServer,void 0,r.findSourceMapURL,"getSettings")}}]);