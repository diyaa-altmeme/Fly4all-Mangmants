"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{44846:(e,s,t)=>{t.d(s,{d:()=>c});var r=t(95155),n=t(12115),a=t(27599),l=t(64269);let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(a.bL,{className:(0,l.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:s,children:(0,r.jsx)(a.zi,{className:(0,l.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0 rtl:data-[state=checked]:-translate-x-4 rtl:data-[state=unchecked]:-translate-x-0")})})});c.displayName=a.bL.displayName},50898:(e,s,t)=>{t.d(s,{A:()=>_});var r=t(95155),n=t(12115),a=t(3998),l=t(51834),c=t(15894),i=t(22452),d=t(26615),o=t(56639),h=t(92033),x=t(13630),u=t(27314),m=t(94972),j=t(44381),p=t(73180),g=t(30926);let v=(0,g.createServerReference)("403853799c99974381aed2d752ac232c7cabeb7c0b",g.callServer,void 0,g.findSourceMapURL,"addSubscription");var f=t(41052),b=t(65142),N=t(31120),y=t(23639),w=t(27432),C=t(97916),S=t(23451),I=t(5470),D=t(66942),k=t(54879),M=t(41962),J=t(22544),z=t(64269),A=t(66385),O=t(86948),B=t(86259),R=t(76444),P=t(50909),V=t(87270),L=t(44846);let $=k.Ik({dueDate:k.p6({required_error:"تاريخ الاستحقاق مطلوب."}),amount:k.au.number().positive("المبلغ يجب أن يكون أكبر من صفر.")}),E=k.Ik({supplierId:k.Yj().optional(),serviceName:k.Yj().min(2,{message:"اسم الاشتراك مطلوب."}),purchaseDate:k.p6({required_error:"تاريخ الشراء مطلوب."}),clientId:k.Yj().min(1,"الرجاء اختيار عميل."),currency:k.k5(["USD","IQD"]),quantity:k.au.number().int().min(1,"الكمية يجب أن تكون 1 على الأقل.").default(1),purchasePrice:k.au.number().min(0,"سعر شراء الوحدة يجب ان يكون صفرا أو أكثر.").default(0),unitPrice:k.au.number().min(0,"سعر بيع الوحدة يجب أن يكون أكبر من صفر").default(0),discount:k.au.number().min(0,"الخصم لا يمكن أن يكون سالبًا.").default(0).optional(),startDate:k.p6({required_error:"تاريخ بدء الاشتراك مطلوب."}),installmentMethod:k.k5(["upfront","deferred","installments"]).default("upfront"),deferredDueDate:k.p6().optional(),installments:k.YO($).optional(),boxId:k.Yj().optional(),notes:k.Yj().optional(),hasPartner:k.zM().default(!1),partnerId:k.Yj().optional(),partnerSharePercentage:k.au.number().min(0).max(100).optional()}),F=e=>{let{title:s,children:t,className:n}=e;return(0,r.jsx)(O.Zp,{className:(0,z.cn)("shadow-sm",n),children:(0,r.jsxs)(O.Wu,{className:"pt-6 space-y-4",children:[(0,r.jsx)("h3",{className:"font-bold text-primary mb-3",children:s}),t]})})};function _(e){var s,t,g,k;let{onSubscriptionAdded:O,children:$}=e,[_,q]=(0,n.useState)(!1),{toast:Y}=(0,c.dj)(),{user:K}=(0,S.A)(),{data:U,loaded:H,fetchData:W}=(0,I.Z)(),[Z,Q]=(0,n.useState)(!1),[G,T]=(0,n.useState)({width:"1024px",height:"90vh"}),[X,ee]=(0,n.useState)(2),es=null==U||null==(s=U.settings)?void 0:s.subscriptionSettings,et=(null==U||null==(t=U.settings.currencySettings)?void 0:t.defaultCurrency)||"USD";(0,n.useEffect)(()=>{_&&!H&&W()},[_,H,W]);let er=(0,J.mN)({resolver:(0,D.u)(E)}),{control:en,handleSubmit:ea,watch:el,setValue:ec,formState:{errors:ei},trigger:ed,reset:eo}=er,{fields:eh,append:ex,remove:eu,replace:em}=(0,J.jz)({control:en,name:"installments"});(0,n.useEffect)(()=>{_&&(er.reset({currency:et,purchaseDate:new Date,clientId:"",supplierId:(null==es?void 0:es.defaultSupplier)||"",serviceName:"",purchasePrice:0,quantity:(null==es?void 0:es.defaultQuantity)||1,unitPrice:0,discount:0,startDate:new Date,installmentMethod:"upfront",installments:[],notes:"",boxId:K&&"role"in K?K.boxId:"",hasPartner:!1}),ee((null==es?void 0:es.defaultInstallments)||2))},[_,er,K,U,et,es]);let ej=el("currency"),ep=el("installmentMethod"),eg=el("quantity"),ev=el("purchasePrice"),ef=el("unitPrice"),eb=el("discount"),eN=el("installments"),ey=el("startDate"),ew=el("hasPartner"),eC=el("partnerSharePercentage"),eS=(eg||0)*(ev||0),eI=(eg||0)*(ef||0)-(eb||0),eD=eI-eS,ek=ew&&eC?eC/100*eD:0,eM=eD-ek,eJ=(eN||[]).reduce((e,s)=>e+Number(s.amount||0),0),ez=eI-eJ,eA="USD"===ej?"hsl(var(--accent))":"hsl(var(--primary))",eO=(0,n.useMemo)(()=>{var e,s;let t=el("boxId");return(null==U||null==(s=U.boxes)||null==(e=s.find(e=>e.id===t))?void 0:e.name)||"غير محدد"},[el,null==U?void 0:U.boxes]),eB=n.useMemo(()=>((null==U?void 0:U.suppliers)||[]).map(e=>({value:e.id,label:e.name})),[null==U?void 0:U.suppliers]),eR=n.useMemo(()=>((null==U?void 0:U.clients)||[]).map(e=>({value:e.id,label:"".concat(e.name," ").concat(e.code?"(".concat(e.code,")"):"")})),[null==U?void 0:U.clients]),eP=n.useMemo(()=>U?[...U.clients||[],...U.suppliers||[]].map(e=>({value:e.id,label:e.name})):[],[U]),eV=(0,n.useCallback)(()=>{if(X>0&&eI>0){let e=parseFloat((eI/X).toFixed(2)),s=Array.from({length:X},(s,t)=>({dueDate:(0,M.P)(ey,t),amount:e})),t=eI-s.reduce((e,s)=>e+s.amount,0);s.length>0&&(s[s.length-1].amount+=t),em(s)}else em([])},[X,eI,ey,em]),eL=async e=>{if(Q(!0),"installments"===e.installmentMethod&&Math.abs(ez)>.01){Y({title:"خطأ في التوزيع",description:"مجموع مبالغ الدفعات لا يساوي إجمالي البيع بعد الخصم.",variant:"destructive"}),Q(!1);return}try{var s,t;let r=null==U||null==(s=U.clients)?void 0:s.find(s=>s.id===e.clientId),n=null==U||null==(t=U.suppliers)?void 0:t.find(s=>s.id===e.supplierId);if(!r){Y({title:"العميل غير موجود",variant:"destructive"}),Q(!1);return}let a={...e,purchaseDate:e.purchaseDate.toISOString(),startDate:e.startDate.toISOString(),deferredDueDate:e.deferredDueDate?e.deferredDueDate.toISOString():void 0,installments:(e.installments||[]).map(e=>({...e,dueDate:e.dueDate.toISOString()})),clientName:r.name,supplierName:null==n?void 0:n.name},l=await v(a);if(l.success&&l.id)O&&O(),Y({title:"تمت إضافة الاشتراك بنجاح"}),q(!1);else throw Error(l.error||"Failed to add subscription")}catch(e){Y({title:"خطأ",description:e.message||"حدث خطأ أثناء إضافة الاشتراك.",variant:"destructive"})}finally{Q(!1)}};return(0,r.jsxs)(l.lG,{open:_,onOpenChange:q,children:[(0,r.jsx)(l.zM,{asChild:!0,children:$||(0,r.jsxs)(a.$,{children:[(0,r.jsx)(i.A,{className:"me-2 h-4 w-4"})," إضافة اشتراك"]})}),(0,r.jsxs)(l.Cf,{showCloseButton:!1,className:"p-0 flex flex-col",style:{maxWidth:G.width,width:"95vw",height:G.height},children:[(0,r.jsxs)(l.c7,{className:"p-4 rounded-t-lg flex flex-row justify-between items-center",style:{backgroundColor:eA,color:"white"},children:[(0,r.jsx)(l.HM,{asChild:!0,children:(0,r.jsx)(a.$,{variant:"ghost",size:"icon",className:"text-primary-foreground hover:bg-white/20 h-7 w-7 rounded-full",children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})}),(0,r.jsx)("div",{children:(0,r.jsx)(l.L3,{className:"text-white",children:"إضافة اشتراك جديد"})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[((null==U||null==(k=U.settings)||null==(g=k.currencySettings)?void 0:g.currencies)||[]).map(e=>(0,r.jsx)(a.$,{type:"button",onClick:()=>er.setValue("currency",e.code),className:(0,z.cn)("text-white h-8",ej===e.code?"bg-white/30":"bg-transparent border border-white/50"),children:e.code},e.code)),(0,r.jsx)(A.A,{dialogKey:"add_subscription",onDimensionsChange:T,children:(0,r.jsx)(a.$,{type:"button",variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:(0,r.jsx)(o.A,{className:"h-5 w-5"})})})]})]}),(0,r.jsx)(J.Op,{...er,children:(0,r.jsxs)("form",{onSubmit:er.handleSubmit(eL),className:"flex flex-col flex-grow overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 flex-grow overflow-y-auto space-y-4",children:H?(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)(F,{title:"المعلومات الأساسية",children:[(0,r.jsx)(f.zB,{control:en,name:"serviceName",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"اسم الاشتراك / الخدمة"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(b.p,{placeholder:"مثال: اشتراك إنترنت شهري",...s})}),(0,r.jsx)(f.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(f.zB,{control:en,name:"supplierId",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"المورد (المصدر)"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(y.j,{searchAction:"suppliers",options:eB,value:s.value,onValueChange:s.onChange,placeholder:"اختياري"})}),(0,r.jsx)(f.C5,{})]})}}),(0,r.jsx)(f.zB,{control:en,name:"clientId",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"العميل (المستفيد)"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(y.j,{searchAction:"clients",options:eR,value:s.value,onValueChange:s.onChange,placeholder:"ابحث عن عميل..."})}),(0,r.jsx)(f.C5,{})]})}})]}),(0,r.jsx)(f.zB,{control:en,name:"purchaseDate",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"تاريخ الشراء"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(w.K,{date:s.value,setDate:s.onChange})}),(0,r.jsx)(f.C5,{})]})}})]}),(0,r.jsxs)(F,{title:"التفاصيل المالية وتوزيع الأرباح",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(f.zB,{control:en,name:"quantity",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"الكمية"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(C.O,{onValueChange:e=>s.onChange(e||0),value:s.value,placeholder:"أدخل الكمية"})}),(0,r.jsx)(f.C5,{})]})}}),(0,r.jsx)(f.zB,{control:en,name:"discount",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"الخصم"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(C.O,{currency:ej,onValueChange:e=>s.onChange(e||0),value:s.value,placeholder:"أدخل الخصم"})}),(0,r.jsx)(f.C5,{})]})}}),(0,r.jsx)(f.zB,{control:en,name:"purchasePrice",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"الكلفة"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(C.O,{currency:ej,onValueChange:e=>s.onChange(e||0),value:s.value,placeholder:"أدخل سعر الشراء"})}),(0,r.jsx)(f.C5,{})]})}}),(0,r.jsx)(f.zB,{control:en,name:"unitPrice",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"البيع"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(C.O,{currency:ej,onValueChange:e=>s.onChange(e||0),value:s.value,placeholder:"أدخل سعر البيع"})}),(0,r.jsx)(f.C5,{})]})}})]}),(0,r.jsx)(B.Separator,{className:"my-4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,r.jsxs)("div",{className:"bg-red-50 p-2 rounded-md",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-muted-foreground",children:"إجمالي الكلفة"}),(0,r.jsxs)("p",{className:"font-bold",children:[eS.toLocaleString()," ",ej]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-2 rounded-md",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-muted-foreground",children:"إجمالي المبيع"}),(0,r.jsxs)("p",{className:"font-bold",children:[eI.toLocaleString()," ",ej]})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-2 rounded-md",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-muted-foreground",children:"إجمالي الربح"}),(0,r.jsxs)("p",{className:"font-bold",children:[eD.toLocaleString()," ",ej]})]})]}),(0,r.jsx)(f.zB,{control:en,name:"hasPartner",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[(0,r.jsx)(R.J,{className:"font-semibold",children:"هل يوجد شريك في الربح؟"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(L.d,{checked:s.value,onCheckedChange:s.onChange})})]})}}),ew&&(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center p-2 border rounded-lg",children:[(0,r.jsx)(f.zB,{control:en,name:"partnerId",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{className:"col-span-1 text-right space-y-1",children:[(0,r.jsx)(f.lR,{className:"text-xs",children:"الشريك"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(y.j,{options:eP,value:s.value,onValueChange:s.onChange,placeholder:"اختر شريك"})})]})}}),(0,r.jsx)(f.zB,{control:en,name:"partnerSharePercentage",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{className:"col-span-2 text-right space-y-1",children:[(0,r.jsx)(f.lR,{className:"text-xs",children:"حصة الشريك من الربح (%)"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)(C.O,{value:s.value,onValueChange:e=>s.onChange(e||0)}),(0,r.jsxs)("div",{className:"font-bold p-2 rounded-md bg-blue-50 text-blue-800",children:[ek.toLocaleString()," ",ej]})]})]})}}),(0,r.jsxs)("div",{className:"col-span-3 bg-green-50 p-2 rounded-md font-bold text-green-800",children:["حصة الروضتين: ",eM.toLocaleString()," ",ej]})]})]})]}),(0,r.jsxs)(F,{title:"جدولة الدفعات",className:"md:col-span-2",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 items-end",children:[(0,r.jsx)(f.zB,{name:"installmentMethod",control:en,render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{className:"space-y-2",children:[(0,r.jsx)(f.lR,{className:"font-bold text-base",children:"طريقة السداد"}),(0,r.jsx)(f.MJ,{children:(0,r.jsxs)(P.z,{onValueChange:s.onChange,value:s.value,className:"grid grid-cols-3 gap-2",children:[(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.MJ,{children:(0,r.jsx)(P.C,{value:"upfront",id:"upfront",className:"sr-only peer"})}),(0,r.jsx)(R.J,{htmlFor:"upfront",className:"flex h-10 items-center justify-center rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary peer-data-[state=checked]:bg-primary peer-data-[state=checked]:text-primary-foreground font-bold text-sm cursor-pointer",children:"دفعة مقدمًا"})]}),(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.MJ,{children:(0,r.jsx)(P.C,{value:"deferred",id:"deferred",className:"sr-only peer"})}),(0,r.jsx)(R.J,{htmlFor:"deferred",className:"flex h-10 items-center justify-center rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary peer-data-[state=checked]:bg-primary peer-data-[state=checked]:text-primary-foreground font-bold text-sm cursor-pointer",children:"دفع بالأجل"})]}),(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.MJ,{children:(0,r.jsx)(P.C,{value:"installments",id:"installments",className:"sr-only peer"})}),(0,r.jsx)(R.J,{htmlFor:"installments",className:"whitespace-nowrap flex h-10 items-center justify-center rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary peer-data-[state=checked]:bg-primary peer-data-[state=checked]:text-primary-foreground font-bold text-sm cursor-pointer",children:"على شكل دفعات"})]})]})}),(0,r.jsx)(f.C5,{})]})}}),(0,r.jsx)(f.zB,{control:en,name:"startDate",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"تاريخ بدء الاشتراك"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(w.K,{date:s.value,setDate:s.onChange})}),(0,r.jsx)(f.C5,{})]})}})]}),(0,r.jsxs)("div",{className:"pt-4 space-y-4",children:[("upfront"===ep||"deferred"===ep)&&(0,r.jsx)(f.zB,{control:en,name:"deferredDueDate",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"تاريخ استحقاق الدفعة"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(w.K,{date:s.value,setDate:s.onChange})}),(0,r.jsx)(f.C5,{})]})}}),"installments"===ep&&(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"space-y-1.5 w-48",children:[(0,r.jsx)(R.J,{className:"font-bold",children:"عدد الدفعات"}),(0,r.jsx)(C.O,{value:X,onValueChange:e=>ee(e||0),min:1,placeholder:"أدخل العدد"})]}),(0,r.jsx)(a.$,{type:"button",onClick:eV,className:"mt-6",children:"توليد الأقساط"})]}),(0,r.jsx)("h4",{className:"font-bold",children:"إدارة الدفعات"}),(0,r.jsx)("div",{className:"border rounded-lg",children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"#"}),(0,r.jsx)(V.nd,{children:"تاريخ الاستحقاق"}),(0,r.jsx)(V.nd,{children:"المبلغ"}),(0,r.jsx)(V.nd,{className:"w-12"})]})}),(0,r.jsx)(V.BF,{children:eh.map((e,s)=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{children:s+1}),(0,r.jsx)(V.nA,{children:(0,r.jsx)(f.zB,{control:en,name:"installments.".concat(s,".dueDate"),render:e=>{let{field:s}=e;return(0,r.jsx)(w.K,{date:s.value,setDate:s.onChange})}})}),(0,r.jsx)(V.nA,{children:(0,r.jsx)(f.zB,{control:en,name:"installments.".concat(s,".amount"),render:e=>{let{field:s}=e;return(0,r.jsx)(C.O,{currency:ej,onValueChange:e=>s.onChange(e||0),value:s.value,placeholder:"أدخل المبلغ"})}})}),(0,r.jsx)(V.nA,{children:(0,r.jsx)(a.$,{type:"button",variant:"ghost",size:"icon",className:"text-destructive h-8 w-8",onClick:()=>eu(s),children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})})]},e.id))})]})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)(a.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{var e;return ex({dueDate:(0,M.P)((null==(e=eh[eh.length-1])?void 0:e.dueDate)||new Date,1),amount:0})},children:[(0,r.jsx)(i.A,{className:"me-2 h-4 w-4"})," إضافة دفعة يدوية"]}),(0,r.jsxs)("div",{className:"space-x-4 font-mono text-sm",children:[(0,r.jsxs)("span",{className:"font-bold",children:["الموزع: ",(0,r.jsx)("span",{className:"text-blue-600",children:eJ.toLocaleString()})]}),(0,r.jsxs)("span",{className:(0,z.cn)("font-bold",0!==ez&&"text-destructive"),children:["المتبقي: ",(0,r.jsx)("span",{className:(0,z.cn)(0!==ez&&"text-destructive"),children:ez.toLocaleString()})]})]})]})]})]})]}),(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)(f.zB,{control:en,name:"notes",render:e=>{let{field:s}=e;return(0,r.jsxs)(f.eI,{children:[(0,r.jsx)(f.lR,{className:"font-bold",children:"ملاحظات (اختياري)"}),(0,r.jsx)(f.MJ,{children:(0,r.jsx)(N.T,{...s})}),(0,r.jsx)(f.C5,{})]})}})})]}):(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsx)(h.A,{className:"animate-spin h-8 w-8"})})}),(0,r.jsxs)(l.Es,{className:"p-4 border-t flex-row items-center justify-between sticky bottom-0 bg-background mt-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 text-primary"})," ",(0,r.jsx)("span",{children:(null==K?void 0:K.name)||"..."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 text-primary"})," ",(0,r.jsx)("span",{children:eO})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(j.A,{className:"h-4 w-4 text-primary"})," ",(0,r.jsx)("span",{children:"رقم الفاتورة: (تلقائي)"})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)(a.$,{type:"submit",disabled:Z,children:[Z&&(0,r.jsx)(h.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,r.jsx)(p.A,{className:"me-2 h-4 w-4"}),"حفظ الاشتراك"]})})]})]})})]})]})}},66385:(e,s,t)=>{t.d(s,{A:()=>u});var r=t(95155),n=t(12115),a=t(26333),l=t(3998),c=t(76444),i=t(15894),d=t(97916),o=t(76140),h=t(98053);let x={width:"896px",height:"80vh"};function u(e){let{dialogKey:s,children:t,onDimensionsChange:u}=e,{toast:m}=(0,i.dj)(),[j,p]=(0,n.useState)(x),g=e=>parseInt(e.replace(/px|vw|vh/g,""),10)||0,v=()=>{try{let e=JSON.parse(localStorage.getItem("voucherDialogSettings")||"{}")[s]||x;p(e),u(e)}catch(e){p(x),u(x)}};return(0,n.useEffect)(()=>{v()},[]),(0,n.useEffect)(()=>{u(j)},[j,u]),(0,r.jsxs)(a.AM,{onOpenChange:e=>e&&v(),children:[(0,r.jsx)(a.Wv,{asChild:!0,children:t}),(0,r.jsx)(a.hl,{className:"w-80",children:(0,r.jsxs)("div",{className:"grid gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)(h.Lt,{children:[(0,r.jsx)(h.tv,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground",children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(h.EO,{children:[(0,r.jsxs)(h.wd,{children:[(0,r.jsx)(h.r7,{children:"إعادة تعيين؟"}),(0,r.jsx)(h.$v,{children:"هل تريد إعادة الأبعاد للحجم الافتراضي؟"})]}),(0,r.jsxs)(h.ck,{children:[(0,r.jsx)(h.Zr,{children:"إلغاء"}),(0,r.jsx)(h.Rx,{onClick:()=>{p(x);let e=JSON.parse(localStorage.getItem("voucherDialogSettings")||"{}");delete e[s],localStorage.setItem("voucherDialogSettings",JSON.stringify(e)),m({title:"تمت إعادة تعيين الأبعاد"})},children:"نعم"})]})]})]}),(0,r.jsx)("h4",{className:"font-medium leading-none text-right",children:"أبعاد النافذة"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-right",children:"تحكم في حجم النافذة لتناسب شاشتك."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,r.jsx)(d.O,{id:"width",value:g(j.width),onValueChange:e=>p(s=>({...s,width:"".concat(e||0,"px")})),className:"col-span-2 h-8"}),(0,r.jsx)(c.J,{htmlFor:"width",children:"العرض (px)"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,r.jsx)(d.O,{id:"height",value:g(j.height),onValueChange:e=>p(s=>({...s,height:"".concat(e||0,"vh")})),className:"col-span-2 h-8"}),(0,r.jsx)(c.J,{htmlFor:"height",children:"الارتفاع (vh)"})]}),(0,r.jsx)(l.$,{onClick:()=>{try{let e={...JSON.parse(localStorage.getItem("voucherDialogSettings")||"{}"),[s]:j};localStorage.setItem("voucherDialogSettings",JSON.stringify(e)),m({title:"تم حفظ أبعاد النافذة"})}catch(e){m({title:"خطأ",description:"لم يتم حفظ الإعدادات",variant:"destructive"})}},size:"sm",className:"mt-2",children:"حفظ الأبعاد"})]})]})})]})}}}]);