"use strict";exports.id=6057,exports.ids=[6057],exports.modules={2536:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},11423:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},31793:(a,b,c)=>{c.d(b,{A:()=>z});var d=c(21124),e=c(38301),f=c(40068),g=c(31980),h=c(50937),i=c(99546),j=c(35284),k=c(93758),l=c(45608),m=c(27186),n=c(2536),o=c(61603),p=c(49113),q=c(49566),r=c(29303),s=c(85708);let t=(0,s.createServerReference)("40d4790cf5bfe15d462399ad8c52d1baec8babf86f",s.callServer,void 0,s.findSourceMapURL,"addUser");var u=c(37448),v=c(25456),w=c(1420);let x=i.Ik({name:i.Yj().min(3,"الاسم مطلوب (3 أحرف على الأقل)"),username:i.Yj().min(3,"اسم المستخدم مطلوب (3 أحرف على الأقل)").regex(/^[a-zA-Z0-9_.]+$/,"اسم المستخدم يمكن أن يحتوي على حروف وأرقام ونقاط وشرطات سفلية فقط."),email:i.Yj().email("البريد الإلكتروني غير صحيح"),phone:i.Yj().min(10,"رقم الهاتف غير صحيح"),role:i.Yj().min(1,"الدور مطلوب"),status:i.k5(["active","pending","blocked","rejected"]),department:i.Yj().optional(),position:i.Yj().optional(),boxId:i.Yj().optional(),password:i.Yj().optional(),avatarUrl:i.Yj().url().optional().or(i.eu("")),baseSalary:i.au.number().min(0).optional(),otpLoginEnabled:i.zM().optional()});function y({isEditing:a=!1,initialData:b,boxes:c,roles:e,onSuccess:i}){let{toast:s}=(0,u.dj)(),y=(0,g.mN)({resolver:(0,h.u)(x),defaultValues:{name:b?.name||"",username:b?.username||"",email:b?.email||"",phone:b?.phone||"",role:b?.role||"",status:b?.status||"pending",department:b?.department||"",position:b?.position||"",boxId:b?.boxId||"",password:"",avatarUrl:b?.avatarUrl||"",baseSalary:b?.baseSalary||0,otpLoginEnabled:b?.otpLoginEnabled||!1}}),{isSubmitting:z}=y.formState,A=async c=>{try{if(a&&b){let a=await (0,r.T)(b.uid,c);if(a.success&&a.updatedUser)s({title:"تم تحديث المستخدم بنجاح"}),i();else throw Error(a.error)}else{let a=await t(c);if(a.success&&a.newUser)s({title:"تم إضافة المستخدم بنجاح"}),i();else throw Error(a.error)}}catch(a){s({title:"خطأ",description:a.message,variant:"destructive"})}};return(0,d.jsx)(m.lV,{...y,children:(0,d.jsxs)("form",{onSubmit:y.handleSubmit(A),className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsx)(m.zB,{control:y.control,name:"name",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsxs)(m.lR,{children:["الاسم الكامل",(0,d.jsx)("span",{className:"text-destructive ms-1",children:"*"})]}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{...a})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"username",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsxs)(m.lR,{children:["اسم المستخدم",(0,d.jsx)("span",{className:"text-destructive ms-1",children:"*"})]}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{...a})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"email",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsxs)(m.lR,{children:["البريد الإلكتروني",(0,d.jsx)("span",{className:"text-destructive ms-1",children:"*"})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(n.A,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{type:"email",...a,className:"pr-10"})})]}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"phone",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsxs)(m.lR,{children:["رقم الهاتف",(0,d.jsx)("span",{className:"text-destructive ms-1",children:"*"})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(o.A,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{...a,className:"pr-10"})})]}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"password",render:({field:b})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsx)(m.lR,{children:"كلمة المرور"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{type:"password",placeholder:a?"اتركه فارغًا لعدم التغيير":"اتركه فارغًا لإنشاء كلمة عشوائية",...b})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"avatarUrl",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsx)(m.lR,{children:"رابط الصورة (اختياري)"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{type:"url",...a,placeholder:"https://example.com/avatar.png"})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"department",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsx)(m.lR,{children:"القسم"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{...a})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"position",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsx)(m.lR,{children:"المنصب"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(k.p,{...a})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"role",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsxs)(m.lR,{children:["الدور (الصلاحية)",(0,d.jsx)("span",{className:"text-destructive ms-1",children:"*"})]}),(0,d.jsxs)(l.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(m.MJ,{children:(0,d.jsx)(l.bq,{children:(0,d.jsx)(l.yv,{placeholder:"اختر دورًا..."})})}),(0,d.jsx)(l.gC,{children:(e||[]).map(a=>(0,d.jsx)(l.eb,{value:a.id,children:a.name},a.id))})]}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"status",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsxs)(m.lR,{children:["حالة الحساب",(0,d.jsx)("span",{className:"text-destructive ms-1",children:"*"})]}),(0,d.jsxs)(l.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(m.MJ,{children:(0,d.jsx)(l.bq,{children:(0,d.jsx)(l.yv,{})})}),(0,d.jsxs)(l.gC,{children:[(0,d.jsx)(l.eb,{value:"active",children:"نشط"}),(0,d.jsx)(l.eb,{value:"pending",children:"قيد المراجعة"}),(0,d.jsx)(l.eb,{value:"blocked",children:"محظور"}),(0,d.jsx)(l.eb,{value:"rejected",children:"مرفوض"})]})]}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"boxId",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsx)(m.lR,{children:"الصندوق المرتبط (اختياري)"}),(0,d.jsxs)(l.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(m.MJ,{children:(0,d.jsx)(l.bq,{children:(0,d.jsx)(l.yv,{placeholder:"اختر صندوقًا..."})})}),(0,d.jsx)(l.gC,{children:(c||[]).map(a=>(0,d.jsx)(l.eb,{value:a.id,children:a.name},a.id))})]}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"baseSalary",render:({field:a})=>(0,d.jsxs)(m.eI,{children:[(0,d.jsx)(m.lR,{children:"الراتب الأساسي"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(v.O,{onValueChange:a.onChange,value:a.value})}),(0,d.jsx)(m.C5,{})]})}),(0,d.jsx)(m.zB,{control:y.control,name:"otpLoginEnabled",render:({field:a})=>(0,d.jsxs)(m.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm md:col-span-2",children:[(0,d.jsx)(m.lR,{children:"تفعيل الدخول بـ OTP"}),(0,d.jsx)(m.MJ,{children:(0,d.jsx)(w.d,{checked:a.value,onCheckedChange:a.onChange})}),(0,d.jsx)(m.C5,{})]})})]}),(0,d.jsx)(f.Es,{className:"pt-4",children:(0,d.jsxs)(j.$,{type:"submit",disabled:z,children:[z?(0,d.jsx)(p.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,d.jsx)(q.A,{className:"me-2 h-4 w-4"}),a?"حفظ التعديلات":"إنشاء مستخدم"]})})]})})}function z({isEditing:a=!1,user:b,boxes:c,roles:g,children:h,onUserAdded:i,onUserUpdated:j}){let[k,l]=(0,e.useState)(!1);return(0,d.jsxs)(f.lG,{open:k,onOpenChange:l,children:[(0,d.jsx)(f.zM,{asChild:!0,children:h}),(0,d.jsxs)(f.Cf,{className:"sm:max-w-2xl",children:[(0,d.jsxs)(f.c7,{children:[(0,d.jsx)(f.L3,{children:a?"تعديل بيانات المستخدم":"إضافة مستخدم جديد"}),(0,d.jsx)(f.rr,{children:a?"قم بتحديث المعلومات أدناه.":"أدخل تفاصيل المستخدم الجديد وقم بتعيين الصلاحيات."})]}),(0,d.jsx)(y,{isEditing:a,initialData:b,boxes:c,roles:g,onSuccess:()=>{a&&j?j():!a&&i&&i(),l(!1)}})]})]})}},38183:(a,b,c)=>{c.d(b,{O:()=>e});var d=c(85708);let e=(0,d.createServerReference)("005773e734ccf3535fa61ed9b34042d47625b1ede6",d.callServer,void 0,d.findSourceMapURL,"getRoles")}};