"use strict";exports.id=3778,exports.ids=[3778],exports.modules={15262:(a,b,c)=>{c.d(b,{A:()=>o});var d=c(21124),e=c(38301),f=c(62186),g=c(35284),h=c(68120),i=c(93758),j=c(49113),k=c(49566),l=c(37448),m=c(65409),n=c(68254);function o({settings:a,onSettingsChanged:b}){let[c,o]=(0,e.useState)(a.theme?.invoice||{}),[p,q]=(0,e.useState)(!1),{toast:r}=(0,l.dj)(),s=(a,b)=>{o(c=>({...c,[a]:b}))},t=async()=>{q(!0),(await (0,m.X)({theme:{...a.theme,invoice:c}})).success?(r({title:"تم حفظ إعدادات الفاتورة بنجاح"}),b()):r({title:"خطأ",description:"لم يتم حفظ الإعدادات.",variant:"destructive"}),q(!1)};return(0,d.jsxs)(f.Zp,{children:[(0,d.jsxs)(f.aR,{children:[(0,d.jsx)(f.ZB,{children:"إعدادات الفواتير والتقارير المطبوعة"}),(0,d.jsx)(f.BT,{children:"تخصيص معلومات الشركة التي تظهر في رأس وتذييل الفواتير والتقارير عند طباعتها."})]}),(0,d.jsx)(f.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"اسم الشركة"}),(0,d.jsx)(i.p,{value:c.companyName||"",onChange:a=>s("companyName",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"رقم الهاتف"}),(0,d.jsx)(i.p,{value:c.companyPhone||"",onChange:a=>s("companyPhone",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5 md:col-span-2",children:[(0,d.jsx)(h.J,{children:"عنوان الشركة"}),(0,d.jsx)(i.p,{value:c.companyAddress||"",onChange:a=>s("companyAddress",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5 md:col-span-2",children:[(0,d.jsx)(h.J,{children:"الموقع الإلكتروني"}),(0,d.jsx)(i.p,{value:c.companyWeb||"",onChange:a=>s("companyWeb",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"لون ترويسة الجدول"}),(0,d.jsx)(i.p,{type:"color",value:c.headerColor||"#f3f4f6",onChange:a=>s("headerColor",a.target.value),className:"p-1 h-10"})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"لون عنوان الفاتورة"}),(0,d.jsx)(i.p,{type:"color",value:c.titleColor||"#333333",onChange:a=>s("titleColor",a.target.value),className:"p-1 h-10"})]}),(0,d.jsxs)("div",{className:"space-y-1.5 md:col-span-2",children:[(0,d.jsx)(h.J,{children:"نص التذييل"}),(0,d.jsx)(n.T,{value:c.footerText||"",onChange:a=>s("footerText",a.target.value)})]})]})}),(0,d.jsx)(f.wL,{className:"justify-end",children:(0,d.jsxs)(g.$,{onClick:t,disabled:p,children:[p&&(0,d.jsx)(j.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(k.A,{className:"me-2 h-4 w-4"}),"حفظ الإعدادات"]})})]})}},38862:(a,b,c)=>{c.d(b,{A:()=>t});var d=c(21124),e=c(38301),f=c(62186),g=c(35284),h=c(68120),i=c(93758),j=c(40822),k=c(10656),l=c(49113),m=c(49566),n=c(37448),o=c(72001),p=c(65409),q=c(6471),r=c(68254);let s=({feature:a,onFeatureChange:b})=>(0,d.jsxs)("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/50",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"العنوان"}),(0,d.jsx)(i.p,{value:a.title,onChange:c=>b({...a,title:c.target.value})})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"الوصف"}),(0,d.jsx)(r.T,{value:a.description,onChange:c=>b({...a,description:c.target.value})})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"رابط الصورة"}),(0,d.jsx)(i.p,{value:a.imageUrl,onChange:c=>b({...a,imageUrl:c.target.value})})]})]});function t({settings:a,onSettingsChanged:b}){let[c,t]=(0,e.useState)(a.theme?.landingPage||{}),[u,v]=(0,e.useState)(!1),{toast:w}=(0,n.dj)(),x=(a,b)=>{t(c=>({...c,[a]:b}))},y=(a,b,c)=>{t((0,o.jM)(d=>{d[a]||(d[a]={}),d[a][b]=c}))},z=(a,b)=>{t((0,o.jM)(c=>{c[a]=b}))},A=(a,b,c)=>{t((0,o.jM)(d=>{d.faqSection?.faqs&&(d.faqSection.faqs[a][b]=c)}))},B=(a,b,c)=>{t((0,o.jM)(d=>{d.partnersSection?.partners&&(d.partnersSection.partners[a][b]=c)}))},C=async()=>{v(!0),(await (0,p.X)({theme:{...a.theme,landingPage:c}})).success?(w({title:"تم حفظ إعدادات الواجهة بنجاح"}),b()):w({title:"خطأ",description:"لم يتم حفظ الإعدادات.",variant:"destructive"}),v(!1)};return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"قسم الهيرو الرئيسي"})}),(0,d.jsx)(f.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان الرئيسي"}),(0,d.jsx)(i.p,{value:c.heroTitle||"",onChange:a=>x("heroTitle",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان الفرعي"}),(0,d.jsx)(i.p,{value:c.heroSubtitle||"",onChange:a=>x("heroSubtitle",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"لون العنوان"}),(0,d.jsx)(i.p,{value:c.heroTitleColor||"",onChange:a=>x("heroTitleColor",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"لون العنوان الفرعي"}),(0,d.jsx)(i.p,{value:c.heroSubtitleColor||"",onChange:a=>x("heroSubtitleColor",a.target.value)})]})]})})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"أقسام الميزات الرئيسية"})}),(0,d.jsxs)(f.Wu,{className:"space-y-4",children:[(0,d.jsx)(s,{feature:c.smartTickets,onFeatureChange:a=>z("smartTickets",a)}),(0,d.jsx)(s,{feature:c.sourceAuditing,onFeatureChange:a=>z("sourceAuditing",a)}),(0,d.jsx)(s,{feature:c.financialManagement,onFeatureChange:a=>z("financialManagement",a)})]})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"قسم إدارة الديون"})}),(0,d.jsxs)(f.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان"}),(0,d.jsx)(i.p,{value:c.accountStatements?.title||"",onChange:a=>y("accountStatements","title",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"الوصف"}),(0,d.jsx)(r.T,{value:c.accountStatements?.description||"",onChange:a=>y("accountStatements","description",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"رابط الصورة"}),(0,d.jsx)(i.p,{value:c.accountStatements?.imageUrl||"",onChange:a=>y("accountStatements","imageUrl",a.target.value)})]})]})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"قسم التحليل المالي"})}),(0,d.jsxs)(f.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان"}),(0,d.jsx)(i.p,{value:c.financialAnalysis?.title||"",onChange:a=>y("financialAnalysis","title",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"الوصف"}),(0,d.jsx)(r.T,{value:c.financialAnalysis?.description||"",onChange:a=>y("financialAnalysis","description",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"رابط الصورة"}),(0,d.jsx)(i.p,{value:c.financialAnalysis?.imageUrl||"",onChange:a=>y("financialAnalysis","imageUrl",a.target.value)})]})]})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"قسم الخدمات"})}),(0,d.jsxs)(f.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان"}),(0,d.jsx)(i.p,{value:c.servicesSection?.title||"",onChange:a=>y("servicesSection","title",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"الوصف"}),(0,d.jsx)(r.T,{value:c.servicesSection?.description||"",onChange:a=>y("servicesSection","description",a.target.value)})]})]})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"قسم الشركاء"})}),(0,d.jsxs)(f.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان"}),(0,d.jsx)(i.p,{value:c.partnersSection?.title||"",onChange:a=>y("partnersSection","title",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"الوصف"}),(0,d.jsx)(r.T,{value:c.partnersSection?.description||"",onChange:a=>y("partnersSection","description",a.target.value)})]}),(0,d.jsx)(q.Separator,{}),(c.partnersSection?.partners||[]).map((a,b)=>(0,d.jsxs)("div",{className:"space-y-2 p-3 border rounded-md relative",children:[(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"absolute top-1 left-1 h-7 w-7 text-destructive",onClick:()=>{t((0,o.jM)(a=>{a.partnersSection?.partners&&a.partnersSection.partners.splice(b,1)}))},children:(0,d.jsx)(j.A,{className:"h-4 w-4"})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"اسم الشريك"}),(0,d.jsx)(i.p,{value:a.name,onChange:a=>B(b,"name",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"رابط الشعار"}),(0,d.jsx)(i.p,{value:a.logoUrl,onChange:a=>B(b,"logoUrl",a.target.value)})]})]})]},b)),(0,d.jsxs)(g.$,{variant:"outline",size:"sm",onClick:()=>{t((0,o.jM)(a=>{a.partnersSection||(a.partnersSection={title:"شركاؤنا",description:"",partners:[]}),a.partnersSection.partners||(a.partnersSection.partners=[]),a.partnersSection.partners.push({name:"شريك جديد",logoUrl:""})}))},children:[(0,d.jsx)(k.A,{className:"me-2 h-4 w-4"})," إضافة شريك"]})]})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"قسم الأسئلة الشائعة"})}),(0,d.jsxs)(f.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"العنوان"}),(0,d.jsx)(i.p,{value:c.faqSection?.title||"",onChange:a=>y("faqSection","title",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"الوصف"}),(0,d.jsx)(r.T,{value:c.faqSection?.description||"",onChange:a=>y("faqSection","description",a.target.value)})]}),(0,d.jsx)(q.Separator,{}),(c.faqSection?.faqs||[]).map((a,b)=>(0,d.jsxs)("div",{className:"space-y-2 p-3 border rounded-md relative",children:[(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"absolute top-1 left-1 h-7 w-7 text-destructive",onClick:()=>{t((0,o.jM)(a=>{a.faqSection?.faqs&&a.faqSection.faqs.splice(b,1)}))},children:(0,d.jsx)(j.A,{className:"h-4 w-4"})}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"السؤال"}),(0,d.jsx)(i.p,{value:a.question,onChange:a=>A(b,"question",a.target.value)})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(h.J,{children:"الجواب"}),(0,d.jsx)(r.T,{value:a.answer,onChange:a=>A(b,"answer",a.target.value)})]})]},b)),(0,d.jsxs)(g.$,{variant:"outline",size:"sm",onClick:()=>{t((0,o.jM)(a=>{a.faqSection||(a.faqSection={title:"الأسئلة الشائعة",description:"",faqs:[]}),a.faqSection.faqs||(a.faqSection.faqs=[]),a.faqSection.faqs.push({question:"سؤال جديد",answer:"جواب جديد"})}))},children:[(0,d.jsx)(k.A,{className:"me-2 h-4 w-4"})," إضافة سؤال"]})]})]}),(0,d.jsxs)(f.Zp,{children:[(0,d.jsx)(f.aR,{children:(0,d.jsx)(f.ZB,{children:"تذييل الصفحة"})}),(0,d.jsx)(f.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{children:"رابط صورة الخلفية"}),(0,d.jsx)(i.p,{value:c.footerImageUrl||"",onChange:a=>x("footerImageUrl",a.target.value)})]})})]}),(0,d.jsx)("div",{className:"flex justify-end mt-6",children:(0,d.jsxs)(g.$,{onClick:C,disabled:u,children:[u&&(0,d.jsx)(l.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(m.A,{className:"me-2 h-4 w-4"}),"حفظ كل التغييرات"]})})]})}},38976:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]])},61971:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("Paintbrush",[["path",{d:"m14.622 17.897-10.68-2.913",key:"vj2p1u"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z",key:"18tc5c"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15",key:"ytzfxy"}]])},65392:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$z:()=>l,C:()=>n,Sn:()=>m,nt:()=>p});var e=c(91488);c(27806);var f=c(91837),g=c(80446),h=c(7879),i=c(46204),j=c(40410),k=a([g,h]);[g,h]=k.then?(await k)():k;let o="site_assets",p=(0,i.cache)(async()=>{let a=await (0,g.Lf)();if(!a)return[];try{let b=await a.collection(o).orderBy("uploadedAt","desc").get();if(b.empty)return[];return b.docs.map(a=>a.data())}catch(a){return console.error("Error fetching site assets:",a),[]}});async function l(a){let b=await (0,g.Lf)();if(!b)return{success:!1,error:"Database not available"};try{return await b.collection(o).doc(a.id).set(a),(0,f.revalidatePath)("/settings/assets","layout"),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function m(a){let b=await (0,g.Lf)(),c=await (0,g.$E)();if(!b||!c)return{success:!1,error:"Database or Storage not available."};try{let d=c.bucket().file(a.fullPath);return await d.delete().catch(b=>{if(404!==b.code)throw b;console.log(`File not found in storage: ${a.fullPath}, proceeding to delete from Firestore.`)}),await b.collection(o).doc(a.id).delete(),(0,f.revalidatePath)("/settings/assets"),{success:!0}}catch(a){return console.error("Error deleting asset:",String(a)),{success:!1,error:`Failed to delete asset: ${a.message}`}}}async function n(a,b,c){let d=await (0,g.Lf)();if(!d)return{success:!1,error:"Database not available."};let e=d.collection("settings").doc("app_settings");try{return await d.runTransaction(async a=>{let f=await d.collection(o).where("fullPath","==",b).limit(1).get(),g=f.empty?null:f.docs[0].ref,i=f.empty?null:f.docs[0].data();if(c&&(await a.get(d.collection(o).where("assignment","==",c))).forEach(b=>{g&&b.id!==g.id&&a.update(b.ref,{assignment:null})}),i?.assignment&&i.assignment!==c){let b=i.assignment;a.set(e,{theme:{assets:{[b.split(".").pop()]:h.FieldValue.delete()}}},{merge:!0})}g&&a.update(g,{assignment:c});let j=c?c.split("."):[];if(c&&i){let b=j.reduceRight((a,b,c)=>(j.length,{[b]:a}),i.url);a.set(e,b,{merge:!0})}else if(j.length>0){let b=j.reduceRight((a,b,c)=>(j.length,{[b]:a}),h.FieldValue.delete());a.set(e,b,{merge:!0})}}),(0,f.revalidatePath)("/settings/assets","layout"),(0,f.revalidatePath)("/settings","layout"),(0,f.revalidatePath)("/","layout"),{success:!0}}catch(a){return console.error("Error updating asset assignment:",a),{success:!1,error:a.message}}}(0,j.D)([p,l,m,n]),(0,e.A)(p,"7fdebe13155335bb556251f1e5032d05ae0282193c",null),(0,e.A)(l,"40a1f99d595b1bc39c60f840e295836ec83118c059",null),(0,e.A)(m,"40a9f9da31716ed10fd563ed03c0c1260b08d34239",null),(0,e.A)(n,"70598e5955a51775f50fd6a8ba86c5acabb4a2e439",null),d()}catch(a){d(a)}})},73550:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},86306:(a,b,c)=>{c.d(b,{A:()=>z});var d=c(21124),e=c(38301),f=c.n(e),g=c(35284),h=c(62186),i=c(49113),j=c(38976),k=c(10994),l=c(46283),m=c(44943),n=c(8015),o=c(68120),p=c(93758),q=c(83557),r=c(49566),s=c(72001),t=c(89308),u=c(1420);let v=({label:a,value:b,onChange:c})=>(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(o.J,{children:a}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(p.p,{value:b,onChange:a=>c(a.target.value),className:"ps-12 font-mono"}),(0,d.jsx)(p.p,{type:"color",value:`#${b.split(" ").pop()}`,onChange:a=>{c(a.target.value)},className:"absolute left-1 top-1/2 -translate-y-1/2 h-8 w-10 p-1 bg-transparent border-none cursor-pointer"})]})]}),w=({title:a,config:b,onConfigChange:c})=>(0,d.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(b).map(([a,b])=>(0,d.jsx)(v,{label:a.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()),value:String(b),onChange:b=>c(a,b)},a))}),x=({loaderConfig:a,onLoaderChange:b})=>(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(o.J,{children:"لون الشريط"}),(0,d.jsx)(p.p,{value:a.color||"",onChange:c=>b({...a,color:c.target.value})})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(o.J,{children:"ارتفاع الشريط (px)"}),(0,d.jsx)(p.p,{type:"number",value:a.height||3,onChange:c=>b({...a,height:Number(c.target.value)})})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(0,d.jsx)(u.d,{id:"loader-shadow",checked:a.showShadow,onCheckedChange:c=>b({...a,showShadow:c})}),(0,d.jsx)(o.J,{htmlFor:"loader-shadow",children:"تفعيل تأثير التوهج"})]})]});function y({theme:a,onBack:b,onSave:c}){let{setActiveTheme:f}=(0,l.A)(),[h,k]=(0,e.useState)(a),[m,n]=(0,e.useState)(!1),o=async()=>{n(!0),await c(h),n(!1)},p=(a,b,c)=>{k((0,s.jM)(d=>{d.config[a]||(d.config[a]={}),d.config[a][b]=c}))};return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(g.$,{variant:"outline",onClick:b,children:[(0,d.jsx)(q.A,{className:"me-2 h-4 w-4"}),"العودة للثيمات"]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsxs)("h2",{className:"text-xl font-bold flex items-center justify-end gap-2",children:[(0,d.jsx)(j.A,{className:"h-5 w-5"}),"تخصيص ثيم: ",h.name]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"قم بتعديل قيم الألوان والإعدادات ليناسب علامتك التجارية."})]})]}),(0,d.jsxs)(t.nD,{type:"multiple",defaultValue:["light","dark"],children:[(0,d.jsxs)(t.As,{value:"light",children:[(0,d.jsx)(t.$m,{className:"font-bold text-base",children:"الألوان (الوضع الفاتح)"}),(0,d.jsx)(t.ub,{children:(0,d.jsx)(w,{title:"Light Mode",config:h.config.light,onConfigChange:(a,b)=>p("light",a,b)})})]}),(0,d.jsxs)(t.As,{value:"dark",children:[(0,d.jsx)(t.$m,{className:"font-bold text-base",children:"الألوان (الوضع الداكن)"}),(0,d.jsx)(t.ub,{children:(0,d.jsx)(w,{title:"Dark Mode",config:h.config.dark,onConfigChange:(a,b)=>p("dark",a,b)})})]}),(0,d.jsxs)(t.As,{value:"card",children:[(0,d.jsx)(t.$m,{className:"font-bold text-base",children:"ألوان بطاقات العملاء"}),(0,d.jsx)(t.ub,{children:(0,d.jsx)(w,{title:"Card Colors",config:h.config.card||{},onConfigChange:(a,b)=>p("card",a,b)})})]}),(0,d.jsxs)(t.As,{value:"loader",children:[(0,d.jsx)(t.$m,{className:"font-bold text-base",children:"إعدادات شريط التقدم (Loader)"}),(0,d.jsx)(t.ub,{children:(0,d.jsx)(x,{loaderConfig:h.config.loader||{},onLoaderChange:a=>k((0,s.jM)(h,b=>{b.config.loader=a}))})})]})]}),(0,d.jsx)("div",{className:"flex justify-end mt-6",children:(0,d.jsxs)(g.$,{onClick:o,disabled:m,size:"lg",children:[m&&(0,d.jsx)(i.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(r.A,{className:"me-2 h-4 w-4"}),"حفظ التعديلات على الثيم"]})})]})}function z(){let{activeTheme:a,setActiveTheme:b,isSaving:c,themeSettings:o,refreshData:p}=(0,l.A)(),[q,r]=(0,e.useState)(null),[s,t]=f().useState(!1),u=async a=>{p&&await p(),r(null)};return q?(0,d.jsx)(y,{theme:q,onBack:()=>r(null),onSave:u}):(0,d.jsxs)(h.Zp,{children:[(0,d.jsx)(h.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(h.ZB,{className:"flex items-center gap-2",children:"الثيمات العامة"}),(0,d.jsx)(h.BT,{children:"اختر الهوية البصرية التي تناسب علامتك التجارية. سيتم تطبيق الثيم على حسابك الشخصي."})]}),c&&(0,d.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,d.jsx)(i.A,{className:"h-4 w-4 animate-spin"}),"جاري حفظ اختيارك..."]})]})}),(0,d.jsx)(h.Wu,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:k.z.map(c=>{let{primary:e,secondary:f,accent:i,background:k}=c.config.light,l=[e,f,i,k].filter(Boolean),o=s&&c.id===a.id;return(0,d.jsxs)(h.Zp,{className:(0,m.cn)("cursor-pointer transition-all flex flex-col hover:shadow-lg",o?"border-primary ring-2 ring-primary/50":"hover:border-primary/50"),onClick:()=>b(c.id),children:[(0,d.jsxs)(h.aR,{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(h.ZB,{className:"text-base",children:c.name}),o&&(0,d.jsx)(n.A,{className:"h-5 w-5 text-primary"})]}),(0,d.jsx)(h.BT,{className:"text-xs",children:c.description})]}),(0,d.jsx)(h.Wu,{className:"flex-grow space-y-3",children:(0,d.jsx)("div",{className:"flex h-8 w-full gap-1",children:l.map((a,b)=>(0,d.jsx)("div",{className:"h-full w-full rounded",style:{backgroundColor:`hsl(${a})`}},b))})}),(0,d.jsx)(h.wL,{className:"p-3",children:(0,d.jsxs)(g.$,{variant:"secondary",size:"sm",className:"w-full",onClick:a=>{a.stopPropagation(),r(c)},children:[(0,d.jsx)(j.A,{className:"me-2 h-4 w-4"}),"تخصيص"]})})]},c.id)})})]})}},88791:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]])},90023:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},92754:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]])},95200:(a,b,c)=>{c.d(b,{A:()=>V});var d=c(21124),e=c(38301),f=c.n(e),g=c(62186),h=c(35284),i=c(73550),j=c(92242),k=c(27081),l=c(85708);let m=(0,l.createServerReference)("7fdebe13155335bb556251f1e5032d05ae0282193c",l.callServer,void 0,l.findSourceMapURL,"getSiteAssets"),n=(0,l.createServerReference)("70598e5955a51775f50fd6a8ba86c5acabb4a2e439",l.callServer,void 0,l.findSourceMapURL,"assignAsset");var o=c(24515),p=c(11563),q=c(90023),r=c(8015),s=c(97137),t=c(40822),u=c(99187),v=c(37448),w=c(63822),x=c(12439),y=c(49113),z=c(44943);let A=(0,l.createServerReference)("40a9f9da31716ed10fd563ed03c0c1260b08d34239",l.callServer,void 0,l.findSourceMapURL,"permanentDeleteAsset");function B({asset:a,onAssetDeleted:b,children:c}){let[f,g]=(0,e.useState)(!1),[h,i]=(0,e.useState)(!1),{toast:j}=(0,v.dj)(),k=async()=>{i(!0);let c=await A(a);c.success?(j({title:"تم حذف الأصل بنجاح"}),b(),g(!1)):j({title:"خطأ",description:c.error||"حدث خطأ أثناء حذف الأصل.",variant:"destructive"}),i(!1)};return(0,d.jsxs)(x.Lt,{open:f,onOpenChange:g,children:[(0,d.jsx)(x.tv,{asChild:!0,children:c}),(0,d.jsxs)(x.EO,{children:[(0,d.jsxs)(x.wd,{children:[(0,d.jsx)(x.r7,{children:"هل أنت متأكد تمامًا؟"}),(0,d.jsx)(x.$v,{children:"هذا الإجراء لا يمكن التراجع عنه. سيؤدي هذا إلى حذف الأصل بشكل دائم من الخادم."})]}),(0,d.jsxs)(x.ck,{children:[(0,d.jsx)(x.Zr,{children:"إلغاء"}),(0,d.jsxs)(x.Rx,{onClick:k,disabled:h,className:(0,z.cn)("bg-destructive text-destructive-foreground hover:bg-destructive/90"),children:[h?(0,d.jsx)(y.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,d.jsx)(t.A,{className:"me-2 h-4 w-4"}),"نعم، قم بالحذف النهائي"]})]})]})]})}let C=[{path:"theme.assets.sidebar_logo",label:"شعار الشريط الجانبي"},{path:"theme.assets.invoice_logo",label:"شعار الفواتير"}];function D({asset:a,onDataChange:b}){let{toast:c}=(0,v.dj)(),e=async d=>{let e=await n(a.id,a.fullPath,d);e.success?(c({title:"تم تعيين الأصل بنجاح"}),b()):c({title:"خطأ",description:e.error,variant:"destructive"})};return(0,d.jsxs)(g.Zp,{className:"group overflow-hidden",children:[(0,d.jsx)(g.Wu,{className:"p-0",children:(0,d.jsxs)("div",{className:"aspect-video w-full relative",children:[(0,d.jsx)(o.default,{src:a.url,alt:a.name,fill:!0,className:"object-contain",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 20vw"}),(0,d.jsxs)(p.rI,{children:[(0,d.jsx)(p.ty,{asChild:!0,children:(0,d.jsx)(h.$,{variant:"secondary",size:"icon",className:"absolute top-2 right-2 h-7 w-7",children:(0,d.jsx)(q.A,{className:"h-4 w-4"})})}),(0,d.jsxs)(p.SQ,{children:[(0,d.jsxs)(p.lv,{children:[(0,d.jsxs)(p.nV,{children:[(0,d.jsx)(i.A,{className:"me-2 h-4 w-4"}),"تعيين إلى..."]}),(0,d.jsxs)(p.M5,{children:[C.map(b=>(0,d.jsxs)(p._2,{onClick:()=>e(b.path),children:[a.assignment===b.path&&(0,d.jsx)(r.A,{className:"me-2 h-4 w-4"}),b.label]},b.path)),(0,d.jsx)(p.mB,{}),(0,d.jsx)(p._2,{onClick:()=>e(null),className:"text-destructive focus:text-destructive",children:"إلغاء التعيين"})]})]}),(0,d.jsxs)(p._2,{onSelect:()=>{navigator.clipboard.writeText(a.url),c({title:"تم نسخ الرابط"})},children:[(0,d.jsx)(s.A,{className:"me-2 h-4 w-4"})," نسخ الرابط"]}),(0,d.jsx)(p.mB,{}),(0,d.jsx)(B,{asset:a,onAssetDeleted:b,children:(0,d.jsxs)(p._2,{onSelect:a=>a.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,d.jsx)(t.A,{className:"me-2 h-4 w-4"})," حذف"]})})]})]}),a.assignment&&(0,d.jsx)(u.E,{className:"absolute bottom-2 right-2",children:C.find(b=>b.path===a.assignment)?.label||a.assignment})]})}),(0,d.jsxs)(g.wL,{className:"p-3 flex flex-col items-start text-xs",children:[(0,d.jsx)("p",{className:"font-semibold text-sm truncate w-full",children:a.name}),(0,d.jsxs)("div",{className:"text-muted-foreground w-full flex justify-between",children:[(0,d.jsxs)("span",{children:[((a.size||0)/1024).toFixed(1)," KB"]}),(0,d.jsx)("span",{children:(0,w.GP)(new Date(a.uploadedAt),"yyyy-MM-dd")})]})]})]})}var E=c(40068),F=c(90447),G=c(49566),H=c(31980),I=c(99546),J=c(50937),K=c(11134),L=c(27186),M=c(93758);let N=(0,l.createServerReference)("40a1f99d595b1bc39c60f840e295836ec83118c059",l.callServer,void 0,l.findSourceMapURL,"addSiteAsset");var O=c(33525),P=c(63009),Q=c(15003),R=c(13737);let S=I.Ik({name:I.Yj().min(3,"اسم الأصل مطلوب."),file:I.Nl(File).refine(a=>a.size>0,"الملف مطلوب.")});function T({onUploadSuccess:a,children:b}){let[c,g]=(0,e.useState)(!1),{toast:i}=(0,v.dj)(),{user:k}=(0,P.A)(),l=(0,H.mN)({resolver:(0,J.u)(S)}),{handleSubmit:m,control:n,setValue:p,watch:q,formState:{isSubmitting:r}}=l,s=q("file"),t=f().useCallback(a=>{a.length>0&&p("file",a[0],{shouldValidate:!0})},[p]),{getRootProps:u,getInputProps:w,isDragActive:x}=(0,K.VB)({onDrop:t,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".svg"]},multiple:!1}),z=async b=>{if(!k)return void i({title:"خطأ",description:"يجب أن تكون مسجلاً للدخول لرفع الملفات.",variant:"destructive"});try{let c=(0,O.c7)(R.y),d=(0,Q.A)(),e=`site-assets/${d}-${b.file.name}`,f=(0,O.KR)(c,e),h=await (0,O.D)(f,b.file),j=await (0,O.qk)(h.ref),m={id:d,name:b.name,url:j,fileName:b.file.name,fileType:b.file.type,size:b.file.size,uploadedAt:new Date().toISOString(),uploadedBy:k.uid,assignment:null,fullPath:e},n=await N(m);if(n.success)i({title:"تم رفع الأصل بنجاح"}),a(),g(!1),l.reset();else throw Error(n.error)}catch(a){i({title:"خطأ في الرفع",description:a.message,variant:"destructive"})}};return(0,d.jsxs)(E.lG,{open:c,onOpenChange:g,children:[(0,d.jsx)(E.zM,{asChild:!0,children:b}),(0,d.jsxs)(E.Cf,{children:[(0,d.jsxs)(E.c7,{children:[(0,d.jsx)(E.L3,{children:"رفع أصل جديد"}),(0,d.jsx)(E.rr,{children:"ارفع صورة أو شعارًا لاستخدامه في أجزاء مختلفة من النظام."})]}),(0,d.jsx)(L.lV,{...l,children:(0,d.jsxs)("form",{onSubmit:m(z),className:"space-y-4",children:[(0,d.jsx)(L.zB,{control:n,name:"name",render:({field:a})=>(0,d.jsxs)(L.eI,{children:[(0,d.jsx)(L.lR,{children:"اسم الأصل"}),(0,d.jsx)(L.MJ,{children:(0,d.jsx)(M.p,{placeholder:"مثال: شعار الفاتورة الرئيسي",...a})}),(0,d.jsx)(L.C5,{})]})}),(0,d.jsx)(L.zB,{control:n,name:"file",render:({field:a})=>(0,d.jsxs)(L.eI,{children:[(0,d.jsx)(L.lR,{children:"الملف"}),(0,d.jsxs)("div",{...u(),className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md cursor-pointer",children:[(0,d.jsx)("input",{...w(),id:"asset-file-upload"}),s?(0,d.jsxs)("div",{className:"relative w-40 h-40",children:[(0,d.jsx)(o.default,{src:URL.createObjectURL(s),alt:"Preview",layout:"fill",objectFit:"contain",className:"rounded-md"}),(0,d.jsx)(h.$,{variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-destructive text-destructive-foreground",onClick:a=>{a.stopPropagation(),p("file",null)},children:(0,d.jsx)(F.A,{className:"h-4 w-4"})})]}):(0,d.jsxs)("div",{className:"space-y-1 text-center",children:[(0,d.jsx)(j.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:x?"أفلت الملف هنا...":"اسحب وأفلت الملف هنا، أو انقر للاختيار"}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF, SVG up to 2MB"})]})]}),(0,d.jsx)(L.C5,{})]})}),(0,d.jsx)(E.Es,{children:(0,d.jsxs)(h.$,{type:"submit",disabled:r,children:[r&&(0,d.jsx)(y.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(G.A,{className:"me-2 h-4 w-4"}),"حفظ ورفع"]})})]})})]})]})}let U=({label:a,description:b,assetUrl:c,onAssign:e,assignmentPath:f,allAssets:j,onUnassign:k})=>(0,d.jsxs)(g.Zp,{className:"overflow-hidden shadow-sm",children:[(0,d.jsxs)(g.aR,{className:"flex flex-row items-start gap-4",children:[(0,d.jsx)("div",{className:"p-3 bg-muted rounded-md",children:(0,d.jsx)(i.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)(g.ZB,{className:"text-base",children:a}),(0,d.jsx)(g.BT,{className:"text-xs",children:b})]})]}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)("div",{className:"aspect-video w-full relative rounded-md border bg-muted/30 overflow-hidden flex items-center justify-center",children:c?(0,d.jsx)(o.default,{src:c,alt:a,fill:!0,className:"object-contain"}):(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"غير محدد"})})}),(0,d.jsxs)(g.wL,{className:"p-3 bg-muted/30 border-t flex justify-end gap-2",children:[(0,d.jsx)(h.$,{variant:"ghost",size:"sm",onClick:()=>k(f),disabled:!c,children:"إلغاء التعيين"}),(0,d.jsxs)(p.rI,{children:[(0,d.jsx)(p.ty,{asChild:!0,children:(0,d.jsx)(h.$,{variant:"secondary",size:"sm",children:"تغيير الصورة"})}),(0,d.jsx)(p.SQ,{children:j.map(a=>(0,d.jsx)(p._2,{onClick:()=>e(a,f),children:a.name},a.id))})]})]})]});function V({settings:a,onSettingsChanged:b}){let[c,f]=(0,e.useState)([]),[l,o]=(0,e.useState)(!0),{toast:p}=(0,v.dj)(),q=(0,e.useCallback)(async()=>{o(!0),m().then(f).finally(()=>o(!1))},[]),r=async(a,c)=>{let d=await n(a.id,a.fullPath,c);d.success?(p({title:"تم تعيين الأصل بنجاح"}),b()):p({title:"خطأ",description:d.error,variant:"destructive"})},s=async a=>{let c=await n("","",null);c.success?(p({title:"تم إلغاء تعيين الأصل"}),b()):p({title:"خطأ",description:c.error,variant:"destructive"})};return(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{className:"flex flex-row justify-between items-center",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(i.A,{className:"h-5 w-5"}),"إدارة أصول الموقع"]}),(0,d.jsx)(g.BT,{children:"ارفع وأدر الشعارات والأصول الأخرى المستخدمة في النظام."})]}),(0,d.jsx)(T,{onUploadSuccess:q,children:(0,d.jsxs)(h.$,{variant:"outline",children:[(0,d.jsx)(j.A,{className:"me-2 h-4 w-4"}),"رفع أصل جديد"]})})]}),(0,d.jsxs)(g.Wu,{className:"space-y-6",children:[(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"theme.assets.sidebar_logo",label:"شعار الشريط الجانبي",description:"يظهر في أعلى الشريط الجانبي"},{id:"theme.assets.invoice_logo",label:"شعار الفواتير والتقارير",description:"يظهر في ترويسة التقارير المطبوعة"}].map(b=>{let e=b.id.split("."),f=a;for(let a of e)if(void 0===(f=f?.[a]))break;let g="string"==typeof f?f:null;return(0,d.jsx)(U,{label:b.label,description:b.description,assetUrl:g,onAssign:r,onUnassign:()=>s(b.id),assignmentPath:b.id,allAssets:c},b.id)})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"font-bold text-lg mb-2",children:"مكتبة الوسائط"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"جميع الأصول التي تم رفعها. يمكنك تعيين أي منها لأحد الأقسام المخصصة أعلاه."}),(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:l?[void 0,void 0,void 0,void 0].map((a,b)=>(0,d.jsx)(k.E,{className:"aspect-video w-full rounded-lg"},b)):c.map(a=>(0,d.jsx)(D,{asset:a,onDataChange:q},a.id))})]})]})]})}},95378:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{DI:()=>m,EP:()=>q,EZ:()=>o,KB:()=>t,Lf:()=>n,d5:()=>p,zO:()=>r,zZ:()=>s});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(62641),i=c(58749),j=c(29631),k=c(40410),l=a([f,h,i,j]);async function m(a){let{clients:b}=await n({...a,all:!0});return b.map(a=>({value:a.id,label:`${a.name} ${a.code?`(${a.code})`:""}`,relationType:a.relationType,paymentType:a.paymentType}))}async function n(a={}){let{all:b=!1,limit:c=15,page:d=1,searchTerm:e,relationType:g,paymentType:h,status:i,country:j,province:k,sortBy:l="useCount_desc"}=a,m=await (0,f.Lf)();if(!m)return{clients:[],total:0};try{let f,n=m.collection("clients");g&&"all"!==g&&(n=n.where("relationType","in","client"===g?["client","both"]:"supplier"===g?["supplier","both"]:[g])),h&&"all"!==h&&(n=n.where("paymentType","==",h)),i&&"all"!==i&&(n=n.where("status","==",i)),!0===a.includeInactive||i||(n=n.where("status","==","active")),j&&"all"!==j&&(n=n.where("country","==",j)),k&&"all"!==k&&(n=n.where("province","==",k));let o=(await n.get()).docs;if(e){let a=e.toLowerCase();o=o.filter(b=>{let c=b.data();return c.name&&c.name.toLowerCase().includes(a)||c.phone&&String(c.phone).includes(a)||c.code&&c.code.toLowerCase().includes(a)})}let p=o.length;if(l){let[a,b]=l.split("_");o.sort((c,d)=>{let e=c.data(),f=d.data(),g=e[a],h=f[a];if(null==g)return 1;if(null==h)return -1;let i=0;return"string"==typeof g&&"string"==typeof h?i=g.localeCompare(h):g>h?i=1:g<h&&(i=-1),"desc"===b?-1*i:i})}if(b)f=o;else{let a=(d-1)*c;f=o.slice(a,a+c)}if(0===f.length)return{clients:[],total:0};return{clients:f.map(a=>{let b=a.data();return{...JSON.parse(JSON.stringify(b,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b)),id:a.id}}),total:p}}catch(a){return console.error("Error getting clients from Firestore: ",String(a)),{clients:[],total:0}}}async function o(a){let b=await (0,f.Lf)();if(!b)return null;try{let c=await b.collection("clients").doc(a).get();if(!c.exists)return null;let d=c.data(),e=JSON.parse(JSON.stringify(d,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b));return{id:c.id,...e}}catch(b){return console.error(`Error getting client by ID ${a}:`,String(b)),null}}async function p(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=c.name,e=await (0,j.tu)("CL"),f={...a,code:e,createdAt:new Date().toISOString(),createdBy:d,balance:{USD:0,IQD:0},lastTransaction:null,useCount:0};f.password&&f.password.length>=6||delete f.password;let h=await b.collection("clients").add(f);await (0,i.iL)({userId:c.uid,userName:c.name,action:"CREATE",targetType:"CLIENT",description:`أنشأ علاقة جديدة باسم: ${f.name} (ID: ${h.id})`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts");let k={...f,id:h.id};return{success:!0,client:k}}catch(a){return console.error("Error adding client:",a),{success:!1,error:a.message}}}async function q(a){let b=await (0,f.Lf)();if(!b)return{success:!1,count:0,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,count:0,error:"Unauthorized"};try{for(let d of a){let a=b.batch(),e=b.collection("clients").doc(),f=await (0,j.tu)("CL"),g={...d,code:f,createdAt:new Date().toISOString(),createdBy:`مستورد بواسطة ${c.name}`,type:d.type||"individual",relationType:d.relationType||"client",status:d.status||"active",balance:{USD:0,IQD:0},lastTransaction:null,useCount:0,avatarUrl:""};g.password||delete g.password,a.set(e,g),await a.commit()}return await (0,i.iL)({userId:c.uid,userName:c.name,action:"CREATE",targetType:"CLIENT",description:`استورد ${a.length} علاقات جديدة من ملف.`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/relations/settings"),(0,g.revalidatePath)("/reports/debts"),{success:!0,count:a.length}}catch(a){return console.error("Error adding multiple clients: ",String(a)),{success:!1,count:0,error:"Failed to add clients."}}}async function r(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};let d=await (0,h.$T)();if(!d)return{success:!1,error:"Unauthorized"};try{let e=JSON.parse(JSON.stringify(b));(""===b.password||void 0===b.password||null===b.password)&&delete e.password,await c.collection("clients").doc(a).update(e),await (0,i.iL)({userId:d.uid,userName:d.name,action:"UPDATE",targetType:"CLIENT",description:`عدل بيانات العلاقة (ID: ${a})`});let f=await c.collection("clients").doc(a).get(),h=JSON.parse(JSON.stringify(f.data(),(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b)),j={id:f.id,...h};return(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0,updatedClient:j}}catch(a){return console.error("Error updating client:",a),{success:!1,error:a.message}}}async function s(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=(await b.collection("clients").doc(a).get()).data();if(d?.useCount&&d.useCount>0)return{success:!1,error:"لا يمكن حذف هذه العلاقة لوجود معاملات مالية مرتبطة بها."};let e=d?.name||"unknown";return await b.collection("clients").doc(a).delete(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"CLIENT",description:`حذف العلاقة: ${e} (ID: ${a})`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function t(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=b.batch();return a.forEach(a=>{let c=b.collection("clients").doc(a);d.delete(c)}),await d.commit(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"CLIENT",description:`حذف ${a.length} علاقات بشكل جماعي.`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0}}catch(a){return{success:!1,error:a.message}}}[f,h,i,j]=l.then?(await l)():l,(0,k.D)([m,n,o,p,q,r,s,t]),(0,e.A)(m,"405872236907704344162aca1c38160d1eac727fe8",null),(0,e.A)(n,"400e621b7f78c4800cffc85d668ca10cd73eb6853c",null),(0,e.A)(o,"408c94c431661ae65070856bc4a78d84f2cbfcba1c",null),(0,e.A)(p,"403331dfc341d9a7f9cbe156b5d10cfd49a20be531",null),(0,e.A)(q,"408c54ad33973364b68d8475849f76b4a4ca590722",null),(0,e.A)(r,"6023146a7bfefc423ba02712c56694a31432de707c",null),(0,e.A)(s,"4085652545b10cc37283ef55992935bd43a8ce947e",null),(0,e.A)(t,"40f4619201eea9704cbf15357e730e9458fc66e834",null),d()}catch(a){d(a)}})},97137:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])}};