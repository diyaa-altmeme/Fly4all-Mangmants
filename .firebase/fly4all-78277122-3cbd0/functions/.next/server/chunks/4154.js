exports.id=4154,exports.ids=[4154],exports.modules={727:(a,b,c)=>{"use strict";c.d(b,{A:()=>E});var d=c(21124),e=c(38301),f=c(35284),g=c(68120),h=c(68254),i=c(45608),j=c(38692),k=c(11943),l=c(54163),m=c(49113),n=c(49566),o=c(99546),p=c(31980),q=c(50937),r=c(37448),s=c(5488),t=c(44943),u=c(40068),v=c(63009),w=c(21853),x=c(85708);let y=(0,x.createServerReference)("40341251e8d632597ecf83a7ab87f3793a83f06b51",x.callServer,void 0,x.findSourceMapURL,"createPaymentVoucher");var z=c(92351),A=c(25456),B=c(97802);let C=o.Ik({date:o.p6({required_error:"التاريخ مطلوب"}),payeeId:o.Yj().min(1,"اسم المستفيد مطلوب"),phoneNumber:o.Yj().optional(),fund:o.Yj().min(1,"الصندوق مطلوب"),details:o.Yj().optional(),currency:o.k5(["USD","IQD"]),totalAmount:o.Yj().or(o.ai()).transform(a=>Number(String(a).replace(/,/g,""))).refine(a=>a>0,{message:"المبلغ يجب أن يكون أكبر من صفر"}),exchangeRate:o.au.number().optional(),purpose:o.k5(["tickets","services"])}),D=({currency:a,className:b,...c})=>(0,d.jsx)(A.O,{currency:a,className:(0,t.cn)("text-right",b),currencyClassName:(0,t.cn)("USD"===a?"bg-accent text-accent-foreground":"bg-primary text-primary-foreground"),...c});function E({onVoucherAdded:a,selectedCurrency:b,onVoucherUpdated:c,isEditing:o,initialData:t}){let{data:x}=(0,B.Z)(),{user:A}=(0,v.A)(),{toast:E}=(0,r.dj)(),{control:F,handleSubmit:G,setValue:H,register:I,formState:{errors:J,isSubmitting:K},reset:L}=(0,p.mN)({resolver:(0,q.u)(C),defaultValues:o?t:{date:new Date,currency:b,totalAmount:void 0,details:"",payeeId:"",phoneNumber:"",exchangeRate:1405,purpose:"tickets",fund:A&&"role"in A?A.boxId:""}}),M=(0,e.useMemo)(()=>x?[...(x.clients||[]).map(a=>({value:a.id,label:`عميل: ${a.name}`})),...(x.suppliers||[]).map(a=>({value:a.id,label:`مورد: ${a.name}`}))]:[],[x]),N=async b=>{let d=E({title:`جاري ${o?"تحديث":"إضافة"} السند...`});try{if(o&&t?.id){let a=await (0,z.o)(t.id,{originalData:b,date:b.date.toISOString()});if(!a.success)throw Error(a.error);c&&c(b)}else{let c=await y({date:b.date.toISOString(),toSupplierId:b.payeeId,amount:b.totalAmount,currency:b.currency,boxId:b.fund,purpose:b.purpose,details:b.details,exchangeRate:b.exchangeRate});if(!c.success)throw Error(c.error);a&&a(b),L()}d.update({id:d.id,title:`تم ${o?"تحديث":"إنشاء"} السند بنجاح`})}catch(a){d.update({id:d.id,title:"حدث خطأ",description:a.message,variant:"destructive"})}};return(0,d.jsxs)("form",{onSubmit:G(N),className:"flex flex-col h-full",children:[(0,d.jsxs)("div",{className:"p-6 space-y-6 flex-grow",children:[(0,d.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 items-start",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"payeeId",children:"اسم المستفيد"}),(0,d.jsx)(p.xI,{name:"payeeId",control:F,render:({field:a})=>(0,d.jsx)(w.j,{options:M,value:a.value,onValueChange:a.onChange,placeholder:"ابحث عن مورد..."})}),J.payeeId&&(0,d.jsx)("p",{className:"text-sm text-destructive mt-1",children:J.payeeId.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"fund",children:"الصندوق"}),(0,d.jsx)(p.xI,{control:F,name:"fund",render:({field:a})=>(0,d.jsxs)(i.l6,{value:a.value,onValueChange:a.onChange,children:[(0,d.jsx)(i.bq,{children:(0,d.jsx)(i.yv,{placeholder:"اختر الصندوق..."})}),(0,d.jsx)(i.gC,{children:(x?.boxes||[]).map(a=>(0,d.jsx)(i.eb,{value:a.id,children:a.name},a.id))})]})}),J.fund&&(0,d.jsx)("p",{className:"text-sm text-destructive mt-1",children:J.fund.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"purpose",children:"الغرض من الدفع"}),(0,d.jsx)(p.xI,{control:F,name:"purpose",render:({field:a})=>(0,d.jsxs)(i.l6,{value:a.value,onValueChange:a.onChange,children:[(0,d.jsx)(i.bq,{children:(0,d.jsx)(i.yv,{})}),(0,d.jsxs)(i.gC,{children:[(0,d.jsx)(i.eb,{value:"tickets",children:"تذاكر"}),(0,d.jsx)(i.eb,{value:"services",children:"خدمات"})]})]})})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"date",children:"التاريخ"}),(0,d.jsx)(p.xI,{control:F,name:"date",render:({field:a})=>(0,d.jsx)(s.K,{date:a.value,setDate:a.onChange})}),J.date&&(0,d.jsx)("p",{className:"text-sm text-destructive mt-1",children:J.date.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"totalAmount",children:"المبلغ المدفوع"}),(0,d.jsx)(p.xI,{name:"totalAmount",control:F,render:({field:a})=>(0,d.jsx)(D,{currency:b,...a,onValueChange:a.onChange})}),J.totalAmount&&(0,d.jsx)("p",{className:"text-sm text-destructive mt-1",children:J.totalAmount.message})]}),"USD"===b&&(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"exchangeRate",children:"سعر الصرف (مقابل الدينار)"}),(0,d.jsx)(p.xI,{name:"exchangeRate",control:F,render:({field:a})=>(0,d.jsx)(D,{currency:"IQD",...a,onValueChange:a.onChange})})]})]})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"details",children:"تفاصيل إضافية / البيان"}),(0,d.jsx)(h.T,{id:"details",...I("details")}),J.details&&(0,d.jsx)("p",{className:"text-sm text-destructive mt-1",children:J.details.message})]})]}),(0,d.jsx)(u.Es,{className:"p-4 border-t bg-background sticky bottom-0",children:(0,d.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(j.A,{className:"h-4 w-4"})," ",(0,d.jsxs)("span",{children:["المستخدم: ",A?.name||"..."]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(k.A,{className:"h-4 w-4"})," ",(0,d.jsx)("span",{children:"رقم الفاتورة: (تلقائي)"})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(f.$,{type:"button",onClick:()=>{},variant:"outline",disabled:K,children:[(0,d.jsx)(l.A,{className:"me-2 h-4 w-4"}),"حفظ وطباعة"]}),(0,d.jsxs)(f.$,{type:"submit",disabled:K,variant:"destructive",children:[K&&(0,d.jsx)(m.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(n.A,{className:"me-2 h-4 w-4"}),o?"حفظ التعديلات":"حفظ سند الدفع"]})]})]})})]})}},1420:(a,b,c)=>{"use strict";c.d(b,{d:()=>h});var d=c(21124),e=c(38301),f=c(75441),g=c(44943);let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.bL,{className:(0,g.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...b,ref:c,children:(0,d.jsx)(f.zi,{className:(0,g.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0 rtl:data-[state=checked]:-translate-x-4 rtl:data-[state=unchecked]:-translate-x-0")})}));h.displayName=f.bL.displayName},5488:(a,b,c)=>{"use strict";c.d(b,{K:()=>m});var d=c(21124);c(38301);var e=c(63822),f=c(98341),g=c(44943),h=c(35284),i=c(27410),j=c(77837),k=c(93758);function l({date:a,setDate:b}){let c=a?`${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`:"";return(0,d.jsx)(k.p,{type:"time",value:c,onChange:c=>{let d=c.target.value;if(!d||!a)return;let[e,f]=d.split(":").map(Number),g=new Date(a);g.setHours(e),g.setMinutes(f),b(g)},className:"text-center"})}function m({date:a,setDate:b}){return(0,d.jsxs)(j.AM,{children:[(0,d.jsx)(j.Wv,{asChild:!0,children:(0,d.jsxs)(h.$,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[(0,d.jsx)(f.A,{className:"mr-2 h-4 w-4"}),a?(0,e.GP)(a,"yyyy-MM-dd hh:mm a"):(0,d.jsx)("span",{children:"اختر تاريخ ووقت"})]})}),(0,d.jsxs)(j.hl,{className:"w-auto p-0",children:[(0,d.jsx)(i.V,{mode:"single",selected:a,onSelect:c=>{if(!c)return void b(void 0);let d=new Date(c);a&&(d.setHours(a.getHours()),d.setMinutes(a.getMinutes()),d.setSeconds(a.getSeconds())),b(d)},initialFocus:!0}),(0,d.jsx)("div",{className:"p-3 border-t border-border",children:(0,d.jsx)(l,{date:a,setDate:b})})]})]})}},6471:(a,b,c)=>{"use strict";c.d(b,{Separator:()=>h});var d=c(21124),e=c(38301),f=c(50012),g=c(44943);let h=e.forwardRef(({className:a,orientation:b="horizontal",decorative:c=!0,...e},h)=>(0,d.jsx)(f.b,{ref:h,decorative:c,orientation:b,className:(0,g.cn)("shrink-0 bg-border","horizontal"===b?"h-[1px] w-full":"h-full w-[1px]",a),...e}));h.displayName=f.b.displayName},8823:(a,b,c)=>{"use strict";c.d(b,{L:()=>e});var d=c(85708);let e=(0,d.createServerReference)("40fc6757a7ed8ba6cf86a7bf30e6bf0934f153f439",d.callServer,void 0,d.findSourceMapURL,"loginUser")},10923:(a,b,c)=>{"use strict";c.d(b,{A:()=>n});var d=c(21124),e=c(38301),f=c(77837),g=c(35284),h=c(68120),i=c(37448),j=c(25456),k=c(22874),l=c(12439);let m={width:"896px",height:"80vh"};function n({dialogKey:a,children:b,onDimensionsChange:c}){let{toast:n}=(0,i.dj)(),[o,p]=(0,e.useState)(m),q=a=>parseInt(a.replace(/px|vw|vh/g,""),10)||0;return(0,d.jsxs)(f.AM,{onOpenChange:b=>b&&(()=>{try{let b=JSON.parse(localStorage.getItem("voucherDialogSettings")||"{}")[a]||m;p(b),c(b)}catch(a){p(m),c(m)}})(),children:[(0,d.jsx)(f.Wv,{asChild:!0,children:b}),(0,d.jsx)(f.hl,{className:"w-80",children:(0,d.jsxs)("div",{className:"grid gap-4",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsxs)(l.Lt,{children:[(0,d.jsx)(l.tv,{asChild:!0,children:(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground",children:(0,d.jsx)(k.A,{className:"h-4 w-4"})})}),(0,d.jsxs)(l.EO,{children:[(0,d.jsxs)(l.wd,{children:[(0,d.jsx)(l.r7,{children:"إعادة تعيين؟"}),(0,d.jsx)(l.$v,{children:"هل تريد إعادة الأبعاد للحجم الافتراضي؟"})]}),(0,d.jsxs)(l.ck,{children:[(0,d.jsx)(l.Zr,{children:"إلغاء"}),(0,d.jsx)(l.Rx,{onClick:()=>{p(m);let b=JSON.parse(localStorage.getItem("voucherDialogSettings")||"{}");delete b[a],localStorage.setItem("voucherDialogSettings",JSON.stringify(b)),n({title:"تمت إعادة تعيين الأبعاد"})},children:"نعم"})]})]})]}),(0,d.jsx)("h4",{className:"font-medium leading-none text-right",children:"أبعاد النافذة"})]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground text-right",children:"تحكم في حجم النافذة لتناسب شاشتك."})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,d.jsx)(j.O,{id:"width",value:q(o.width),onValueChange:a=>p(b=>({...b,width:`${a||0}px`})),className:"col-span-2 h-8"}),(0,d.jsx)(h.J,{htmlFor:"width",children:"العرض (px)"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,d.jsx)(j.O,{id:"height",value:q(o.height),onValueChange:a=>p(b=>({...b,height:`${a||0}vh`})),className:"col-span-2 h-8"}),(0,d.jsx)(h.J,{htmlFor:"height",children:"الارتفاع (vh)"})]}),(0,d.jsx)(g.$,{onClick:()=>{try{let b={...JSON.parse(localStorage.getItem("voucherDialogSettings")||"{}"),[a]:o};localStorage.setItem("voucherDialogSettings",JSON.stringify(b)),n({title:"تم حفظ أبعاد النافذة"})}catch(a){n({title:"خطأ",description:"لم يتم حفظ الإعدادات",variant:"destructive"})}},size:"sm",className:"mt-2",children:"حفظ الأبعاد"})]})]})})]})}},10994:(a,b,c)=>{"use strict";c.d(b,{x:()=>e,z:()=>d});let d=[{id:"mudarib-modern",name:"Mudarib Modern",description:"الثيم الافتراضي الحديث بألوان زرقاء وبرتقالية.",config:{light:{background:"220 100% 97%",foreground:"220 13% 20%",card:"0 0% 100%",primary:"217 90% 60%",primaryForeground:"210 40% 98%",secondary:"210 40% 96.1%",accent:"30 100% 60%",border:"220 13% 91%",input:"220 13% 91%",ring:"217 90% 60%",radius:"12px"},dark:{background:"222 47% 11%",foreground:"210 40% 98%",card:"222 47% 15%",primary:"217 90% 68%",primaryForeground:"210 40% 98%",secondary:"217 33% 17%",accent:"30 100% 65%",border:"217 33% 25%",input:"217 33% 25%",ring:"217 90% 68%",radius:"12px"},loader:{color:"hsl(217, 90%, 60%)",height:3,showShadow:!0},card:{headerClientColorFrom:"hsl(217, 90%, 60%)",headerClientColorTo:"hsl(217, 100%, 73%)",headerSupplierColorFrom:"hsl(30, 90%, 55%)",headerSupplierColorTo:"hsl(30, 100%, 60%)",headerBothColorFrom:"hsl(217, 90%, 60%)",headerBothColorTo:"hsl(30, 100%, 60%)"}}},{id:"desert-mirage",name:"السراب الصحراوي",description:"ألوان ترابية دافئة مع لمسات ذهبية.",config:{light:{background:"39 31% 94%",foreground:"39 44% 20%",card:"0 0% 100%",primary:"39 84% 52%",primaryForeground:"39 44% 15%",secondary:"39 25% 90%",accent:"25 80% 50%",border:"39 20% 85%",input:"39 20% 85%",ring:"39 84% 52%",radius:"8px"},dark:{background:"39 44% 10%",foreground:"39 31% 94%",card:"39 44% 15%",primary:"39 84% 62%",primaryForeground:"39 31% 94%",secondary:"39 44% 20%",accent:"25 80% 60%",border:"39 44% 25%",input:"39 44% 25%",ring:"39 84% 62%",radius:"8px"},loader:{color:"#DAA520",height:3,showShadow:!0},card:{headerClientColorFrom:"#D4AF37",headerClientColorTo:"#C09526",headerSupplierColorFrom:"#A0522D",headerSupplierColorTo:"#8B4513",headerBothColorFrom:"#D4AF37",headerBothColorTo:"#A0522D"}}},{id:"oceanic-breeze",name:"النسيم المحيطي",description:"درجات من الأخضر البحري والأزرق السماوي.",config:{light:{background:"180 35% 96%",foreground:"180 25% 20%",card:"0 0% 100%",primary:"170 80% 40%",primaryForeground:"0 0% 100%",secondary:"180 25% 92%",accent:"190 85% 55%",border:"180 25% 88%",input:"180 25% 88%",ring:"170 80% 40%",radius:"16px"},dark:{background:"180 25% 10%",foreground:"180 35% 96%",card:"180 25% 15%",primary:"170 80% 50%",primaryForeground:"0 0% 100%",secondary:"180 25% 20%",accent:"190 85% 65%",border:"180 25% 25%",input:"180 25% 25%",ring:"170 80% 50%",radius:"16px"},loader:{color:"#20C997",height:4,showShadow:!1},card:{headerClientColorFrom:"hsl(170, 80%, 40%)",headerClientColorTo:"hsl(190, 85%, 55%)",headerSupplierColorFrom:"#008B8B",headerSupplierColorTo:"#20B2AA",headerBothColorFrom:"hsl(170, 80%, 40%)",headerBothColorTo:"hsl(190, 85%, 55%)"}}},{id:"ruby-royale",name:"الياقوت الملكي",description:"مزيج من الأحمر الياقوتي والرمادي الداكن.",config:{light:{background:"0 0% 98%",foreground:"0 0% 10%",card:"0 0% 100%",primary:"340 82% 52%",primaryForeground:"0 0% 100%",secondary:"0 0% 95%",accent:"240 5% 50%",border:"0 0% 90%",input:"0 0% 90%",ring:"340 82% 52%",radius:"4px"},dark:{background:"0 0% 10%",foreground:"0 0% 98%",card:"0 0% 15%",primary:"340 82% 62%",primaryForeground:"0 0% 100%",secondary:"0 0% 20%",accent:"240 5% 60%",border:"0 0% 25%",input:"0 0% 25%",ring:"340 82% 62%",radius:"4px"},loader:{color:"#E0115F",height:2,showShadow:!1},card:{headerClientColorFrom:"hsl(340, 82%, 52%)",headerClientColorTo:"hsl(340, 90%, 65%)",headerSupplierColorFrom:"hsl(240, 5%, 50%)",headerSupplierColorTo:"hsl(240, 5%, 65%)",headerBothColorFrom:"hsl(340, 82%, 52%)",headerBothColorTo:"hsl(240, 5%, 50%)"}}},{id:"emerald-night",name:"الزمرد الليلي",description:"أخضر زمردي عميق مع تفاصيل ذهبية.",config:{light:{background:"145 25% 97%",foreground:"145 20% 15%",card:"0 0% 100%",primary:"145 63% 42%",primaryForeground:"0 0% 100%",secondary:"145 15% 94%",accent:"45 74% 47%",border:"145 15% 88%",input:"145 15% 88%",ring:"145 63% 42%",radius:"8px"},dark:{background:"145 20% 10%",foreground:"145 25% 97%",card:"145 20% 14%",primary:"145 63% 52%",primaryForeground:"0 0% 100%",secondary:"145 20% 18%",accent:"45 74% 57%",border:"145 20% 22%",input:"145 20% 22%",ring:"145 63% 52%",radius:"8px"},loader:{color:"#009B77",height:3,showShadow:!0},card:{headerClientColorFrom:"hsl(145, 63%, 42%)",headerClientColorTo:"hsl(145, 63%, 32%)",headerSupplierColorFrom:"hsl(45, 74%, 47%)",headerSupplierColorTo:"hsl(45, 74%, 37%)",headerBothColorFrom:"hsl(145, 63%, 42%)",headerBothColorTo:"hsl(45, 74%, 47%)"}}},{id:"sakura-dream",name:"حلم الساكورا",description:"وردي هادئ مستوحى من زهور الكرز اليابانية.",config:{light:{background:"350 100% 98%",foreground:"350 20% 25%",card:"0 0% 100%",primary:"340 80% 75%",primaryForeground:"340 80% 15%",secondary:"350 50% 95%",accent:"330 75% 65%",border:"350 40% 90%",input:"350 40% 90%",ring:"340 80% 75%",radius:"10px"},dark:{background:"350 20% 12%",foreground:"350 100% 98%",card:"350 20% 16%",primary:"340 80% 65%",primaryForeground:"0 0% 100%",secondary:"350 20% 20%",accent:"330 75% 75%",border:"350 20% 25%",input:"350 20% 25%",ring:"340 80% 65%",radius:"10px"},loader:{color:"#FFB7C5",height:3,showShadow:!1},card:{headerClientColorFrom:"hsl(340, 80%, 75%)",headerClientColorTo:"hsl(340, 80%, 85%)",headerSupplierColorFrom:"hsl(330, 75%, 65%)",headerSupplierColorTo:"hsl(330, 75%, 75%)",headerBothColorFrom:"hsl(340, 80%, 75%)",headerBothColorTo:"hsl(330, 75%, 65%)"}}},{id:"slate-professional",name:"الرمادي الاحترافي",description:"تصميم احترافي بألوان رمادية محايدة.",config:{light:{background:"215 20% 97%",foreground:"215 28% 17%",card:"0 0% 100%",primary:"220 15% 45%",primaryForeground:"0 0% 100%",secondary:"215 20% 92%",accent:"220 15% 65%",border:"215 20% 88%",input:"215 20% 88%",ring:"220 15% 45%",radius:"6px"},dark:{background:"220 15% 12%",foreground:"215 20% 97%",card:"220 15% 16%",primary:"220 15% 55%",primaryForeground:"0 0% 100%",secondary:"220 15% 20%",accent:"220 15% 75%",border:"220 15% 25%",input:"220 15% 25%",ring:"220 15% 55%",radius:"6px"},loader:{color:"#708090",height:3,showShadow:!1},card:{headerClientColorFrom:"hsl(220, 15%, 45%)",headerClientColorTo:"hsl(220, 15%, 55%)",headerSupplierColorFrom:"hsl(220, 15%, 65%)",headerSupplierColorTo:"hsl(220, 15%, 75%)",headerBothColorFrom:"hsl(220, 15%, 45%)",headerBothColorTo:"hsl(220, 15%, 65%)"}}},{id:"cyberpunk-neon",name:"النيون المستقبلي",description:"ألوان زاهية وداكنة مستوحاة من عالم السايبربنك.",config:{light:{background:"240 10% 10%",foreground:"270 80% 90%",card:"240 10% 15%",primary:"290 100% 65%",primaryForeground:"0 0% 100%",secondary:"240 10% 20%",accent:"180 100% 50%",border:"240 10% 25%",input:"240 10% 25%",ring:"290 100% 65%",radius:"2px"},dark:{background:"240 10% 5%",foreground:"270 80% 95%",card:"240 10% 12%",primary:"290 100% 70%",primaryForeground:"0 0% 100%",secondary:"240 10% 18%",accent:"180 100% 55%",border:"240 10% 20%",input:"240 10% 20%",ring:"290 100% 70%",radius:"2px"},loader:{color:"#FF00FF",height:2,showShadow:!0},card:{headerClientColorFrom:"hsl(290, 100%, 65%)",headerClientColorTo:"hsl(180, 100%, 50%)",headerSupplierColorFrom:"hsl(180, 100%, 50%)",headerSupplierColorTo:"hsl(50, 100%, 50%)",headerBothColorFrom:"hsl(290, 100%, 65%)",headerBothColorTo:"hsl(50, 100%, 50%)"}}},{id:"forest-whisper",name:"همس الغابة",description:"ألوان طبيعية هادئة من وحي الغابات.",config:{light:{background:"120 15% 98%",foreground:"120 25% 15%",card:"0 0% 100%",primary:"120 40% 45%",primaryForeground:"0 0% 100%",secondary:"120 10% 94%",accent:"90 35% 55%",border:"120 10% 88%",input:"120 10% 88%",ring:"120 40% 45%",radius:"12px"},dark:{background:"120 25% 8%",foreground:"120 15% 98%",card:"120 25% 12%",primary:"120 40% 55%",primaryForeground:"0 0% 100%",secondary:"120 25% 16%",accent:"90 35% 65%",border:"120 25% 20%",input:"120 25% 20%",ring:"120 40% 55%",radius:"12px"},loader:{color:"#556B2F",height:3,showShadow:!1},card:{headerClientColorFrom:"hsl(120, 40%, 45%)",headerClientColorTo:"hsl(120, 40%, 35%)",headerSupplierColorFrom:"hsl(90, 35%, 55%)",headerSupplierColorTo:"hsl(90, 35%, 45%)",headerBothColorFrom:"hsl(120, 40%, 45%)",headerBothColorTo:"hsl(90, 35%, 55%)"}}},{id:"amethyst-sky",name:"سماء الجمشت",description:"درجات من البنفسجي والأرجواني مستوحاة من سماء الغروب.",config:{light:{background:"270 50% 97%",foreground:"270 30% 20%",card:"0 0% 100%",primary:"270 70% 60%",primaryForeground:"0 0% 100%",secondary:"270 40% 94%",accent:"300 75% 70%",border:"270 40% 88%",input:"270 40% 88%",ring:"270 70% 60%",radius:"20px"},dark:{background:"270 30% 10%",foreground:"270 50% 97%",card:"270 30% 14%",primary:"270 70% 70%",primaryForeground:"0 0% 100%",secondary:"270 30% 18%",accent:"300 75% 80%",border:"270 30% 22%",input:"270 30% 22%",ring:"270 70% 70%",radius:"20px"},loader:{color:"#9966CC",height:4,showShadow:!0},card:{headerClientColorFrom:"hsl(270, 70%, 60%)",headerClientColorTo:"hsl(270, 70%, 50%)",headerSupplierColorFrom:"hsl(300, 75%, 70%)",headerSupplierColorTo:"hsl(300, 75%, 60%)",headerBothColorFrom:"hsl(270, 70%, 60%)",headerBothColorTo:"hsl(300, 75%, 70%)"}}},{id:"golden-sands",name:"رمال ذهبية",description:"تصميم فاخر بألوان الذهب والرمال.",config:{light:{background:"45 50% 95%",foreground:"35 30% 25%",card:"0 0% 100%",primary:"45 80% 55%",primaryForeground:"35 30% 15%",secondary:"45 40% 90%",accent:"30 70% 60%",border:"45 30% 85%",input:"45 30% 85%",ring:"45 80% 55%",radius:"10px"},dark:{background:"35 30% 10%",foreground:"45 50% 95%",card:"35 30% 15%",primary:"45 80% 65%",primaryForeground:"45 50% 95%",secondary:"35 30% 20%",accent:"30 70% 70%",border:"35 30% 25%",input:"35 30% 25%",ring:"45 80% 65%",radius:"10px"},loader:{color:"#E6B800",height:3,showShadow:!0},card:{headerClientColorFrom:"hsl(45, 80%, 55%)",headerClientColorTo:"hsl(30, 70%, 60%)",headerSupplierColorFrom:"hsl(35, 30%, 40%)",headerSupplierColorTo:"hsl(35, 30%, 30%)",headerBothColorFrom:"hsl(45, 80%, 55%)",headerBothColorTo:"hsl(35, 30%, 40%)"}}},{id:"arctic-dawn",name:"فجر القطب",description:"تصميم نقي ومنعش بألوان زرقاء جليدية.",config:{light:{background:"200 100% 98%",foreground:"210 30% 20%",card:"0 0% 100%",primary:"190 80% 60%",primaryForeground:"210 30% 10%",secondary:"200 50% 95%",accent:"210 90% 70%",border:"200 40% 90%",input:"200 40% 90%",ring:"190 80% 60%",radius:"12px"},dark:{background:"210 30% 12%",foreground:"200 100% 98%",card:"210 30% 18%",primary:"190 80% 70%",primaryForeground:"200 100% 98%",secondary:"210 30% 22%",accent:"210 90% 80%",border:"210 30% 28%",input:"210 30% 28%",ring:"190 80% 70%",radius:"12px"},loader:{color:"#66D9EF",height:3,showShadow:!1},card:{headerClientColorFrom:"hsl(190, 80%, 60%)",headerClientColorTo:"hsl(210, 90%, 70%)",headerSupplierColorFrom:"hsl(210, 30%, 50%)",headerSupplierColorTo:"hsl(210, 30%, 40%)",headerBothColorFrom:"hsl(190, 80%, 60%)",headerBothColorTo:"hsl(210, 30%, 50%)"}}},{id:"volcanic-ash",name:"رماد بركاني",description:"مظهر درامي بألوان داكنة مع لمسة من الأحمر الناري.",config:{light:{background:"0 0% 90%",foreground:"0 0% 10%",card:"0 0% 98%",primary:"0 85% 55%",primaryForeground:"0 0% 100%",secondary:"0 0% 85%",accent:"20 90% 55%",border:"0 0% 80%",input:"0 0% 80%",ring:"0 85% 55%",radius:"4px"},dark:{background:"0 0% 8%",foreground:"0 0% 90%",card:"0 0% 12%",primary:"0 85% 65%",primaryForeground:"0 0% 100%",secondary:"0 0% 18%",accent:"20 90% 65%",border:"0 0% 22%",input:"0 0% 22%",ring:"0 85% 65%",radius:"4px"},loader:{color:"#FF4500",height:2,showShadow:!0},card:{headerClientColorFrom:"hsl(0, 85%, 55%)",headerClientColorTo:"hsl(20, 90%, 55%)",headerSupplierColorFrom:"hsl(0, 0%, 30%)",headerSupplierColorTo:"hsl(0, 0%, 20%)",headerBothColorFrom:"hsl(0, 85%, 55%)",headerBothColorTo:"hsl(0, 0%, 30%)"}}},{id:"royal-gold",name:"الذهب الملكي",description:"تصميم ملكي يجمع بين الأزرق العميق والبنفسجي مع لمسات ذهبية.",config:{light:{background:"240 20% 98%",foreground:"240 20% 15%",card:"0 0% 100%",primary:"250 60% 50%",primaryForeground:"0 0% 100%",secondary:"240 10% 95%",accent:"45 80% 50%",border:"240 10% 90%",input:"240 10% 90%",ring:"250 60% 50%",radius:"10px"},dark:{background:"240 20% 10%",foreground:"240 20% 98%",card:"240 20% 14%",primary:"250 60% 60%",primaryForeground:"0 0% 100%",secondary:"240 20% 18%",accent:"45 80% 60%",border:"240 20% 24%",input:"240 20% 24%",ring:"250 60% 60%",radius:"10px"},loader:{color:"#FFD700",height:3,showShadow:!0},card:{headerClientColorFrom:"hsl(250, 60%, 50%)",headerClientColorTo:"hsl(45, 80%, 50%)",headerSupplierColorFrom:"hsl(45, 80%, 50%)",headerSupplierColorTo:"hsl(45, 90%, 60%)",headerBothColorFrom:"hsl(250, 60%, 50%)",headerBothColorTo:"hsl(45, 80%, 50%)"}}},{id:"minty-fresh",name:"نعناع منعش",description:"تصميم خفيف ومنعش بألوان النعناع الأخضر والرمادي.",config:{light:{background:"150 40% 98%",foreground:"150 20% 20%",card:"0 0% 100%",primary:"150 70% 45%",primaryForeground:"0 0% 100%",secondary:"150 30% 95%",accent:"170 60% 50%",border:"150 30% 90%",input:"150 30% 90%",ring:"150 70% 45%",radius:"12px"},dark:{background:"150 20% 10%",foreground:"150 40% 98%",card:"150 20% 15%",primary:"150 70% 55%",primaryForeground:"0 0% 100%",secondary:"150 20% 20%",accent:"170 60% 60%",border:"150 20% 25%",input:"150 20% 25%",ring:"150 70% 55%",radius:"12px"},loader:{color:"#3EB489",height:3,showShadow:!1},card:{headerClientColorFrom:"hsl(150, 70%, 45%)",headerClientColorTo:"hsl(170, 60%, 50%)",headerSupplierColorFrom:"hsl(150, 20%, 60%)",headerSupplierColorTo:"hsl(150, 20%, 50%)",headerBothColorFrom:"hsl(150, 70%, 45%)",headerBothColorTo:"hsl(150, 20%, 60%)"}}},{id:"mocha-cafe",name:"مقهى الموكا",description:"ألوان دافئة ومريحة مستوحاة من القهوة.",config:{light:{background:"30 20% 96%",foreground:"30 40% 20%",card:"0 0% 100%",primary:"30 50% 40%",primaryForeground:"0 0% 100%",secondary:"30 15% 92%",accent:"25 60% 50%",border:"30 15% 88%",input:"30 15% 88%",ring:"30 50% 40%",radius:"8px"},dark:{background:"30 40% 10%",foreground:"30 20% 96%",card:"30 40% 15%",primary:"30 50% 50%",primaryForeground:"0 0% 100%",secondary:"30 40% 20%",accent:"25 60% 60%",border:"30 40% 25%",input:"30 40% 25%",ring:"30 50% 50%",radius:"8px"},loader:{color:"#A56A44",height:3,showShadow:!0},card:{headerClientColorFrom:"hsl(30, 50%, 40%)",headerClientColorTo:"hsl(25, 60%, 50%)",headerSupplierColorFrom:"hsl(30, 20%, 50%)",headerSupplierColorTo:"hsl(30, 20%, 40%)",headerBothColorFrom:"hsl(30, 50%, 40%)",headerBothColorTo:"hsl(30, 20%, 50%)"}}},{id:"sunset-glow",name:"وهج الغروب",description:"ألوان حيوية من تدرجات غروب الشمس.",config:{light:{background:"25 100% 97%",foreground:"15 40% 20%",card:"0 0% 100%",primary:"15 90% 60%",primaryForeground:"0 0% 100%",secondary:"25 80% 95%",accent:"340 90% 70%",border:"25 70% 90%",input:"25 70% 90%",ring:"15 90% 60%",radius:"16px"},dark:{background:"15 40% 10%",foreground:"25 100% 97%",card:"15 40% 15%",primary:"15 90% 70%",primaryForeground:"0 0% 100%",secondary:"15 40% 20%",accent:"340 90% 80%",border:"15 40% 25%",input:"15 40% 25%",ring:"15 90% 70%",radius:"16px"},loader:{color:"#FF8C69",height:4,showShadow:!0},card:{headerClientColorFrom:"hsl(15, 90%, 60%)",headerClientColorTo:"hsl(340, 90%, 70%)",headerSupplierColorFrom:"hsl(340, 50%, 60%)",headerSupplierColorTo:"hsl(340, 50%, 50%)",headerBothColorFrom:"hsl(15, 90%, 60%)",headerBothColorTo:"hsl(340, 50%, 60%)"}}},{id:"lavender-fields",name:"حقول الخزامى",description:"تصميم هادئ وأنيق بألوان الخزامى والبنفسجي الفاتح.",config:{light:{background:"255 60% 98%",foreground:"255 30% 25%",card:"0 0% 100%",primary:"255 70% 65%",primaryForeground:"0 0% 100%",secondary:"255 50% 95%",accent:"280 60% 70%",border:"255 40% 90%",input:"255 40% 90%",ring:"255 70% 65%",radius:"12px"},dark:{background:"255 30% 12%",foreground:"255 60% 98%",card:"255 30% 18%",primary:"255 70% 75%",primaryForeground:"0 0% 100%",secondary:"255 30% 22%",accent:"280 60% 80%",border:"255 30% 28%",input:"255 30% 28%",ring:"255 70% 75%",radius:"12px"},loader:{color:"#B2A9DF",height:3,showShadow:!1},card:{headerClientColorFrom:"hsl(255, 70%, 65%)",headerClientColorTo:"hsl(280, 60%, 70%)",headerSupplierColorFrom:"hsl(255, 30%, 60%)",headerSupplierColorTo:"hsl(255, 30%, 50%)",headerBothColorFrom:"hsl(255, 70%, 65%)",headerBothColorTo:"hsl(255, 30%, 60%)"}}},{id:"industrial-chic",name:"أناقة صناعية",description:"تصميم حديث يجمع بين الخرسانة والمعادن.",config:{light:{background:"210 20% 94%",foreground:"210 20% 10%",card:"0 0% 100%",primary:"210 15% 35%",primaryForeground:"0 0% 100%",secondary:"210 15% 90%",accent:"200 20% 50%",border:"210 15% 85%",input:"210 15% 85%",ring:"210 15% 35%",radius:"0px"},dark:{background:"210 20% 10%",foreground:"210 20% 94%",card:"210 20% 15%",primary:"210 15% 45%",primaryForeground:"0 0% 100%",secondary:"210 20% 20%",accent:"200 20% 60%",border:"210 20% 25%",input:"210 20% 25%",ring:"210 15% 45%",radius:"0px"},loader:{color:"#526D82",height:4,showShadow:!1},card:{headerClientColorFrom:"hsl(210, 15%, 35%)",headerClientColorTo:"hsl(200, 20%, 50%)",headerSupplierColorFrom:"hsl(210, 10%, 40%)",headerSupplierColorTo:"hsl(210, 10%, 30%)",headerBothColorFrom:"hsl(210, 15%, 35%)",headerBothColorTo:"hsl(210, 10%, 40%)"}}},{id:"crimson-black",name:"قرمزي وأسود",description:"تصميم جريء وقوي بألوان الأسود والأحمر القرمزي.",config:{light:{background:"0 0% 96%",foreground:"0 0% 5%",card:"0 0% 100%",primary:"350 80% 50%",primaryForeground:"0 0% 100%",secondary:"0 0% 92%",accent:"0 0% 30%",border:"0 0% 88%",input:"0 0% 88%",ring:"350 80% 50%",radius:"6px"},dark:{background:"0 0% 8%",foreground:"0 0% 96%",card:"0 0% 12%",primary:"350 80% 60%",primaryForeground:"0 0% 100%",secondary:"0 0% 18%",accent:"0 0% 40%",border:"0 0% 22%",input:"0 0% 22%",ring:"350 80% 60%",radius:"6px"},loader:{color:"#DC143C",height:2,showShadow:!0},card:{headerClientColorFrom:"hsl(350, 80%, 50%)",headerClientColorTo:"hsl(0, 0%, 30%)",headerSupplierColorFrom:"hsl(0, 0%, 30%)",headerSupplierColorTo:"hsl(0, 0%, 20%)",headerBothColorFrom:"hsl(350, 80%, 50%)",headerBothColorTo:"hsl(0, 0%, 30%)"}}}],e=a=>d.find(b=>b.id===a)||d[0]},11563:(a,b,c)=>{"use strict";c.d(b,{M5:()=>o,SQ:()=>p,_2:()=>q,lv:()=>m,mB:()=>r,nV:()=>n,rI:()=>k,ty:()=>l});var d=c(21124),e=c(38301),f=c(12927),g=c(77503),h=c(8015),i=c(46171),j=c(44943);let k=f.bL,l=f.l9;f.YJ,f.ZL;let m=f.Pb;f.z6;let n=e.forwardRef(({className:a,inset:b,children:c,...e},h)=>(0,d.jsxs)(f.ZP,{ref:h,className:(0,j.cn)("flex cursor-default gap-2 select-none items-center rounded-md px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",b&&"pl-8",a),...e,children:[(0,d.jsx)(g.A,{className:"mr-auto h-4 w-4"}),c]}));n.displayName=f.ZP.displayName;let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.G5,{ref:c,className:(0,j.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...b}));o.displayName=f.G5.displayName;let p=e.forwardRef(({className:a,sideOffset:b=4,...c},e)=>(0,d.jsx)(f.ZL,{children:(0,d.jsx)(f.UC,{ref:e,sideOffset:b,className:(0,j.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})}));p.displayName=f.UC.displayName;let q=e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(f.q7,{ref:e,className:(0,j.cn)("relative flex cursor-default select-none items-center gap-2 rounded-md px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",b&&"pl-8",a),...c}));q.displayName=f.q7.displayName,e.forwardRef(({className:a,children:b,checked:c,...e},g)=>(0,d.jsxs)(f.H_,{ref:g,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:c,...e,children:[(0,d.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(h.A,{className:"h-4 w-4"})})}),b]})).displayName=f.H_.displayName,e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.hN,{ref:e,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(i.A,{className:"h-2 w-2 fill-current"})})}),b]})).displayName=f.hN.displayName,e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(f.JU,{ref:e,className:(0,j.cn)("px-2 py-1.5 text-sm font-semibold",b&&"pr-8",a),...c})).displayName=f.JU.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wv,{ref:c,className:(0,j.cn)("-mx-1 my-1 h-px bg-muted",a),...b}));r.displayName=f.wv.displayName},11759:(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(38301);function e(){let[a,b]=d.useState(void 0);return d.useEffect(()=>{b(!1)},[]),!!a}},12439:(a,b,c)=>{"use strict";c.d(b,{$v:()=>q,EO:()=>m,Lt:()=>i,Rx:()=>r,Zr:()=>s,ck:()=>o,r7:()=>p,tv:()=>j,wd:()=>n});var d=c(21124),e=c(38301),f=c(34588),g=c(44943),h=c(35284);let i=f.bL,j=f.l9,k=f.ZL,l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hJ,{className:(0,g.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));l.displayName=f.hJ.displayName;let m=e.forwardRef(({className:a,...b},c)=>(0,d.jsxs)(k,{children:[(0,d.jsx)(l,{}),(0,d.jsx)(f.UC,{ref:c,className:(0,g.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...b})]}));m.displayName=f.UC.displayName;let n=({className:a,...b})=>(0,d.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});n.displayName="AlertDialogHeader";let o=({className:a,...b})=>(0,d.jsx)("div",{className:(0,g.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});o.displayName="AlertDialogFooter";let p=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hE,{ref:c,className:(0,g.cn)("text-lg font-semibold",a),...b}));p.displayName=f.hE.displayName;let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.VY,{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));q.displayName=f.VY.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.rc,{ref:c,className:(0,g.cn)((0,h.r)(),a),...b}));r.displayName=f.rc.displayName;let s=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.ZD,{ref:c,className:(0,g.cn)((0,h.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...b}));s.displayName=f.ZD.displayName},12832:()=>{},13732:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{r:()=>l});var e=c(91488);c(27806);var f=c(62641),g=c(91837),h=c(58749),i=c(15105),j=c(40410),k=a([f,h,i]);async function l(a){let b=await (0,f.$T)();if(!b)return{success:!1,error:"User not authenticated."};try{let c=await (0,i.a)({sourceType:"payment",sourceId:`payment-${Date.now()}`,description:`سند دفع: ${a.details||`لغرض ${a.purpose}`}`,amount:a.amount,currency:a.currency,date:new Date(a.date),userId:b.uid,debitAccountId:a.toSupplierId,creditAccountId:a.boxId});return await (0,h.iL)({userId:b.uid,userName:b.name,action:"CREATE",targetType:"VOUCHER",description:`أنشأ سند دفع بمبلغ ${a.amount} ${a.currency}.`,targetId:c}),(0,g.revalidatePath)("/accounts/vouchers/list"),(0,g.revalidatePath)("/reports/account-statement"),{success:!0,voucherId:c}}catch(a){return console.error("Error creating payment voucher: ",String(a)),{success:!1,error:a.message}}}[f,h,i]=k.then?(await k)():k,(0,j.D)([l]),(0,e.A)(l,"40341251e8d632597ecf83a7ab87f3793a83f06b51",null),d()}catch(a){d(a)}})},13737:(a,b,c)=>{"use strict";let d,e,f;c.d(b,{db:()=>f,j:()=>e,y:()=>d});var g=c(34410),h=c(45937),i=c(68618);d=(0,g.Dk)().length?(0,g.Dk)()[0]:(0,g.Wp)({apiKey:"AIzaSyCtlF3onBhtwg0Hh3iOOEjygi9mj81wxrA",authDomain:"fly4all-78277122-3cbd0.firebaseapp.com",projectId:"fly4all-78277122-3cbd0",storageBucket:"fly4all-78277122-3cbd0.firebasestorage.app",messagingSenderId:"108505683067",appId:"1:108505683067:web:3ab7755349630154e77ede"}),e=(0,i.xI)(d),f=(0,h.aU)(d)},15105:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{a:()=>l});var e=c(80446),f=c(7879),g=c(54756),h=c(29631),i=c(82357),j=c(21096),k=a([e,f,g,h]);async function l({sourceType:a,sourceId:b,description:c,amount:d,currency:k,date:l,userId:m,debitAccountId:n,creditAccountId:o,creditEntries:p,cost:q,revenueAccountId:r,clientId:s,supplierId:t}){let u=await (0,e.Lf)(),v=(await (0,g.mt)()).financeAccounts;if(!v)throw Error("Finance settings (financeAccounts) not found in settings/app_settings document!");let w=(0,i.uJ)(v),x=u.collection("journal-vouchers").doc(),y={invoiceNumber:await (0,h.tu)(a.toUpperCase()),date:l.toISOString(),currency:k,notes:c,createdBy:m||"system",officer:m||"system",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),voucherType:`journal_from_${a}`,debitEntries:[],creditEntries:[],isAudited:!1,isConfirmed:!0,originalData:{sourceType:a,sourceId:b,amount:d,cost:q||0}},z=q||0;if("segment"===a&&p){let a=n||s||w.receivableAccountId;if(!a)throw Error("Missing debit account for segment entry.");y.debitEntries.push({accountId:a,amount:d,description:`دين عن: ${c}`}),y.creditEntries.push(...p)}else if(z>0){let b=d-z,e=s||n||w.receivableAccountId,f=t||costAccountId||w.payableAccountId,g=r;if("booking"===a&&(g=g||w.revenueMap.tickets||w.generalRevenueId),"visa"===a&&(g=g||w.revenueMap.visas||w.generalRevenueId),"subscription"===a&&(g=g||w.revenueMap.subscriptions||w.generalRevenueId),"segment"===a&&(g=g||w.revenueMap.segments||w.generalRevenueId),g||(g=w.generalRevenueId),!e||!f||!g)throw Error("Missing default accounts for compound entry in finance settings.");y.debitEntries.push({accountId:e,amount:d,description:`دين عن: ${c}`}),y.creditEntries.push({accountId:f,amount:z,description:`تكلفة: ${c}`}),b>0?y.creditEntries.push({accountId:g,amount:b,description:`ربح عن: ${c}`}):b<0&&y.debitEntries.push({accountId:w.generalExpenseId||w.expenseMap.operating||"expense_general",amount:Math.abs(b),description:`خسارة عن: ${c}`})}else{let b=n||w.defaultCashId||w.receivableAccountId,e=o||w.payableAccountId||w.revenueMap.other||w.generalRevenueId;if(!b||!e)throw Error(`Could not determine debit/credit accounts for sourceType '${a}'. Check finance settings.`);y.debitEntries.push({accountId:b,amount:d,description:c}),y.creditEntries.push({accountId:e,amount:d,description:c})}let A=y.debitEntries.reduce((a,b)=>a+b.amount,0),B=y.creditEntries.reduce((a,b)=>a+b.amount,0);if(Math.abs(A-B)>.01)throw console.error("Journal Entry Imbalance Details:",{debits:y.debitEntries,credits:y.creditEntries,totalDebit:A,totalCredit:B}),Error(`Journal entry is not balanced. Debits: ${A}, Credits: ${B}`);return await x.set({...y,entries:[...y.debitEntries.map(a=>({accountId:a.accountId,debit:a.amount,credit:0,amount:a.amount,description:a.description,currency:y.currency,relationId:a.relationId,companyId:a.companyId,accountType:(0,j.Um)(a.accountId,w),type:"debit"})),...y.creditEntries.map(a=>({accountId:a.accountId,debit:0,credit:a.amount,amount:a.amount,description:a.description,currency:y.currency,relationId:a.relationId,companyId:a.companyId,accountType:(0,j.Um)(a.accountId,w),type:"credit"}))],createdAt:f.FieldValue.serverTimestamp(),updatedAt:f.FieldValue.serverTimestamp()}),console.log(`✅ Posted journal for ${a} (${b}) amount: ${d}`),x.id}[e,f,g,h]=k.then?(await k)():k,d()}catch(a){d(a)}})},17218:(a,b,c)=>{"use strict";c.d(b,{Providers:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call Providers() from the server but Providers is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/components/layout/providers.tsx","Providers")},18210:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Qt:()=>m,Z7:()=>q,ib:()=>o,oS:()=>n,xi:()=>r});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(63097),i=c(58749),j=c(62641),k=c(40410),l=a([f,i,j]);[f,i,j]=l.then?(await l)():l;let p=a=>{let b=a.data();if(!b)return null;let c=JSON.parse(JSON.stringify({...b,id:a.id}));for(let a in c)c[a]&&(c[a].hasOwnProperty("_seconds")||"function"==typeof c[a].toDate)&&(c[a]=new Date(1e3*c[a]._seconds||c[a].toDate()).toISOString());if(c.originalData&&"object"==typeof c.originalData)for(let a in c.originalData)c.originalData[a]&&(c.originalData[a].hasOwnProperty("_seconds")||"function"===c.originalData[a].toDate)&&(c.originalData[a]=new Date(1e3*c.originalData[a]._seconds||c.originalData[a].toDate()).toISOString());return c},q=async a=>{let b=await (0,f.Lf)();if(!b)return null;let c=b.collection("journal-vouchers").doc(a),d=await c.get();return d.exists?p(d):null},r=async(a,b,c,d,e)=>{try{let g=await (0,f.Lf)();if(!g)return console.log("Database not available, returning empty list of vouchers."),[];let i=new Map;a.forEach(a=>i.set(a.id,a.name)),b.forEach(a=>i.set(a.id,a.name)),c.forEach(a=>i.set(a.id,a.name)),e.voucherSettings?.expenseAccounts?.forEach(a=>{i.set(`expense_${a.id}`,a.name)});let j=new Map(c.map(a=>[a.id,a.name])),k=new Map(d.map(a=>[a.uid,a.name])),l=await g.collection("journal-vouchers").where("voucherType","in",["journal_from_standard_receipt","journal_from_distributed_receipt","journal_from_payment","journal_from_expense","journal_voucher"]).orderBy("createdAt","desc").limit(500).get(),m=[];return l.forEach(c=>{let d=p(c);if(!d)return;d.notes;let e=d.debitEntries?.reduce((a,b)=>a+(b.amount||0),0)||0,f=d.debitEntries?.[0]?.accountId,g=d.creditEntries?.[0]?.accountId,h="multiple",l=d.originalData||{};l.from?h=l.from:l.payeeId?h=l.payeeId:l.toSupplierId?h=l.toSupplierId:l.accountId?h=l.accountId:d.voucherType?.includes("receipt")?h=g:(d.voucherType?.includes("payment")||d.voucherType?.includes("expense"))&&(h=f);let n=a.find(a=>a.id===h)||b.find(a=>a.id===h),o=n?.name||l.companyName||l.from||l.payee||i.get(h)||"حركات متعددة",q=n?.phone||l.phoneNumber,r=l.boxId||l.toBox||d.creditEntries?.find(a=>j.has(a.accountId))?.accountId||d.debitEntries?.find(a=>j.has(a.accountId))?.accountId||"";m.push({...d,id:c.id,voucherTypeLabel:(a=>{switch(a){case"journal_from_standard_receipt":return"سند قبض عادي";case"journal_from_distributed_receipt":return"سند قبض مخصص";case"journal_from_payment":return"سند دفع";case"journal_from_expense":return"سند مصاريف";case"journal_voucher":return"قيد محاسبي";default:return a}})(d.voucherType),companyName:o,phone:q,officer:k.get(d.createdBy)||d.officer||"غير معروف",boxName:j.get(r)||"N/A",totalAmount:e})}),m.sort((a,b)=>{let c=a.createdAt?(0,h.H)(a.createdAt).getTime():(0,h.H)(a.date).getTime(),d=b.createdAt?(0,h.H)(b.createdAt).getTime():(0,h.H)(a.date).getTime();return d!==c?d-c:b.id.localeCompare(a.id)})}catch(a){return console.error("Error getting all vouchers: ",String(a)),[]}};async function m(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,j.$T)();if(!c)return{success:!1,error:"Unauthorized"};let d=b.batch();try{let e=b.collection("journal-vouchers").doc(a),f=await e.get();if(!f.exists)throw Error("Voucher not found");let h=f.data(),j=h?.invoiceNumber||a;if(h?.originalData?.bookingId){let a=b.collection("bookings").doc(h.originalData.bookingId);d.delete(a)}else if(h?.originalData?.visaBookingId){let a=b.collection("visaBookings").doc(h.originalData.visaBookingId);d.delete(a)}return d.delete(e),await d.commit(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"VOUCHER",description:`حذف السند رقم: ${j}`}),(0,g.revalidatePath)("/accounts/vouchers/list"),(0,g.revalidatePath)("/bookings"),(0,g.revalidatePath)("/visas"),(0,g.revalidatePath)("/reports","layout"),{success:!0}}catch(b){return console.error(`Error deleting voucher ${a}:`,b),{success:!1,error:"فشل حذف السند."}}}async function n(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};let d=await (0,j.$T)();if(!d)return{success:!1,error:"Unauthorized"};try{let e={...JSON.parse(JSON.stringify(b)),updatedAt:new Date().toISOString()};return e.date instanceof Date&&(e.date=e.date.toISOString()),await c.collection("journal-vouchers").doc(a).update(e),await (0,i.iL)({userId:d.uid,userName:d.name,action:"UPDATE",targetType:"VOUCHER",description:`عدل بيانات السند (ID: ${a}).`}),(0,g.revalidatePath)("/accounts/vouchers/list"),(0,g.revalidatePath)("/reports/account-statement"),{success:!0}}catch(b){return console.error(`Error updating voucher ${a}:`,String(b)),{success:!1,error:"فشل تحديث السند."}}}async function o(){let a=await (0,f.Lf)();if(!a)return{success:!1,error:"Database not available."};let b=await (0,j.$T)();if(!b)return{success:!1,error:"Unauthorized"};try{for(let b of["journal-vouchers"])try{let c=await a.collection(b).select().get();if(c.empty)continue;for(let b=0;b<c.docs.length;b+=500){let d=a.batch();c.docs.slice(b,b+500).forEach(a=>{d.delete(a.ref)}),await d.commit()}}catch(a){if(5===a.code){console.log(`Collection ${b} not found, skipping deletion.`);continue}throw a}return await (0,i.iL)({userId:b.uid,userName:b.name,action:"DELETE",targetType:"VOUCHER",description:`حذف جميع السندات من النظام.`}),(0,g.revalidatePath)("/accounts/vouchers/list"),{success:!0}}catch(a){return console.error("Error deleting all vouchers:",String(a)),{success:!1,error:"فشل حذف جميع السندات."}}}(0,k.D)([q,r,m,n,o]),(0,e.A)(q,"7fc073ecd1a2a3a687a33b240d39c28a9944119247",null),(0,e.A)(r,"7f4fa596b78e1050be57bd23eeef63bf754e59a5c8",null),(0,e.A)(m,"40b3f399476b2e0c0084bb235048022f7151d8d61a",null),(0,e.A)(n,"6052254d233f0ea6b36992b2b81ce07178dee95ad7",null),(0,e.A)(o,"006a7d18b222ac9fd27f636e3f60be09c88c550762",null),d()}catch(a){d(a)}})},19581:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=[{name:"العراق",provinces:[{name:"بغداد"},{name:"البصرة"},{name:"نينوى"},{name:"أربيل"},{name:"النجف"},{name:"ذي قار"},{name:"كركوك"},{name:"الأنبار"},{name:"ديالى"},{name:"المثنى"},{name:"القادسية"},{name:"ميسان"},{name:"واسط"},{name:"صلاح الدين"},{name:"دهوك"},{name:"السليمانية"},{name:"بابل"},{name:"كربلاء"}]},{name:"المملكة العربية السعودية",provinces:[{name:"الرياض"},{name:"مكة المكرمة"},{name:"المدينة المنورة"},{name:"القصيم"},{name:"الشرقية"},{name:"عسير"},{name:"تبوك"},{name:"حائل"},{name:"الحدود الشمالية"},{name:"جازان"},{name:"نجران"},{name:"الباحة"},{name:"الجوف"}]},{name:"مصر",provinces:[{name:"القاهرة"},{name:"الجيزة"},{name:"الأسكندرية"},{name:"الدقهلية"},{name:"الشرقية"},{name:"القليوبية"},{name:"البحيرة"},{name:"الغربية"},{name:"المنوفية"},{name:"كفر الشيخ"},{name:"الفيوم"},{name:"بني سويف"},{name:"المنيا"},{name:"أسيوط"},{name:"سوهاج"},{name:"قنا"},{name:"الأقصر"},{name:"أسوان"},{name:"البحر الأحمر"},{name:"الوادي الجديد"},{name:"مطروح"},{name:"شمال سيناء"},{name:"جنوب سيناء"},{name:"بورسعيد"},{name:"دمياط"},{name:"الإسماعيلية"},{name:"السويس"}]},{name:"الإمارات العربية المتحدة",provinces:[{name:"أبوظبي"},{name:"دبي"},{name:"الشارقة"},{name:"عجمان"},{name:"أم القيوين"},{name:"رأس الخيمة"},{name:"الفجيرة"}]},{name:"الأردن",provinces:[{name:"عمان"},{name:"إربد"},{name:"الزرقاء"},{name:"البلقاء"},{name:"المفرق"},{name:"الكرك"},{name:"جرش"},{name:"مادبا"},{name:"عجلون"},{name:"العقبة"},{name:"معان"},{name:"الطفيلة"}]},{name:"سوريا",provinces:[{name:"دمشق"},{name:"ريف دمشق"},{name:"حلب"},{name:"حمص"},{name:"حماة"},{name:"اللاذقية"},{name:"طرطوس"},{name:"دير الزور"},{name:"الحسكة"},{name:"الرقة"},{name:"إدلب"},{name:"درعا"},{name:"السويداء"},{name:"القنيطرة"}]},{name:"لبنان",provinces:[{name:"بيروت"},{name:"جبل لبنان"},{name:"الشمال"},{name:"الجنوب"},{name:"البقاع"},{name:"النبطية"},{name:"بعلبك الهرمل"},{name:"عكار"}]},{name:"الكويت",provinces:[{name:"العاصمة"},{name:"حولي"},{name:"الأحمدي"},{name:"الجهراء"},{name:"الفروانية"},{name:"مبارك الكبير"}]},{name:"قطر",provinces:[{name:"الدوحة"},{name:"الريان"},{name:"الوكرة"},{name:"الخور"},{name:"الشمال"},{name:"أم صلال"},{name:"الضعاين"}]},{name:"البحرين",provinces:[{name:"العاصمة"},{name:"المحرق"},{name:"الشمالية"},{name:"الجنوبية"}]},{name:"عمان",provinces:[{name:"مسقط"},{name:"ظفار"},{name:"مسندم"},{name:"البريمي"},{name:"الداخلية"},{name:"شمال الباطنة"},{name:"جنوب الباطنة"},{name:"شمال الشرقية"},{name:"جنوب الشرقية"},{name:"الظاهرة"},{name:"الوسطى"}]},{name:"اليمن",provinces:[{name:"صنعاء"},{name:"عدن"},{name:"تعز"},{name:"الحديدة"},{name:"إب"},{name:"ذمار"},{name:"حضرموت"},{name:"شبوة"},{name:"أبين"},{name:"الضالع"},{name:"لحج"},{name:"المهرة"},{name:"عمران"},{name:"الجوف"},{name:"مأرب"},{name:"صعدة"},{name:"حجة"},{name:"المحويت"},{name:"البيضاء"},{name:"ريمة"},{name:"سقطرى"}]}]},19769:(a,b,c)=>{"use strict";c.d(b,{xd:()=>e});var d=c(82357);let e={currencySettings:{defaultCurrency:"USD",exchangeRates:{USD_IQD:1480},currencies:[{code:"USD",name:"US Dollar",symbol:"$"},{code:"IQD",name:"Iraqi Dinar",symbol:"ع.د"}]},exchangeRateTemplate:"*تحديث سعر الصرف*\\n\\n 1 دولار أمريكي = *{rate}* دينار عراقي\\n\\nتاريخ التحديث: {date}",remittanceSettings:{offices:["الريان","الطيف","ماستر","عطاء الغري"],methods:["زين كاش","ماستر كارد","حوالة مصرفية","نقدي"],distributionColumnsUsd:[{id:"externalAmount",label:"خارجي"}],distributionColumnsIqd:[{id:"flyAmount",label:"فلاي"},{id:"internalAmount",label:"داخلي"}],headerColorUsd:"#1e40af",headerColorIqd:"#166534"},voucherSettings:{receiptInvoiceCounter:1e3,paymentInvoiceCounter:1e3,receiptTableColumns:[],paymentTableColumns:[],expenseAccounts:[{id:"expense_salaries",name:"رواتب"},{id:"expense_rent",name:"إيجار"}]},invoiceSequenceSettings:{ticketBookingCounter:0,visaBookingCounter:0,groupBookingCounter:0},creditPolicySettings:{defaultCreditLimit:1e4,defaultGracePeriodDays:30},databaseStatus:{isDatabaseConnected:!0},theme:{landingPage:{heroTitle:"لشركات السياحة والسفر",heroSubtitle:"حلول متكاملة لإدارة الحسابات المالية، تذاكر الطيران، الفيزا، والفواتير بكل ذكاء وسهولة.",heroSubtitleColor:"#52525b",heroTitleColor:"#1e293b",heroFontFamily:"",smartTickets:{title:"إدخال ذكي للتذاكر والفواتير",description:"وداعًا للإدخال اليدوي. نظامنا يقرأ ملفات PDF ويستخرج البيانات تلقائيًا، مما يوفر وقتك ويزيد من دقة بياناتك.",imageUrl:"https://images.unsplash.com/photo-1517999348311-5bc38e05b1c6?q=80&w=2070&auto=format&fit=crop"},sourceAuditing:{title:"مطابقة الكشوفات بذكاء",description:"أداة مبتكرة لمقارنة كشف حسابك مع كشف حساب الموردين، وتحديد الفروقات والاختلافات تلقائيًا بدقة تصل إلى 99%.",imageUrl:"https://images.unsplash.com/photo-1554224155-1696413565d3?q=80&w=2070&auto=format&fit=crop"},financialManagement:{title:"إدارة مالية شاملة",description:"من سندات القبض والصرف إلى شجرة الحسابات والتقارير المتقدمة، كل ما تحتاجه لإدارة مالية شركتك في مكان واحد.",imageUrl:"https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=2070&auto=format&fit=crop"},servicesSection:{title:"خدماتنا المحاسبية",description:"نظام متكامل يغطي جميع احتياجات شركات السياحة والسفر، مصمم خصيصًا ليتوافق مع طبيعة عملكم."},partnersSection:{title:"شركاء النجاح",description:"نفخر بالتعاون مع نخبة من شركات السياحة والسفر الرائدة التي وثقت في نظامنا لتحقيق أهدافها.",partners:[{name:"FlyBaghdad",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/FQ.svg"},{name:"UR Airlines",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/UD.svg"},{name:"Iraqi Airways",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/IA.svg"},{name:"Anadolujet",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/TK.svg"},{name:"Turkish Airlines",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/TK.svg"}]},faqSection:{title:"الأسئلة الشائعة",description:"هل لديك سؤال؟ قد تجد إجابتك هنا.",faqs:[{question:"ما هو نظام Mudarib؟",answer:"هو نظام محاسبي متكامل مصمم خصيصًا لشركات السياحة والسفر."},{question:"هل يدعم النظام اللغة العربية؟",answer:"نعم، النظام يدعم اللغة العربية بشكل كامل مع واجهات RTL."},{question:"هل يمكن تخصيص مظهر النظام؟",answer:"بالتأكيد، يمكنك تخصيص الألوان والخطوط والشعارات من صفحة الإعدادات."}]},accountStatements:{title:"إدارة ومتابعة الديون بسهولة",description:"نظام متكامل لمتابعة ديون العملاء والموردين، مع كشوفات حسابات تفصيلية وتنبيهات آلية للمدفوعات المستحقة.",imageUrl:"https://images.unsplash.com/photo-1556742502-ec7c0e9f34b1?q=80&w=1974&auto=format&fit=crop"},financialAnalysis:{title:"تحليلات مالية دقيقة لاتخاذ القرارات",description:"احصل على رؤية عميقة لأداء شركتك المالي. تتبع الأرباح، حلل التكاليف، وادرس هيكل حساباتك بسهولة عبر شجرة الحسابات التفاعلية.",imageUrl:"https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=2070&auto=format&fit=crop"},footerImageUrl:"https://images.unsplash.com/photo-1549492423-400259a5e5a4?q=80&w=2148&auto=format&fit=crop"},invoice:{companyName:"Mudarib",companyAddress:"Iraq - Holy Karbala - Silo St.",companyPhone:"+964 781 000 3377",companyWeb:"codescope.dev",headerColor:"#e0f2f1",titleColor:"#663399",footerText:"شكرًا لتعاملكم معنا!"}},importFieldsSettings:{name:{label:"الاسم الكامل",aliases:["name","الاسم","اسم العميل","اسم الشركة","company name","supplier name","اسم المورد"]},phone:{label:"رقم الهاتف",aliases:["phone","الهاتف","رقم الهاتف","mobile","رقم الجوال"]},email:{label:"البريد الإلكتروني",aliases:["email","البريد الالكتروني","بريد الكتروني"]},type:{label:"نوع الجهة",aliases:["type","النوع","entity type"]},relationType:{label:"نوع العلاقة",aliases:["relationtype","relation type","نوع العلاقة"]},status:{label:"الحالة",aliases:["status","الحالة"]},code:{label:"معرف الشركة (يوزر فلاي)",aliases:["code","companyid","company id","معرف الشركة","يوزر فلاي"]},paymentType:{label:"نوع التعامل",aliases:["paymenttype","payment type","نوع التعامل","التعامل","نوع الدفع"]},details:{label:"التفاصيل",aliases:["details","notes","ملاحظات","تفاصيل"]},country:{label:"الدولة",aliases:["country","البلد","دولة"]},province:{label:"المحافظة",aliases:["province","state","المحافظة","الولاية"]},streetAddress:{label:"تفاصيل العنوان",aliases:["address","العنوان","streetaddress","street address"]}},importLogicSettings:{creditKeywords:["credit","آجل","debit","دبت"],cashKeywords:["cash","كاش","نقد","نقدي"]},relationSections:[{id:"sec_basic",title:"المعلومات الأساسية",deletable:!1,description:"الحقول الأساسية لتعريف العميل أو المورد.",fields:[{id:"name",label:"الاسم الكامل",type:"text",required:!0,visible:!0,deletable:!1,placeholder:"اسم العميل أو المورد",appliesTo:["individual","company"],aliases:["name","الاسم","اسم العميل","اسم الشركة","company name","supplier name","اسم المورد"]},{id:"type",label:"نوع الجهة",type:"select",required:!0,visible:!0,deletable:!1,options:[{value:"individual",label:"فرد"},{value:"company",label:"شركة"}],appliesTo:["individual","company"],aliases:["type","النوع","entity type"]},{id:"relationType",label:"نوع العلاقة",type:"select",required:!0,visible:!0,deletable:!1,options:[{value:"client",label:"عميل"},{value:"supplier",label:"مورد"},{value:"both",label:"كلاهما"}],appliesTo:["individual","company"],aliases:["relationtype","relation type","نوع العلاقة","العميل او المورد","client or supplier"]},{id:"status",label:"الحالة",type:"select",required:!0,visible:!0,deletable:!1,options:[{value:"active",label:"نشط"},{value:"inactive",label:"غير نشط"}],appliesTo:["individual","company"],aliases:["status","الحالة"]}]},{id:"sec_contact",title:"معلومات الاتصال والعنوان",deletable:!1,description:"بيانات الاتصال والتواصل والتفاصيل الجغرافية.",fields:[{id:"phone",label:"رقم الهاتف",type:"text",required:!1,visible:!0,deletable:!1,placeholder:"07700000000",appliesTo:["individual","company"],aliases:["phone","الهاتف","رقم الهاتف","mobile","رقم الجوال"]},{id:"email",label:"البريد الإلكتروني",type:"email",required:!1,visible:!0,deletable:!0,placeholder:"example@mail.com",appliesTo:["individual","company"],aliases:["email","البريد الالكتروني","بريد الكتروني"]},{id:"country",label:"الدولة",type:"select",required:!1,visible:!0,deletable:!1,appliesTo:["individual","company"],aliases:["country","البلد","دولة"]},{id:"province",label:"المحافظة/الولاية",type:"select",required:!1,visible:!0,deletable:!1,appliesTo:["individual","company"],aliases:["province","state","المحافظة","الولاية"]},{id:"streetAddress",label:"تفاصيل العنوان",type:"text",required:!1,visible:!0,deletable:!1,placeholder:"المنطقة، الشارع، رقم المبنى...",appliesTo:["individual","company"],aliases:["address","العنوان","streetaddress","street address"]}]},{id:"sec_company",title:"تفاصيل الشركة وتسجيل الدخول",deletable:!1,description:"الحقول الخاصة بالشركات وإدارة الوصول للنظام.",fields:[{id:"code",label:"معرف الشركة (يوزر فلاي)",type:"text",required:!1,visible:!0,deletable:!0,appliesTo:["company"],aliases:["code","companyid","company id","معرف الشركة","يوزر فلاي"]},{id:"paymentType",label:"نوع التعامل",type:"select",required:!0,visible:!0,deletable:!0,options:[{value:"cash",label:"نقدي"},{value:"credit",label:"آجل"}],appliesTo:["company","individual"],aliases:["paymenttype","payment type","نوع التعامل","التعامل","نوع الدفع"]}]},{id:"sec_login",title:"إدارة تسجيل الدخول",deletable:!1,description:"إدارة الوصول للنظام لهذه العلاقة.",fields:[{id:"loginIdentifier",label:"معرف تسجيل الدخول",type:"text",required:!1,visible:!0,deletable:!1,placeholder:"اختر معرفًا فريدًا لتسجيل الدخول",appliesTo:["individual","company"],aliases:["login id","login identifier","username","معرف الدخول","اسم المستخدم"]},{id:"password",label:"كلمة المرور",type:"password",required:!1,visible:!0,deletable:!1,placeholder:"اتركه فارغًا لعدم التغيير",appliesTo:["individual","company"],aliases:["password","كلمة المرور"]}]},{id:"sec_other",title:"تفاصيل أخرى",deletable:!0,description:"حقول إضافية وتفاصيل.",fields:[{id:"details",label:"التفاصيل",type:"textarea",required:!1,visible:!0,deletable:!0,appliesTo:["individual","company"],aliases:["details","notes","ملاحظات","تفاصيل"]}]}],financeAccounts:(0,d.rN)({preventDirectCashRevenue:!1}),customRevenueAccounts:{ticketsRevenueAccountId:"",visaRevenueAccountId:"",subscriptionsRevenueAccountId:"",segmentsRevenueAccountId:""},preventDirectProfitToCash:!0}},21096:(a,b,c)=>{"use strict";c.d(b,{Um:()=>f});let d=(a,b)=>{if(!a||!b)return!1;let c=a.trim(),d=b.trim();return!!c&&!!d&&(c===d||c.startsWith(`${d}-`)||c.startsWith(`${d}.`)||c.startsWith(`${d}/`)||c.startsWith(d))},e=(a,b)=>{for(let c of b)if(d(a,c))return!0;return!1};function f(a,b){if(!a||!b)return"other";let{defaultCashId:c,defaultBankId:f,receivableAccountId:g,arAccountId:h,payableAccountId:i,apAccountId:j,hybridRelationAccountId:k,clearingAccountId:l,revenueMap:m,expenseMap:n,generalRevenueId:o,generalExpenseId:p}=b;return d(a,c)?"cash":d(a,f)?"bank":d(a,k)?"hybrid":d(a,g)||d(a,h)?"client":d(a,i)||d(a,j)?"supplier":d(a,l)?"clearing":e(a,[o,...Object.values(m||{})])?"revenue":e(a,[p,...Object.values(n||{})])?"expense":"other"}},21158:(a,b,c)=>{Promise.resolve().then(c.bind(c,28973))},21853:(a,b,c)=>{"use strict";c.d(b,{j:()=>A});var d=c(21124),e=c(38301),f=c(14270),g=c(49113),h=c(8015),i=c(83557),j=c(66782),k=c(44943),l=c(35284),m=c(21347),n=c(9683);c(40068);let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(m.uB,{ref:c,className:(0,k.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...b}));o.displayName=m.uB.displayName;let p=e.forwardRef(({className:a,...b},c)=>(0,d.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,d.jsx)(n.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,d.jsx)(m.uB.Input,{ref:c,className:(0,k.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...b})]}));p.displayName=m.uB.Input.displayName;let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(m.uB.List,{ref:c,className:(0,k.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...b}));q.displayName=m.uB.List.displayName;let r=e.forwardRef((a,b)=>(0,d.jsx)(m.uB.Empty,{ref:b,className:"py-6 text-center text-sm",...a}));r.displayName=m.uB.Empty.displayName;let s=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(m.uB.Group,{ref:c,className:(0,k.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...b}));s.displayName=m.uB.Group.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(m.uB.Separator,{ref:c,className:(0,k.cn)("-mx-1 my-1 h-px bg-border",a),...b})).displayName=m.uB.Separator.displayName;let t=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(m.uB.Item,{ref:c,className:(0,k.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-primary aria-selected:text-primary-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",a),...b}));t.displayName=m.uB.Item.displayName;var u=c(77837),v=c(27184),w=c(85708);w.callServer,w.findSourceMapURL;var x=c(97802),y=c(99187);let z=({children:a})=>(0,d.jsx)("div",{className:"py-1 px-2 text-xs text-center text-muted-foreground bg-muted/50 border-t",children:a});function A({searchAction:a,options:b,value:c,onValueChange:m,placeholder:n,disabled:w=!1,includeInactive:A=!1}){let[B,C]=e.useState(!1),[D,E]=e.useState(""),[F,G]=e.useState(!1);(0,v.d)(D,400);let[H,I]=e.useState(0),{data:J,loaded:K}=(0,x.Z)(),L=e.useMemo(()=>{if(b)return b;if(!K)return[];let c=a=>`${a.name}${a.code?` (${a.code})`:""}`,d=[];if(K)switch(a){case"clients":d=(J.clients||[]).filter(a=>"client"===a.relationType||"both"===a.relationType).map(a=>({value:a.id,label:c(a),relationType:a.relationType,paymentType:a.paymentType}));break;case"suppliers":d=(J.suppliers||[]).filter(a=>"supplier"===a.relationType||"both"===a.relationType).map(a=>({value:a.id,label:c(a),relationType:a.relationType,paymentType:a.paymentType}));break;case"users":d=(J.users||[]).map(a=>({value:a.uid,label:a.name,email:a.email}));break;case"boxes":d=(J.boxes||[]).map(a=>({value:a.id,label:a.name}));break;default:d=[...(J.clients||[]).map(a=>({value:a.id,label:c(a),relationType:a.relationType,paymentType:a.paymentType})),...(J.suppliers||[]).map(a=>({value:a.id,label:c(a),relationType:a.relationType,paymentType:a.paymentType})),...(J.boxes||[]).map(a=>({value:a.id,label:`صندوق: ${a.name}`}))]}return d.sort((a,b)=>(b.useCount||0)-(a.useCount||0))},[b,J,K,a]),M=e.useMemo(()=>L.find(a=>a?.value===c),[L,c]),N=a=>{let b=O.find(b=>b.value.toLowerCase()===a.toLowerCase());m(b?b.value:""),E(""),C(!1)},O=e.useMemo(()=>{if(!D)return I(0),L;let a=D.toLowerCase(),b=L.filter(b=>b.label.toLowerCase().includes(a)||b.arabicName&&b.arabicName.toLowerCase().includes(a)||b.city&&b.city.toLowerCase().includes(a)||b.email&&b.email.toLowerCase().includes(a));return I(0),b},[L,D]),P=e.useMemo(()=>{let a=10*H;return O.slice(a,a+10)},[O,H,10]),Q=Math.ceil(O.length/10),R=b?.some(a=>a.country&&a.city);return(0,d.jsxs)(u.AM,{open:B,onOpenChange:C,children:[(0,d.jsx)(u.Wv,{asChild:!0,children:(0,d.jsxs)(l.$,{variant:"outline",role:"combobox","aria-expanded":B,className:"w-full justify-between h-8",disabled:w,children:[(0,d.jsx)("span",{className:(0,k.cn)("truncate",!M&&"text-muted-foreground"),children:M?R?M.value:M.label:n||"Select..."}),(0,d.jsx)(f.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,d.jsx)(u.hl,{className:"min-w-[var(--radix-popover-trigger-width)] w-auto p-0",children:(0,d.jsxs)(o,{shouldFilter:!1,children:[(0,d.jsx)(p,{placeholder:n||"بحث...",value:D,onValueChange:E}),(0,d.jsxs)(q,{children:[F&&(0,d.jsx)("div",{className:"p-2 flex justify-center",children:(0,d.jsx)(g.A,{className:"h-5 w-5 animate-spin"})}),!F&&0===P.length&&(0,d.jsx)(r,{children:"لا توجد نتائج."}),(0,d.jsx)(s,{children:P.map((a,b)=>(0,d.jsx)(t,{value:a.value,onSelect:N,className:(0,k.cn)("flex justify-between items-center",R?"p-2":""),children:R?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex-grow text-right",children:[(0,d.jsx)("p",{className:"font-bold text-sm",children:a.arabicName||a.city}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:a.arabicCountry||a.country})]}),(0,d.jsx)(y.E,{variant:"secondary",className:"font-mono text-sm px-2 py-1 ml-3",children:a.value})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(h.A,{className:(0,k.cn)("mr-2 h-4 w-4",c===a.value?"opacity-100":"opacity-0")}),(0,d.jsx)("span",{children:a.label})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[a.paymentType&&(0,d.jsx)(y.E,{variant:"outline",children:(a=>{switch(a){case"cash":return"نقدي";case"credit":return"آجل";default:return""}})(a.paymentType)}),a.relationType&&(0,d.jsx)(y.E,{variant:"secondary",children:(a=>{switch(a){case"client":return"عميل";case"supplier":return"مورد";case"both":return"عميل ومورد";default:return""}})(a.relationType)})]})]})},`${a.value}-${b}`))})]}),O.length>10&&(0,d.jsx)(z,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,d.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>I(a=>Math.max(0,a-1)),disabled:0===H,children:(0,d.jsx)(i.A,{className:"h-4 w-4"})}),(0,d.jsxs)("span",{children:["صفحة ",H+1," من ",Q]}),(0,d.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>I(a=>Math.min(Q-1,a+1)),disabled:H>=Q-1,children:(0,d.jsx)(j.A,{className:"h-4 w-4"})})]})})]})})]})}},22042:(a,b,c)=>{"use strict";c.d(b,{Mh:()=>d,_m:()=>e});let d=[{id:"dashboard",name:"لوحة التحكم",permissions:[{id:"dashboard:read",name:"عرض"}]},{id:"bookings",name:"حجوزات الطيران",permissions:[{id:"bookings:read",name:"عرض"},{id:"bookings:create",name:"إنشاء"},{id:"bookings:update",name:"تعديل"},{id:"bookings:delete",name:"حذف"},{id:"bookings:operations",name:"عمليات"}]},{id:"visas",name:"طلبات الفيزا",permissions:[{id:"visas:read",name:"عرض"},{id:"visas:create",name:"إنشاء"},{id:"visas:update",name:"تعديل"},{id:"visas:delete",name:"حذف"}]},{id:"subscriptions",name:"الاشتراكات",permissions:[{id:"subscriptions:read",name:"عرض"},{id:"subscriptions:create",name:"إنشاء"},{id:"subscriptions:update",name:"تعديل"},{id:"subscriptions:delete",name:"حذف"},{id:"subscriptions:payments",name:"دفع الأقساط"}]},{id:"vouchers",name:"السندات والقيود",permissions:[{id:"vouchers:read",name:"عرض"},{id:"vouchers:create",name:"إنشاء"},{id:"vouchers:update",name:"تعديل"},{id:"vouchers:delete",name:"حذف"}]},{id:"remittances",name:"الحوالات",permissions:[{id:"remittances:read",name:"عرض"},{id:"remittances:create",name:"إنشاء"},{id:"remittances:audit",name:"تدقيق"},{id:"remittances:receive",name:"استلام"}]},{id:"relations",name:"العلاقات (العملاء والموردين)",permissions:[{id:"relations:read",name:"عرض"},{id:"relations:create",name:"إنشاء"},{id:"relations:update",name:"تعديل"},{id:"relations:delete",name:"حذف"},{id:"relations:credentials",name:"إدارة الدخول"}]},{id:"users",name:"المستخدمون والأدوار",permissions:[{id:"users:read",name:"عرض"},{id:"users:create",name:"إنشاء"},{id:"users:update",name:"تعديل"},{id:"users:delete",name:"حذف"},{id:"users:permissions",name:"إدارة الصلاحيات"}]},{id:"reports",name:"التقارير",permissions:[{id:"reports:read:all",name:"عرض الكل"},{id:"reports:account_statement",name:"كشف حساب"},{id:"reports:debts",name:"الأرصدة"},{id:"reports:profits",name:"الأرباح"},{id:"reports:flight_analysis",name:"تحليل الرحلات"}]},{id:"settings",name:"الإعدادات العامة",permissions:[{id:"settings:read",name:"عرض"},{id:"settings:update",name:"تعديل"}]},{id:"system",name:"أدوات النظام",permissions:[{id:"system:audit_log:read",name:"سجل النشاطات"},{id:"system:error_log:read",name:"سجل الأخطاء"},{id:"system:data_audit:run",name:"تشغيل فحص البيانات"}]}],e=(a,b)=>!!a&&("public"===b||(!("isClient"in a)||!a.isClient)&&("role"in a&&"admin"===a.role||!!(a.permissions&&Array.isArray(a.permissions))&&(!!(b.startsWith("reports:")&&a.permissions.includes("reports:read:all"))||a.permissions.includes(b))))},22708:(a,b,c)=>{"use strict";c.d(b,{A:()=>g});var d=c(21124),e=c(5111),f=c(23018);function g(){return(0,d.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,d.jsx)(f.P.div,{animate:{y:[0,-10,0],rotate:[0,5,0,-5,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:(0,d.jsx)(e.A,{className:"h-16 w-16 text-primary"})})})}},23727:(a,b,c)=>{"use strict";c.d(b,{BK:()=>i,eu:()=>h,q5:()=>j});var d=c(21124),e=c(38301),f=c(71507),g=c(44943);let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.bL,{ref:c,className:(0,g.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...b}));h.displayName=f.bL.displayName;let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f._V,{ref:c,className:(0,g.cn)("aspect-square h-full w-full object-cover",a),...b}));i.displayName=f._V.displayName;let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.H4,{ref:c,className:(0,g.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...b}));j.displayName=f.H4.displayName},25456:(a,b,c)=>{"use strict";c.d(b,{O:()=>i});var d=c(21124),e=c(38301),f=c(93758),g=c(44943);let h=a=>{if("string"!=typeof a||""===a.trim())return;let b=parseFloat(a.replace(/,/g,""));return isNaN(b)?void 0:b},i=e.forwardRef(({value:a,onValueChange:b,className:c,allowNegative:i=!1,currency:j,currencyClassName:k,direction:l="rtl",...m},n)=>{let o=a=>{if(null==a||""===a)return"";let b="string"==typeof a?h(a):a;return void 0===b?String(a):new Intl.NumberFormat("en-US").format(b)},[p,q]=e.useState(o(a));e.useEffect(()=>{q(o(a))},[a]);let r={...m,ref:n,type:"text",inputMode:"decimal",placeholder:"0.00",value:p||"",onChange:a=>{let c=a.target.value.replace(/,/g,"");if((i?/^-?\d*\.?\d*$/:/^\d*\.?\d*$/).test(c)||""===c){let a=h(c);q(void 0!==a?o(a):c),b&&b(a)}}};return j?(0,d.jsxs)("div",{className:(0,g.cn)("relative flex items-center w-full",c),children:[(0,d.jsx)(f.p,{...r,className:(0,g.cn)("z-10 text-right w-full","rtl"===l?"rounded-l-none rounded-r-lg border-l-0":"rounded-r-none rounded-l-lg border-r-0")}),(0,d.jsx)("div",{className:(0,g.cn)("p-2 bg-muted border h-full flex items-center",k,"rtl"===l?"rounded-l-lg":"rounded-r-lg"),children:(0,d.jsx)("span",{className:"text-xs font-semibold",children:j})})]}):(0,d.jsx)(f.p,{...r,className:(0,g.cn)("text-right",c)})});i.displayName="NumericInput"},25969:(a,b,c)=>{"use strict";c.d(b,{U:()=>i});var d=c(21124);c(38301);var e=c(88077),f=c(78226),g=c(45523),h=c(35284);function i(){let{theme:a,setTheme:b}=(0,g.D)();return(0,d.jsxs)(h.$,{variant:"secondary",size:"icon",onClick:()=>b("light"===a?"dark":"light"),className:"rounded-full shadow-md",children:[(0,d.jsx)(e.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,d.jsx)(f.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,d.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}},27081:(a,b,c)=>{"use strict";c.d(b,{E:()=>f});var d=c(21124),e=c(44943);function f({className:a,...b}){return(0,d.jsx)("div",{className:(0,e.cn)("animate-pulse rounded-md bg-muted",a),...b})}},27184:(a,b,c)=>{"use strict";c.d(b,{d:()=>e});var d=c(38301);function e(a,b){let[c,e]=(0,d.useState)(a);return c}},27186:(a,b,c)=>{"use strict";c.d(b,{C5:()=>s,MJ:()=>q,Rr:()=>r,eI:()=>o,lR:()=>p,lV:()=>j,zB:()=>l});var d=c(21124),e=c(38301),f=c(96425),g=c(31980),h=c(44943),i=c(68120);let j=g.Op,k=e.createContext({}),l=({...a})=>(0,d.jsx)(k.Provider,{value:{name:a.name},children:(0,d.jsx)(g.xI,{...a})}),m=()=>{let a=e.useContext(k),b=e.useContext(n),{getFieldState:c,formState:d}=(0,g.xW)(),f=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:h}=b;return{id:h,name:a.name,formItemId:`${h}-form-item`,formDescriptionId:`${h}-form-item-description`,formMessageId:`${h}-form-item-message`,...f}},n=e.createContext({}),o=e.forwardRef(({className:a,...b},c)=>{let f=e.useId();return(0,d.jsx)(n.Provider,{value:{id:f},children:(0,d.jsx)("div",{ref:c,className:(0,h.cn)("space-y-2",a),...b})})});o.displayName="FormItem";let p=e.forwardRef(({className:a,...b},c)=>{let{error:e,formItemId:f}=m();return(0,d.jsx)(i.J,{ref:c,className:(0,h.cn)(e&&"text-destructive",a),htmlFor:f,...b})});p.displayName="FormLabel";let q=e.forwardRef(({...a},b)=>{let{error:c,formItemId:e,formDescriptionId:g,formMessageId:h}=m();return(0,d.jsx)(f.DX,{ref:b,id:e,"aria-describedby":c?`${g} ${h}`:`${g}`,"aria-invalid":!!c,...a})});q.displayName="FormControl";let r=e.forwardRef(({className:a,...b},c)=>{let{formDescriptionId:e}=m();return(0,d.jsx)("p",{ref:c,id:e,className:(0,h.cn)("text-sm text-muted-foreground",a),...b})});r.displayName="FormDescription";let s=e.forwardRef(({className:a,children:b,...c},e)=>{let{error:f,formMessageId:g}=m(),i=f?String(f?.message??""):b;return i?(0,d.jsx)("p",{ref:e,id:g,className:(0,h.cn)("text-sm font-medium text-destructive",a),...c,children:i}):null});s.displayName="FormMessage"},27410:(a,b,c)=>{"use strict";c.d(b,{V:()=>l});var d=c(21124);c(38301);var e=c(93400),f=c(77503),g=c(87549),h=c(38533),i=c(44943),j=c(35284),k=c(63822);function l({className:a,classNames:b,showOutsideDays:c=!0,...l}){return(0,d.jsx)(g.hv,{showOutsideDays:c,className:(0,i.cn)("p-3",a),locale:h.ar,formatters:{formatCaption:(a,b)=>{let{year:c,month:d}=(0,g.cq)(),e=a.getFullYear(),f=a.getMonth(),h=c?.getFullYear()??e,i=(0,k.GP)(new Date(h,f),"MMMM",{locale:b?.locale});return`${i} ${h}`}},classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,i.cn)((0,j.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent/50 first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,i.cn)((0,j.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...b},components:{IconLeft:({...a})=>(0,d.jsx)(e.A,{className:"h-4 w-4"}),IconRight:({...a})=>(0,d.jsx)(f.A,{className:"h-4 w-4"})},...l})}l.displayName="Calendar"},27467:(a,b,c)=>{"use strict";c.d(b,{Bc:()=>h,ZI:()=>k,k$:()=>j,m_:()=>i});var d=c(21124),e=c(38301),f=c(16992),g=c(44943);let h=f.Kq,i=f.bL,j=f.l9,k=e.forwardRef(({className:a,sideOffset:b=4,...c},e)=>(0,d.jsx)(f.UC,{ref:e,sideOffset:b,className:(0,g.cn)("z-50 whitespace-nowrap rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c}));k.displayName=f.UC.displayName},28541:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{u:()=>n});var e=c(91488);c(27806);var f=c(80446),g=c(62641),h=c(91837),i=c(41925),j=c(58749),k=c(15105),l=c(40410),m=a([f,g,i,j,k]);async function n(a){let b=await (0,g.$T)();if(!b)return{success:!1,error:"User not authenticated."};if(!await (0,f.Lf)())return{success:!1,error:"Database not available."};try{let c=await (0,k.a)({sourceType:"standard_receipt",sourceId:`receipt-${Date.now()}`,description:`سند قبض: ${a.details||"دفعة"}`.trim(),amount:a.amount,currency:a.currency,date:new Date(a.date),userId:b.uid,debitAccountId:a.toBox,creditAccountId:a.from});return await (0,j.iL)({userId:b.uid,userName:b.name,action:"CREATE",targetType:"VOUCHER",description:`أنشأ سند قبض عادي بمبلغ ${a.amount} ${a.currency}.`,targetId:c}),await (0,i.UI)({userId:a.from,title:`تم استلام دفعة منك`,body:`تم استلام دفعة جديدة بمبلغ ${a.amount} ${a.currency}.`,type:"payment",link:`/clients/${a.from}`}),(0,h.revalidatePath)("/accounts/vouchers/list"),(0,h.revalidatePath)("/reports/account-statement"),{success:!0,voucherId:c}}catch(a){return console.error("Error creating standard receipt: ",String(a)),{success:!1,error:a.message}}}[f,g,i,j,k]=m.then?(await m)():m,(0,l.D)([n]),(0,e.A)(n,"405181b3416ca6fb6435ab9096a0a68342e5255501",null),d()}catch(a){d(a)}})},28973:(a,b,c)=>{"use strict";c.d(b,{Providers:()=>bS});var d=c(21124),e=c(38301),f=c.n(e),g=c(45523);function h({children:a,...b}){return(0,d.jsx)(g.N,{...b,children:a})}var i=c(37448),j=c(76608),k=c(26691),l=c(90447),m=c(44943);let n=j.Kq,o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.LM,{ref:c,className:(0,m.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:left-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...b}));o.displayName=j.LM.displayName;let p=(0,k.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),q=e.forwardRef(({className:a,variant:b,...c},e)=>(0,d.jsx)(j.bL,{ref:e,className:(0,m.cn)(p({variant:b}),a),dir:"rtl",...c}));q.displayName=j.bL.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.rc,{ref:c,className:(0,m.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...b})).displayName=j.rc.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.bm,{ref:c,className:(0,m.cn)("absolute left-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...b,children:(0,d.jsx)(l.A,{className:"h-4 w-4"})}));r.displayName=j.bm.displayName;let s=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.hE,{ref:c,className:(0,m.cn)("text-sm font-semibold",a),...b}));s.displayName=j.hE.displayName;let t=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.VY,{ref:c,className:(0,m.cn)("text-sm opacity-90",a),...b}));function u(){let{toasts:a}=(0,i.dj)();return(0,d.jsxs)(n,{children:[a.map(function({id:a,title:b,description:c,action:e,...f}){return(0,d.jsxs)(q,{...f,children:[(0,d.jsxs)("div",{className:"grid gap-1 text-right w-full",children:[b&&(0,d.jsx)(s,{children:b}),c&&(0,d.jsx)(t,{children:c})]}),e,(0,d.jsx)(r,{})]},a)}),(0,d.jsx)(o,{})]})}t.displayName=j.VY.displayName;var v=c(46283),w=c(97802),x=c(63009),y=c(22708),z=c(42378),A=c(3991),B=c.n(A),C=c(33320),D=c(34118),E=c(20947),F=c(59014),G=c(97662),H=c(77249),I=c(19335),J=c(62257),K=c(49589),L=c(81825),M=c(51115),N=c(52784),O=c(8929),P=c(31779),Q=c(49095),R=c(63198),S=c(84438),T=c(79876),U=c(59819),V=c(96764),W=c(59901),X=c(9738),Y=c(43215),Z=c(38692),$=c(1601),_=c(88869),aa=c(59573),ab=c(51886),ac=c(95528),ad=c(84407),ae=c(5239),af=c(27810),ag=c(76454),ah=c(6779),ai=c(90287),aj=c(22711);let ak={mainNav:[{title:"الرئيسية",href:"/dashboard",icon:C.A},{title:"مركز الحسابات",href:"/accounts",icon:D.A}],relations:{title:"العلاقات",icon:E.A,items:[{title:"ادارة العلاقات",href:"/clients",icon:F.A},{title:"الحملات",href:"/campaigns",icon:G.A},{title:"المحادثات",href:"/chat",icon:G.A}]},vouchers:{title:"السندات",icon:H.A,items:[]},operations:{title:"العمليات المحاسبية",icon:I.A,items:[{title:"حجوزات الطيران",href:"/bookings",icon:J.A},{title:"طلبات الفيزا",href:"/visas",icon:K.A},{title:"الحوالات",href:"/accounts/remittances",icon:L.A}]},customBusiness:{title:"الأعمال المخصصة",icon:M.A,items:[{title:"الاشتراكات",href:"/subscriptions",icon:N.A},{title:"السكمنت",href:"/segments",icon:O.A},{title:"البورصات",href:"/exchanges",icon:P.A},{title:"توزيع الحصص",href:"/profit-sharing",icon:Q.A},{title:"تحليل الطيران",href:"/reports/flight-analysis",icon:J.A}]},reports:{title:"التقارير والأدوات",icon:R.A,items:[{title:"تقرير الأرصدة",href:"/reports/debts",icon:S.A},{title:"كشف حساب",href:"/reports/account-statement",icon:T.A},{title:"الأرباح والخسائر",href:"/reports/profit-loss",icon:U.A},{title:"تحليل الربحية",href:"/reports/profitability-analysis",icon:V.A},{title:"التدفق النقدي",href:"/reports/cash-flow",icon:P.A},{title:"التدقيق الذكي",href:"/reconciliation",icon:W.A}]},additionalFeatures:{title:"الميزات الإضافية",icon:M.A,items:[{title:"الصناديق",href:"/boxes",icon:X.A},{title:"الموردين",href:"/suppliers",icon:Y.A},{title:"الملف الشخصي",href:"/profile",icon:Z.A},{title:"الأرباح",href:"/profits",icon:$.A},{title:"الإشعارات",href:"/notifications",icon:_.A},{title:"إدارة الأصول",href:"/settings/assets",icon:D.A}]},system:{title:"النظام",icon:aa.A,items:[{title:"الإعدادات العامة",href:"/settings",icon:ab.A},{title:"الدليل المحاسبي والربط المالي",href:"/settings/accounting",icon:ac.A},{title:"الموظفين والصلاحيات",href:"/users",icon:ad.A},{title:"الأدوات المالية",href:"/finance-tools",icon:ae.A},{title:"قوالب الرسائل",href:"/templates",icon:af.A},{title:"سجل النشاطات",href:"/system/activity-log",icon:ag.A},{title:"سجل الأخطاء",href:"/system/error-log",icon:ah.A},{title:"تدقيق البيانات",href:"/system/data-audit",icon:ai.A},{title:"سجل المحذوفات",href:"/system/deleted-log",icon:aj.A}]}};var al=c(11563),am=c(35284),an=c(89308),ao=c(11759),ap=c(40068),aq=c(43328),ar=c(22741),as=c(49113),at=c(10923);function au({onVoucherAdded:a,children:b}){let[c,f]=(0,e.useState)(!1),{data:g,loaded:h}=(0,w.Z)(),[i,j]=(0,e.useState)({width:"896px",height:"80vh"}),k=g?.settings.currencySettings?.defaultCurrency||"IQD",[l,n]=(0,e.useState)(k);return(0,d.jsxs)(ap.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(ap.zM,{asChild:!0,children:b}),(0,d.jsxs)(ap.Cf,{className:"p-0 flex flex-col",style:{maxWidth:i.width,width:"95vw",height:i.height},children:[(0,d.jsxs)(ap.c7,{className:"p-4 rounded-t-lg flex flex-row justify-between items-center",style:{backgroundColor:"USD"===l?"hsl(var(--accent))":"hsl(var(--primary))",color:"white"},children:[(0,d.jsx)("div",{children:(0,d.jsx)(ap.L3,{className:"text-white",children:"إنشاء سند قبض عادي"})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(g?.settings?.currencySettings?.currencies||[]).map(a=>(0,d.jsx)(am.$,{type:"button",onClick:()=>n(a.code),className:(0,m.cn)("text-white h-8",l===a.code?"bg-white/30":"bg-transparent border border-white/50"),children:a.code},a.code)),(0,d.jsx)(at.A,{dialogKey:"standard_receipt",onDimensionsChange:j,children:(0,d.jsx)(am.$,{type:"button",variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:(0,d.jsx)(ar.A,{className:"h-5 w-5"})})})]})]}),(0,d.jsx)("div",{className:"flex-grow overflow-y-auto",children:h&&g?(0,d.jsx)(aq.A,{onVoucherAdded:b=>{a(b),f(!1)},selectedCurrency:l}):(0,d.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,d.jsx)(as.A,{className:"animate-spin h-8 w-8"})})})]})]})}var av=c(31980),aw=c(50937),ax=c(99546),ay=c(85708);let az=(0,ay.createServerReference)("60eed12072721bc1c2c48214672b423b5d4cc8a6f3",ay.callServer,void 0,ay.findSourceMapURL,"updateDistributedVoucher"),aA=(0,ay.createServerReference)("40c15e87ca74d3ad5ae09fdc0c6d9616384469f25f",ay.callServer,void 0,ay.findSourceMapURL,"createDistributedVoucher");var aB=c(68120),aC=c(68254),aD=c(27186),aE=c(77837),aF=c(27410),aG=c(98341),aH=c(44345),aI=c(11943),aJ=c(54163),aK=c(94429),aL=c(49566),aM=c(63822),aN=c(21853),aO=c(25456);let aP=({currency:a,className:b,...c})=>(0,d.jsx)(aO.O,{currency:a,className:(0,m.cn)("text-right",b),currencyClassName:(0,m.cn)("USD"===a?"bg-accent text-accent-foreground":"bg-primary text-primary-foreground"),...c});function aQ({settings:a,onVoucherAdded:b,selectedCurrency:c,isEditing:f,initialData:g,onVoucherUpdated:h}){let{toast:j}=(0,i.dj)(),{user:k}=(0,x.A)(),[l,n]=e.useState(!1),{data:o,loaded:p}=(0,w.Z)(),q=e.useMemo(()=>((a=[])=>{let b=a.reduce((a,b)=>(a[b.id]=ax.Ik({enabled:ax.zM().default(!0),amount:ax.Yj().or(ax.ai()).transform(a=>Number(String(a).replace(/,/g,""))).refine(a=>a>=0).optional()}),a),{});return ax.Ik({date:ax.p6(),userId:ax.Yj().min(1,"المستخدم مطلوب"),reference:ax.Yj().optional(),accountId:ax.Yj().min(1,"الحساب مطلوب"),boxId:ax.Yj().min(1,"الصندوق مطلوب"),currency:ax.k5(["USD","IQD"]),exchangeRate:ax.au.number().optional(),totalAmount:ax.Yj().or(ax.ai()).transform(a=>Number(String(a).replace(/,/g,""))).refine(a=>a>0,{message:"المبلغ الإجمالي يجب أن يكون أكبر من صفر"}),details:ax.Yj().optional(),companyAmount:ax.Yj().or(ax.ai()).transform(a=>Number(String(a).replace(/,/g,""))).refine(a=>a>=0,{message:"مبلغ الشركة لا يمكن أن يكون سالبًا."}).optional(),distributions:ax.Ik(b)}).refine(a=>{let b=Object.values(a.distributions).reduce((a,b)=>a+(b.enabled&&Number(b.amount)||0),0),c=a.companyAmount||0;return 0===b&&0===c&&a.totalAmount>0||.01>Math.abs(b+c-a.totalAmount)},{message:"مجموع مبالغ التوزيع وحصة الشركة لا يساوي المبلغ المستلم.",path:["companyAmount"]})})(a?.distributionChannels),[a]),r=(0,av.mN)({resolver:(0,aw.u)(q),defaultValues:f&&g?{...g}:{date:new Date,userId:"",accountId:"",currency:c,exchangeRate:0,totalAmount:0,notes:"",companyAmount:0,distributions:(a.distributionChannels||[]).reduce((a,b)=>(a[b.id]={enabled:!0,amount:0},a),{}),boxId:k&&"role"in k?k.boxId:""}}),{isSubmitting:s,watch:t,control:u,setValue:v,getValues:y,register:z,formState:{errors:A}}=r;t("distributions"),t("totalAmount"),t("companyAmount"),e.useEffect(()=>{k&&"role"in k&&!f&&(r.setValue("userId",k.uid),k.boxId&&r.setValue("boxId",k.boxId))},[f,r,k]),e.useEffect(()=>{if(!f){v("currency",c),v("totalAmount",0),v("companyAmount",0);let b={};(a.distributionChannels||[]).forEach(a=>{b[a.id]={enabled:!0,amount:0}}),v("distributions",b)}},[c,v,a.distributionChannels,f]),e.useEffect(()=>{let a=t((a,{name:b,type:c})=>{if(b?.startsWith("distributions.")||"totalAmount"===b){let a=y(),b=Object.values(a.distributions||{}).reduce((a,b)=>a+(b.enabled&&Number(b.amount)||0),0),c=(Number(a.totalAmount)||0)-b;c!==(Number(a.companyAmount)||0)&&v("companyAmount",c>=0?c:0,{shouldValidate:!0})}});return()=>a.unsubscribe()},[t,v,y]);let B=async a=>{try{if(f&&g?.id){let b=await az(g.id,a);b.success?(j({title:"تم تحديث السند بنجاح"}),h&&h({})):j({title:"خطأ في التحديث",description:b.error,variant:"destructive"})}else{let c=await aA(a);c.success?(j({title:"تم إنشاء السند بنجاح"}),b&&b(c),r.reset()):j({title:"خطأ في الحفظ",description:c.error,variant:"destructive"})}}catch(a){j({title:"خطأ",description:a.message,variant:"destructive"})}};return p?(0,d.jsx)(aD.lV,{...r,children:(0,d.jsxs)("form",{onSubmit:r.handleSubmit(B),className:"space-y-4 p-4",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(S.A,{className:"h-5 w-5 text-primary"}),(0,d.jsx)("h3",{className:"text-lg font-semibold",children:"معلومات السند الأساسية"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-5 p-4 border rounded-lg bg-muted/30",children:[(0,d.jsxs)(aD.eI,{className:"flex items-center gap-2",children:[(0,d.jsx)(aB.J,{className:"whitespace-nowrap",children:"التاريخ"}),(0,d.jsx)(av.xI,{control:u,name:"date",render:({field:a})=>(0,d.jsxs)(aE.AM,{open:l,onOpenChange:n,children:[(0,d.jsx)(aE.Wv,{asChild:!0,children:(0,d.jsxs)(am.$,{variant:"outline",className:(0,m.cn)("w-full justify-start text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?(0,aM.GP)(a.value,"yyyy-MM-dd"):(0,d.jsx)("span",{children:"اختر تاريخ"}),(0,d.jsx)(aG.A,{className:"ms-auto h-4 w-4 opacity-50"})]})}),(0,d.jsx)(aE.hl,{className:"w-auto p-0",children:(0,d.jsx)(aF.V,{mode:"single",selected:a.value,onSelect:b=>{b&&a.onChange(b),n(!1)}})})]})}),(0,d.jsx)(aD.C5,{})]}),(0,d.jsxs)(aD.eI,{className:"flex items-center gap-2",children:[(0,d.jsx)(aB.J,{className:"whitespace-nowrap",children:"الحساب الدافع"}),(0,d.jsx)(av.xI,{control:u,name:"accountId",render:({field:a})=>(0,d.jsx)(aD.MJ,{children:(0,d.jsx)(aN.j,{searchAction:"clients",value:a.value,onValueChange:a.onChange,placeholder:"ابحث عن حساب..."})})}),(0,d.jsx)(aD.C5,{})]})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(aH.A,{className:"h-5 w-5 text-primary"}),(0,d.jsx)("h3",{className:"text-lg font-semibold",children:"التفاصيل المالية والتوزيع"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-5 p-4 border rounded-lg bg-muted/30",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(aB.J,{className:"whitespace-nowrap",children:"إجمالي المبلغ"}),(0,d.jsx)(aD.zB,{control:u,name:"totalAmount",render:({field:a})=>(0,d.jsxs)(aD.eI,{children:[(0,d.jsx)(av.xI,{control:u,name:"totalAmount",render:({field:a})=>(0,d.jsx)(aP,{currency:c,...a,onValueChange:a.onChange})}),(0,d.jsx)(aD.C5,{})]})})]}),"USD"===c&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(aB.J,{className:"whitespace-nowrap",children:"سعر الصرف"}),(0,d.jsx)(aD.zB,{control:u,name:"exchangeRate",render:({field:a})=>(0,d.jsxs)(aD.eI,{children:[(0,d.jsx)(av.xI,{control:u,name:"exchangeRate",render:({field:a})=>(0,d.jsx)(aP,{currency:"IQD",...a,onValueChange:a.onChange})}),(0,d.jsx)(aD.C5,{})]})})]}),(0,d.jsxs)("div",{className:"md:col-span-full pt-4 border-t",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-2",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(aB.J,{children:"المبلغ المسدد لحساب الدافع"}),(0,d.jsx)(av.xI,{control:u,name:"companyAmount",render:({field:a})=>(0,d.jsx)(aP,{currency:c,...a,onValueChange:a.onChange,readOnly:!0})}),(0,d.jsx)(aD.C5,{})]}),(a.distributionChannels||[]).map(a=>(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(aB.J,{children:a.label}),(0,d.jsx)(av.xI,{control:u,name:`distributions.${a.id}.amount`,render:({field:a})=>(0,d.jsx)(aP,{currency:c,...a,onValueChange:a.onChange})})]},a.id))]}),A.companyAmount&&(0,d.jsx)("p",{className:"text-sm font-medium text-destructive text-center pt-2",children:A.companyAmount.message})]}),(0,d.jsxs)("div",{className:"md:col-span-full space-y-1.5",children:[(0,d.jsx)(aC.T,{...z("details"),placeholder:"التفاصيل..."}),(0,d.jsx)(aD.C5,{children:A.details?.message})]})]})]}),(0,d.jsxs)(ap.Es,{className:"pt-4 flex-col sm:flex-row gap-2 sticky bottom-0 bg-background py-4 px-6 -mx-6 -mb-6 border-t",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(Z.A,{className:"h-4 w-4"})," ",(0,d.jsxs)("span",{children:["المستخدم: ",k?.name||"..."]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(aI.A,{className:"h-4 w-4"})," ",(0,d.jsx)("span",{children:"الرقم العام: (تلقائي)"})]})]}),(0,d.jsx)("div",{className:"flex-grow"}),(0,d.jsxs)(am.$,{type:"button",variant:"outline",size:"lg",children:[(0,d.jsx)(aJ.A,{className:"me-2 h-4 w-4"})," طباعة"]}),(0,d.jsxs)(am.$,{type:"button",variant:"outline",size:"lg",className:"bg-green-600 text-white hover:bg-green-700 hover:text-white",children:[(0,d.jsx)(aK.A,{className:"me-2 h-4 w-4"})," إرسال واتساب"]}),(0,d.jsxs)(am.$,{type:"submit",size:"lg",disabled:s,className:"bg-orange-500 text-white hover:bg-orange-600",children:[s&&(0,d.jsx)(as.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(aL.A,{className:"me-2 h-4 w-4"}),f?"حفظ التعديلات":"حفظ السند"]})]})]})}):(0,d.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,d.jsx)(as.A,{className:"h-8 w-8 animate-spin"})})}var aR=c(83557),aS=c(99599),aT=c(62186),aU=c(22874),aV=c(40822),aW=c(10656),aX=c(93758),aY=c(65409),aZ=c(12439);let a$=ax.Ik({id:ax.Yj(),label:ax.Yj().min(1,"اسم الحقل مطلوب."),accountId:ax.Yj().min(1,"يجب اختيار حساب.")}),a_=ax.Ik({distributionChannels:ax.YO(a$).optional(),dialogWidth:ax.Yj().optional(),dialogHeight:ax.Yj().optional()});function a0({initialSettings:a,onSaveSuccess:b,onDimensionsChange:c}){let{toast:f}=(0,i.dj)(),{data:g}=(0,w.Z)(),h=e.useMemo(()=>{if(!g)return[];let a=(g.clients||[]).map(a=>({value:a.id,label:`عميل: ${a.name}`}));return[...a,...(g.suppliers||[]).map(a=>({value:a.id,label:`مورد: ${a.name}`})),...(g.boxes||[]).map(a=>({value:a.id,label:`صندوق: ${a.name}`}))]},[g]),j=(0,av.mN)({resolver:(0,aw.u)(a_),defaultValues:a||{distributionChannels:[],dialogWidth:"1200px",dialogHeight:"700px"}});e.useEffect(()=>{j.reset(a||{distributionChannels:[],dialogWidth:"1200px",dialogHeight:"700px"})},[a,j]);let{formState:{isSubmitting:k},control:l,handleSubmit:n,watch:o}=j,p=o("dialogWidth"),q=o("dialogHeight");e.useEffect(()=>{c&&c({width:p,height:q})},[p,q,c]);let{fields:r,append:s,remove:t}=(0,av.jz)({control:l,name:"distributionChannels"}),u=async a=>{let c=await (0,aY.X)({voucherSettings:{distributed:a}});c.success?(f({title:"تم حفظ الإعدادات بنجاح"}),b&&b()):f({title:"خطأ",description:c.error,variant:"destructive"})},v=async()=>{j.setValue("dialogWidth","1200px"),j.setValue("dialogHeight","700px"),c&&c({width:"1200px",height:"700px"}),await u(j.getValues())};return(0,d.jsx)(aT.Zp,{className:"mt-4 border-none shadow-none",children:(0,d.jsx)(aT.Wu,{className:"p-0",children:(0,d.jsx)(aD.lV,{...j,children:(0,d.jsxs)("form",{onSubmit:n(u),className:"space-y-6",children:[(0,d.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/30",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{className:"font-semibold text-base",children:"أبعاد النافذة"}),(0,d.jsxs)(aZ.Lt,{children:[(0,d.jsx)(aZ.tv,{asChild:!0,children:(0,d.jsxs)(am.$,{type:"button",variant:"ghost",size:"sm",children:[(0,d.jsx)(aU.A,{className:"me-2 h-4 w-4"})," إعادة للوضع الافتراضي"]})}),(0,d.jsxs)(aZ.EO,{children:[(0,d.jsxs)(aZ.wd,{children:[(0,d.jsx)(aZ.r7,{children:"هل أنت متأكد؟"}),(0,d.jsx)(aZ.$v,{children:"سيتم إعادة أبعاد النافذة إلى الحجم الافتراضي."})]}),(0,d.jsxs)(aZ.ck,{children:[(0,d.jsx)(aZ.Zr,{children:"إلغاء"}),(0,d.jsx)(aZ.Rx,{onClick:v,className:(0,m.cn)((0,am.r)({variant:"destructive"})),children:"نعم، قم بالإعادة"})]})]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsx)(aD.zB,{control:j.control,name:"dialogWidth",render:({field:a})=>(0,d.jsxs)(aD.eI,{children:[(0,d.jsx)(aD.lR,{children:"عرض النافذة"}),(0,d.jsx)(aD.MJ,{children:(0,d.jsx)(aX.p,{...a,placeholder:"مثال: 1400px أو 90vw"})}),(0,d.jsx)(aD.C5,{})]})}),(0,d.jsx)(aD.zB,{control:j.control,name:"dialogHeight",render:({field:a})=>(0,d.jsxs)(aD.eI,{children:[(0,d.jsx)(aD.lR,{children:"ارتفاع النافذة"}),(0,d.jsx)(aD.MJ,{children:(0,d.jsx)(aX.p,{...a,placeholder:"مثال: 800px أو 90vh"})}),(0,d.jsx)(aD.C5,{})]})})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("h4",{className:"font-semibold text-base",children:"حقول التوزيع الإضافية (اختياري)"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"هنا يمكنك تحديد الحسابات الفرعية التي يمكن توزيع المبالغ عليها، مثل الفروع أو صناديق أخرى."}),r.map((a,b)=>(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr,2fr,auto] gap-2 items-end border p-3 rounded-lg bg-muted/50",children:[(0,d.jsx)(aD.zB,{control:j.control,name:`distributionChannels.${b}.label`,render:({field:a})=>(0,d.jsxs)(aD.eI,{children:[(0,d.jsx)(aD.lR,{children:"اسم الحقل"}),(0,d.jsx)(aD.MJ,{children:(0,d.jsx)(aX.p,{...a})}),(0,d.jsx)(aD.C5,{})]})}),(0,d.jsx)(aD.zB,{control:j.control,name:`distributionChannels.${b}.accountId`,render:({field:a})=>(0,d.jsxs)(aD.eI,{children:[(0,d.jsx)(aD.lR,{children:"الحساب المرتبط"}),(0,d.jsx)(aD.MJ,{children:(0,d.jsx)(aN.j,{options:h,value:a.value,onValueChange:a.onChange,placeholder:"ابحث عن حساب..."})}),(0,d.jsx)(aD.C5,{})]})}),(0,d.jsx)(am.$,{variant:"ghost",size:"icon",className:"text-destructive h-9 w-9",onClick:()=>t(b),children:(0,d.jsx)(aV.A,{className:"h-4 w-4"})})]},a.id)),(0,d.jsxs)(am.$,{type:"button",variant:"outline",size:"sm",onClick:()=>s({id:`dist_${Date.now()}`,label:"حقل جديد",accountId:""}),children:[(0,d.jsx)(aW.A,{className:"me-2 h-4 w-4"}),"إضافة حقل توزيع فرعي"]})]}),(0,d.jsx)("div",{className:"flex justify-end pt-4",children:(0,d.jsxs)(am.$,{type:"submit",disabled:k,children:[k&&(0,d.jsx)(as.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(aL.A,{className:"me-2 h-4 w-4"}),"حفظ الإعدادات"]})})]})})})})}var a1=c(64772),a2=c(49845);function a3({onVoucherAdded:a,children:b}){let[c,f]=(0,e.useState)(!1),[g,h]=(0,e.useState)(!1),{toast:j}=(0,i.dj)(),{data:k,loaded:l,fetchData:n}=(0,w.Z)(),o=k?.settings?.voucherSettings?.distributed,[p,q]=(0,e.useState)({width:o?.dialogWidth||"1200px",height:o?.dialogHeight||"700px"}),r=k?.settings?.currencySettings?.defaultCurrency||"IQD",[s,t]=(0,e.useState)(r),u=async()=>{j({title:"تم حفظ الإعدادات",description:"سيتم تطبيق الإعدادات الجديدة في المرة القادمة التي تفتح فيها هذا النموذج."}),await n(),h(!1)};return(0,d.jsxs)(ap.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(ap.zM,{asChild:!0,children:b}),(0,d.jsxs)(ap.Cf,{className:"p-0 flex flex-col overflow-auto",style:{maxWidth:p.width,width:"95vw",height:p.height,resize:"both"},children:[(0,d.jsxs)(ap.c7,{className:"p-4 rounded-t-lg flex flex-row justify-between items-center sticky top-0 bg-background z-10 border-b",style:{backgroundColor:"USD"===s?"hsl(var(--accent))":"hsl(var(--primary))",color:"white"},children:[(0,d.jsx)("div",{children:(0,d.jsx)(ap.L3,{className:"text-white",children:g?"إعدادات سند القبض المخصص":"سند قبض مخصص"})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[!g&&(0,d.jsxs)(d.Fragment,{children:[(k?.settings?.currencySettings?.currencies||[]).map(a=>(0,d.jsx)(am.$,{type:"button",onClick:()=>t(a.code),className:(0,m.cn)("text-white h-8",s===a.code?"bg-white/30":"bg-transparent border border-white/50"),children:a.code},a.code)),l&&k&&(0,d.jsx)(a2.A,{onClientAdded:()=>{},onClientUpdated:()=>{},children:(0,d.jsxs)(am.$,{variant:"outline",size:"sm",className:"h-8 text-black",children:[(0,d.jsx)(Y.A,{className:"me-2 h-4 w-4"})," إضافة شركة"]})})]}),(0,d.jsx)(am.$,{onClick:()=>h(!g),variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:g?(0,d.jsx)(aR.A,{className:"h-5 w-5"}):(0,d.jsx)(ar.A,{className:"h-5 w-5"})})]})]}),(0,d.jsx)("div",{className:"flex-grow overflow-y-auto",children:l&&k?g?(0,d.jsx)("div",{className:"p-6",children:(0,d.jsx)(a0,{initialSettings:o,onSaveSuccess:u,onDimensionsChange:q})}):o?.distributionChannels?.length?(0,d.jsx)(aQ,{onVoucherAdded:b=>{a(b),f(!1)},settings:o,selectedCurrency:s}):(0,d.jsx)("div",{className:"p-8 text-center",children:(0,d.jsxs)(a1.Fc,{variant:"destructive",children:[(0,d.jsx)(aS.A,{className:"h-4 w-4"}),(0,d.jsx)(a1.XL,{children:"إعدادات غير مكتملة!"}),(0,d.jsxs)(a1.TN,{children:["الرجاء الضغط على أيقونة الإعدادات ",(0,d.jsx)(ar.A,{className:"inline-block h-4 w-4 mx-1"})," في الأعلى وتحديد حقول التوزيع أولاً."]})]})}):(0,d.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,d.jsx)(as.A,{className:"animate-spin h-8 w-8"})})})]})]})}var a4=c(727);function a5({onVoucherAdded:a,children:b}){let[c,f]=(0,e.useState)(!1),{data:g,loaded:h}=(0,w.Z)(),[i,j]=(0,e.useState)({width:"896px",height:"80vh"}),k=g?.settings.currencySettings?.defaultCurrency||"IQD",[l,n]=(0,e.useState)(k);return(0,d.jsxs)(ap.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(ap.zM,{asChild:!0,children:b}),(0,d.jsxs)(ap.Cf,{className:"p-0 flex flex-col",style:{maxWidth:i.width,width:"95vw",height:i.height},children:[(0,d.jsxs)(ap.c7,{className:"p-4 rounded-t-lg flex flex-row justify-between items-center",style:{backgroundColor:"USD"===l?"hsl(var(--accent))":"hsl(var(--primary))",color:"white"},children:[(0,d.jsx)("div",{children:(0,d.jsx)(ap.L3,{className:"text-white",children:"إنشاء سند دفع جديد"})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(g?.settings?.currencySettings?.currencies||[]).map(a=>(0,d.jsx)(am.$,{type:"button",onClick:()=>n(a.code),className:(0,m.cn)("text-white h-8",l===a.code?"bg-white/30":"bg-transparent border border-white/50"),children:a.code},a.code)),(0,d.jsx)(at.A,{dialogKey:"payment_voucher",onDimensionsChange:j,children:(0,d.jsx)(am.$,{type:"button",variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:(0,d.jsx)(ar.A,{className:"h-5 w-5"})})})]})]}),(0,d.jsx)("div",{className:"flex-grow overflow-y-auto",children:h&&g?(0,d.jsx)(a4.A,{onVoucherAdded:b=>{a(b),f(!1)},selectedCurrency:l}):(0,d.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,d.jsx)(as.A,{className:"animate-spin h-8 w-8"})})})]})]})}var a6=c(75117);function a7({onVoucherAdded:a,children:b}){let[c,f]=(0,e.useState)(!1),{data:g,loaded:h}=(0,w.Z)(),[i,j]=(0,e.useState)({width:"896px",height:"80vh"}),k=g?.settings.currencySettings?.defaultCurrency||"IQD",[l,n]=(0,e.useState)(k);return(0,d.jsxs)(ap.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(ap.zM,{asChild:!0,children:b}),(0,d.jsxs)(ap.Cf,{className:"p-0 flex flex-col",style:{maxWidth:i.width,width:"95vw",height:i.height},children:[(0,d.jsxs)(ap.c7,{className:"p-4 rounded-t-lg flex flex-row justify-between items-center",style:{backgroundColor:"USD"===l?"hsl(var(--accent))":"hsl(var(--primary))",color:"white"},children:[(0,d.jsx)("div",{children:(0,d.jsx)(ap.L3,{className:"text-white",children:"إنشاء سند مصاريف جديد"})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(g?.settings?.currencySettings?.currencies||[]).map(a=>(0,d.jsx)(am.$,{type:"button",onClick:()=>n(a.code),className:(0,m.cn)("text-white h-8",l===a.code?"bg-white/30":"bg-transparent border border-white/50"),children:a.code},a.code)),(0,d.jsx)(at.A,{dialogKey:"expense_voucher",onDimensionsChange:j,children:(0,d.jsx)(am.$,{type:"button",variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:(0,d.jsx)(ar.A,{className:"h-5 w-5"})})})]})]}),(0,d.jsx)("div",{className:"flex-grow overflow-y-auto",children:h&&g?(0,d.jsx)(a6.A,{onVoucherAdded:b=>{a(b),f(!1)},selectedCurrency:l,boxes:g.boxes||[]}):(0,d.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,d.jsx)(as.A,{className:"animate-spin h-8 w-8"})})})]})]})}var a8=c(44955);function a9({onVoucherAdded:a,children:b}){let[c,f]=(0,e.useState)(!1),{data:g,loaded:h,fetchData:i}=(0,w.Z)(),[j,k]=(0,e.useState)({width:"896px",height:"80vh"}),l=g?.settings.currencySettings?.defaultCurrency||"IQD",[n,o]=(0,e.useState)(l);return(0,d.jsxs)(ap.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(ap.zM,{asChild:!0,children:b}),(0,d.jsxs)(ap.Cf,{className:"p-0 flex flex-col",style:{maxWidth:j.width,width:"95vw",height:j.height},children:[(0,d.jsxs)(ap.c7,{className:"p-4 rounded-t-lg flex flex-row justify-between items-center",style:{backgroundColor:"USD"===n?"hsl(var(--accent))":"hsl(var(--primary))",color:"white"},children:[(0,d.jsx)("div",{children:(0,d.jsx)(ap.L3,{className:"text-white",children:"إنشاء قيد محاسبي جديد"})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(g?.settings?.currencySettings?.currencies||[]).map(a=>(0,d.jsx)(am.$,{type:"button",onClick:()=>o(a.code),className:(0,m.cn)("text-white h-8",n===a.code?"bg-white/30":"bg-transparent border border-white/50"),children:a.code},a.code)),(0,d.jsx)(at.A,{dialogKey:"journal_voucher",onDimensionsChange:k,children:(0,d.jsx)(am.$,{type:"button",variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:(0,d.jsx)(ar.A,{className:"h-5 w-5"})})})]})]}),(0,d.jsx)("div",{className:"flex-grow overflow-y-auto",children:h?(0,d.jsx)(a8.A,{onVoucherAdded:b=>{a(b),f(!1)},selectedCurrency:n}):(0,d.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,d.jsx)(as.A,{className:"animate-spin h-8 w-8"})})})]})]})}var ba=c(57105),bb=c(32565),bc=c(71922),bd=c(39611),be=c(74940);let bf=({href:a,children:b,active:c,className:e})=>(0,d.jsx)(B(),{href:a,className:(0,m.cn)("flex items-center gap-2 rounded-lg px-3 py-2 text-sm transition-all whitespace-nowrap font-bold justify-end",c?"bg-primary text-primary-foreground":"hover:bg-muted",e),children:b}),bg=({menuConfig:a,activeRoutes:b})=>{let c=(0,z.usePathname)(),e=b.some(a=>c.startsWith(a));return(0,d.jsxs)(al.rI,{children:[(0,d.jsx)(al.ty,{asChild:!0,children:(0,d.jsxs)(am.$,{variant:e?"secondary":"ghost",className:(0,m.cn)("group flex items-center gap-1.5 rounded-lg px-3 py-2 text-sm font-bold transition-colors whitespace-nowrap w-full justify-end",e&&"bg-primary text-primary-foreground hover:bg-primary/90 hover:text-primary-foreground"),children:[a.title,(0,d.jsx)(a.icon,{className:"h-4 w-4"}),(0,d.jsx)(ba.A,{className:"h-4 w-4 transition-transform duration-200 group-data-[state=open]:rotate-180"})]})}),(0,d.jsx)(al.SQ,{children:a.items.map((a,b)=>(0,d.jsx)(al._2,{asChild:!0,children:(0,d.jsxs)(B(),{href:a.href,className:"justify-between w-full",children:[(0,d.jsx)("span",{children:a.title}),a.icon&&(0,d.jsx)(a.icon,{className:"h-4 w-4"})]})},b))})]})},bh=({href:a,icon:b,children:c})=>(0,d.jsxs)(B(),{href:a,className:"flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium hover:bg-muted justify-end",children:[(0,d.jsx)("span",{children:c}),(0,d.jsx)(b,{className:"h-4 w-4"})]}),bi=({isMobile:a=!1})=>{let b=(0,z.useRouter)(),c=()=>b.refresh(),e=[{href:"/accounts/vouchers/list",label:"سجل السندات",icon:bb.A},{href:"/settings",label:"الإعدادات",icon:ab.A}],f=[{Dialog:au,label:"سند قبض عادي",icon:bc.A,onSave:c},{Dialog:a3,label:"سند قبض مخصص",icon:ac.A,onSave:c},{Dialog:a5,label:"سند دفع",icon:bd.A,onSave:c},{Dialog:a7,label:"سند مصاريف",icon:aH.A,onSave:c},{Dialog:a9,label:"سند قيد داخلي",icon:be.A,onSave:c}];return a?(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[f.map(({Dialog:a,label:b,icon:c,onSave:e})=>(0,d.jsx)(a,{onVoucherAdded:e,children:(0,d.jsxs)("button",{className:"flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium hover:bg-muted justify-end w-full",children:[(0,d.jsx)("span",{children:b}),(0,d.jsx)(c,{className:"h-4 w-4"})]})},b)),(0,d.jsx)(al.mB,{}),e.map(a=>(0,d.jsx)(bh,{href:a.href,icon:a.icon,children:a.label},a.href))]}):(0,d.jsxs)("div",{className:"flex flex-col gap-1 p-2",children:[f.map(({Dialog:a,label:b,icon:c,onSave:e})=>(0,d.jsx)(a,{onVoucherAdded:e,children:(0,d.jsxs)(al._2,{onSelect:a=>a.preventDefault(),className:"justify-between",children:[(0,d.jsx)("span",{children:b}),(0,d.jsx)(c,{className:"h-4 w-4"})]})},b)),(0,d.jsx)(al.mB,{}),e.map(a=>(0,d.jsx)(al._2,{asChild:!0,children:(0,d.jsxs)(B(),{href:a.href,className:"justify-between w-full",children:[(0,d.jsx)("span",{children:a.label}),(0,d.jsx)(a.icon,{className:"h-4 w-4"})]})},a.href))]})},bj=()=>{let a=(0,z.usePathname)(),b=(0,ao.a)(),{fetchData:c}=(0,w.Z)();return(e.useEffect(()=>{c()},[c]),b)?(0,d.jsxs)(an.nD,{type:"single",collapsible:!0,className:"w-full",children:[ak.mainNav.map(b=>(0,d.jsxs)(bf,{href:b.href,active:a===b.href,className:"w-full justify-end text-base",children:[b.title,(0,d.jsx)(b.icon,{className:"h-5 w-5"})]},b.href)),Object.values(ak).filter(a=>Array.isArray(a.items)).map((a,b)=>(0,d.jsxs)(an.As,{value:a.title,children:[(0,d.jsx)(an.$m,{className:"hover:no-underline text-base font-bold justify-end px-3 py-2 data-[state=open]:bg-muted",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[a.title,(0,d.jsx)(a.icon,{className:"h-5 w-5"})]})}),(0,d.jsx)(an.ub,{children:(0,d.jsx)("div",{className:"flex flex-col gap-1 pr-6",children:(a=>a.items?"السندات"===a.title?(0,d.jsx)(bi,{isMobile:!0}):a.items.map((a,b)=>(0,d.jsx)(bh,{href:a.href,icon:a.icon,children:a.title},b)):null)(a)})})]},b))]}):(0,d.jsx)("div",{className:"w-full",children:(0,d.jsxs)("nav",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:[ak.mainNav.map(b=>(0,d.jsxs)(bf,{href:b.href,active:a===b.href,className:"justify-end",children:[b.title,(0,d.jsx)(b.icon,{className:"h-4 w-4"})]},b.href)),Object.values(ak).filter(a=>Array.isArray(a.items)).map((b,c)=>"السندات"===b.title?(0,d.jsxs)(al.rI,{children:[(0,d.jsx)(al.ty,{asChild:!0,children:(0,d.jsxs)(am.$,{variant:a.startsWith("/accounts/vouchers")?"secondary":"ghost",className:(0,m.cn)("group flex items-center gap-1.5 rounded-lg px-3 py-2 text-sm font-bold transition-colors whitespace-nowrap w-full justify-end",a.startsWith("/accounts/vouchers")&&"bg-primary text-primary-foreground hover:bg-primary/90 hover:text-primary-foreground"),children:[b.title,(0,d.jsx)(b.icon,{className:"h-4 w-4"}),(0,d.jsx)(ba.A,{className:"h-4 w-4 transition-transform duration-200 group-data-[state=open]:rotate-180"})]})}),(0,d.jsx)(al.SQ,{children:(0,d.jsx)(bi,{})})]},c):(0,d.jsx)(bg,{menuConfig:b,activeRoutes:b.items.map(a=>a.href)},c))]})})};function bk(){return(0,d.jsx)(bj,{})}var bl=c(9683);function bm(){let[a,b]=(0,e.useState)("");return(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(bl.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,d.jsx)(aX.p,{value:a,onChange:a=>b(a.target.value),placeholder:"بحث سريع في النظام…",className:"ps-9 pe-3 h-9"})]})}var bn=c(25354);function bo(){return(0,d.jsxs)(aE.AM,{children:[(0,d.jsx)(aE.Wv,{asChild:!0,children:(0,d.jsx)(am.$,{variant:"ghost",size:"icon",className:"h-9 w-9",children:(0,d.jsx)(bn.A,{className:"h-5 w-5"})})}),(0,d.jsxs)(aE.hl,{align:"end",side:"bottom",className:"w-80",dir:"rtl",children:[(0,d.jsx)("div",{className:"text-sm font-bold mb-2",children:"الإشعارات"}),(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:"لا إشعارات حاليًا."})]})]})}var bp=c(25969),bq=c(23727),br=c(41454),bs=c(62777),bt=c(81080);function bu(){let{user:a,signOut:b}=(0,x.A)(),c=a?.name||"مستخدم",e=c?.split(" ").map(a=>a[0]).join("").slice(0,2).toUpperCase();return(0,d.jsxs)(al.rI,{children:[(0,d.jsx)(al.ty,{asChild:!0,children:(0,d.jsx)("button",{className:"flex items-center gap-2 rounded-full focus:outline-none",children:(0,d.jsxs)(bq.eu,{className:"h-9 w-9",children:[(0,d.jsx)(bq.BK,{src:a?.avatarUrl||""}),(0,d.jsx)(bq.q5,{children:e||(0,d.jsx)(br.A,{})})]})})}),(0,d.jsxs)(al.SQ,{align:"end",side:"bottom",dir:"rtl",children:[(0,d.jsx)("div",{className:"px-2 py-1 text-sm font-bold",children:c}),(0,d.jsx)(al.mB,{}),(0,d.jsx)(al._2,{asChild:!0,children:(0,d.jsxs)(B(),{href:"/profile",className:"w-full justify-between flex items-center",children:[(0,d.jsx)("span",{children:"الملف الشخصي"}),(0,d.jsx)(bs.A,{className:"h-4 w-4 ms-2"})]})}),(0,d.jsx)(al._2,{asChild:!0,children:(0,d.jsxs)(B(),{href:"/settings",className:"w-full justify-between flex items-center",children:[(0,d.jsx)("span",{children:"الإعدادات"}),(0,d.jsx)(ab.A,{className:"h-4 w-4 ms-2"})]})}),(0,d.jsx)(al.mB,{}),(0,d.jsxs)(al._2,{onSelect:b,className:"justify-between text-destructive focus:text-destructive",children:[(0,d.jsx)("span",{children:"تسجيل الخروج"}),(0,d.jsx)(bt.A,{className:"h-4 w-4 ms-2"})]})]})]})}var bv=c(96425),bw=c(6379),bx=c(6471),by=c(86851),bz=c(27081),bA=c(27467);let bB=e.createContext(null);function bC(){let a=e.useContext(bB);if(!a)throw Error("useSidebar must be used within a SidebarProvider.");return a}let bD=e.forwardRef(({defaultOpen:a=!0,open:b,onOpenChange:c,className:f,style:g,children:h,...i},j)=>{let k=(0,ao.a)(),[l,n]=e.useState(!1),[o,p]=e.useState(a),q=b??o,r=e.useCallback(a=>{let b="function"==typeof a?a(q):a;c?c(b):p(b),document.cookie=`sidebar_state=${b}; path=/; max-age=604800`},[c,q]),s=e.useCallback(()=>k?n(a=>!a):r(a=>!a),[k,r,n]);e.useEffect(()=>{let a=a=>{"b"===a.key&&(a.metaKey||a.ctrlKey)&&(a.preventDefault(),s())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[s]);let t=q?"expanded":"collapsed",u=e.useMemo(()=>({state:t,open:q,setOpen:r,isMobile:k,openMobile:l,setOpenMobile:n,toggleSidebar:s}),[t,q,r,k,l,n,s]);return(0,d.jsx)(bB.Provider,{value:u,children:(0,d.jsx)(bA.Bc,{delayDuration:0,children:(0,d.jsx)("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...g},className:(0,m.cn)("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",f),ref:j,...i,children:h})})})});bD.displayName="SidebarProvider";let bE=e.forwardRef(({side:a="right",variant:b="sidebar",collapsible:c="offcanvas",className:e,children:f,...g},h)=>{let{isMobile:i,state:j,openMobile:k,setOpenMobile:l}=bC();return"none"===c?(0,d.jsx)("div",{className:(0,m.cn)("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",e),ref:h,...g,children:f}):i?(0,d.jsx)(by.cj,{open:k,onOpenChange:l,...g,children:(0,d.jsxs)(by.h,{"data-sidebar":"sidebar","data-mobile":"true",className:"bg-background text-foreground p-0 flex flex-col",style:{"--sidebar-width":"18rem"},side:a,children:[(0,d.jsx)(by.qp,{className:"sr-only",children:"Main Menu"}),(0,d.jsx)("div",{className:"flex h-full w-full flex-col",children:f})]})}):(0,d.jsxs)("div",{ref:h,className:(0,m.cn)("group hidden md:block peer text-sidebar-foreground"),"data-state":j,"data-collapsible":"collapsed"===j?c:"","data-variant":b,"data-side":a,children:[(0,d.jsx)("div",{className:(0,m.cn)("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===b||"inset"===b?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),(0,d.jsx)("div",{className:(0,m.cn)("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex","left"===a?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===b||"inset"===b?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",e),...g,children:(0,d.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:f})})]})});bE.displayName="Sidebar";let bF=e.forwardRef(({className:a,onClick:b,children:c,...e},f)=>{let{toggleSidebar:g,isMobile:h}=bC();return h?(0,d.jsxs)(am.$,{ref:f,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:(0,m.cn)("h-7 w-7",a),onClick:a=>{b?.(a),g()},...e,children:[c||(0,d.jsx)(bw.A,{}),(0,d.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]}):null});bF.displayName="SidebarTrigger",e.forwardRef(({className:a,...b},c)=>{let{toggleSidebar:e}=bC();return(0,d.jsx)("button",{ref:c,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:e,title:"Toggle Sidebar",className:(0,m.cn)("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",a),...b})}).displayName="SidebarRail",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("main",{ref:c,className:(0,m.cn)("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",a),...b})).displayName="SidebarInset",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(aX.p,{ref:c,"data-sidebar":"input",className:(0,m.cn)("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",a),...b})).displayName="SidebarInput";let bG=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,"data-sidebar":"header",className:(0,m.cn)("flex flex-col gap-2 p-2",a),...b}));bG.displayName="SidebarHeader",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,"data-sidebar":"footer",className:(0,m.cn)("flex flex-col gap-2 p-2",a),...b})).displayName="SidebarFooter",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(bx.Separator,{ref:c,"data-sidebar":"separator",className:(0,m.cn)("mx-2 w-auto bg-sidebar-border",a),...b})).displayName="SidebarSeparator";let bH=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,"data-sidebar":"content",className:(0,m.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",a),...b}));bH.displayName="SidebarContent";let bI=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,"data-sidebar":"group",className:(0,m.cn)("relative flex w-full min-w-0 flex-col p-2",a),...b}));bI.displayName="SidebarGroup",e.forwardRef(({className:a,asChild:b=!1,...c},e)=>{let f=b?bv.DX:"div";return(0,d.jsx)(f,{ref:e,"data-sidebar":"group-label",className:(0,m.cn)("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",a),...c})}).displayName="SidebarGroupLabel",e.forwardRef(({className:a,asChild:b=!1,...c},e)=>{let f=b?bv.DX:"button";return(0,d.jsx)(f,{ref:e,"data-sidebar":"group-action",className:(0,m.cn)("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",a),...c})}).displayName="SidebarGroupAction",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,"data-sidebar":"group-content",className:(0,m.cn)("w-full text-sm",a),...b})).displayName="SidebarGroupContent",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("ul",{ref:c,"data-sidebar":"menu",className:(0,m.cn)("flex w-full min-w-0 flex-col gap-1",a),...b})).displayName="SidebarMenu",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("li",{ref:c,"data-sidebar":"menu-item",className:(0,m.cn)("group/menu-item relative",a),...b})).displayName="SidebarMenuItem";let bJ=(0,k.F)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}});e.forwardRef(({asChild:a=!1,isActive:b=!1,variant:c="default",size:e="default",tooltip:f,className:g,...h},i)=>{let j=a?bv.DX:"button",{isMobile:k,state:l}=bC(),n=(0,d.jsx)(j,{ref:i,"data-sidebar":"menu-button","data-size":e,"data-active":b,className:(0,m.cn)(bJ({variant:c,size:e}),g),...h});return f?("string"==typeof f&&(f={children:f}),(0,d.jsxs)(bA.m_,{children:[(0,d.jsx)(bA.k$,{asChild:!0,children:n}),(0,d.jsx)(bA.ZI,{side:"right",align:"center",hidden:"collapsed"!==l||k,...f})]})):n}).displayName="SidebarMenuButton",e.forwardRef(({className:a,asChild:b=!1,showOnHover:c=!1,...e},f)=>{let g=b?bv.DX:"button";return(0,d.jsx)(g,{ref:f,"data-sidebar":"menu-action",className:(0,m.cn)("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",c&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",a),...e})}).displayName="SidebarMenuAction",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,"data-sidebar":"menu-badge",className:(0,m.cn)("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a),...b})).displayName="SidebarMenuBadge",e.forwardRef(({className:a,showIcon:b=!1,...c},f)=>{let g=e.useMemo(()=>`${Math.floor(40*Math.random())+50}%`,[]);return(0,d.jsxs)("div",{ref:f,"data-sidebar":"menu-skeleton",className:(0,m.cn)("rounded-md h-8 flex gap-2 px-2 items-center",a),...c,children:[b&&(0,d.jsx)(bz.E,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),(0,d.jsx)(bz.E,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":g}})]})}).displayName="SidebarMenuSkeleton",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("ul",{ref:c,"data-sidebar":"menu-sub",className:(0,m.cn)("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",a),...b})).displayName="SidebarMenuSub",e.forwardRef(({...a},b)=>(0,d.jsx)("li",{ref:b,...a})).displayName="SidebarMenuSubItem",e.forwardRef(({asChild:a=!1,size:b="md",isActive:c,className:e,...f},g)=>{let h=a?bv.DX:"a";return(0,d.jsx)(h,{ref:g,"data-sidebar":"menu-sub-button","data-size":b,"data-active":c,className:(0,m.cn)("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===b&&"text-xs","md"===b&&"text-sm","group-data-[collapsible=icon]:hidden",e),...f})}).displayName="SidebarMenuSubButton";var bK=c(43160);function bL(){let a=(0,ao.a)();return(0,d.jsxs)("div",{className:"container mx-auto px-4 w-full h-14 flex items-center gap-3",children:[(0,d.jsx)("div",{className:"flex items-center gap-2",children:a&&(0,d.jsx)(bF,{children:(0,d.jsx)(bK.A,{})})}),(0,d.jsx)("div",{className:"flex-1 hidden md:block",children:(0,d.jsx)(bk,{})}),(0,d.jsxs)("div",{className:"ms-auto flex items-center gap-2",children:[(0,d.jsx)("div",{className:"hidden sm:block",children:(0,d.jsx)(bm,{})}),(0,d.jsx)(bp.U,{}),(0,d.jsx)(bo,{}),(0,d.jsx)(bu,{})]})]})}var bM=c(45775);function bN(){return(0,z.usePathname)(),(0,z.useSearchParams)(),null}c.n(bM)().configure({showSpinner:!1});let bO=["/auth/login","/auth/forgot-password","/setup-admin","/"],bP=["/clients","/profile"],bQ=({children:a})=>{let{activeTheme:b}=(0,v.A)(),{theme:c}=(0,g.D)(),e=(0,ao.a)();return f().useEffect(()=>{},[b,c]),(0,d.jsx)("div",{dir:"rtl",className:"flex min-h-screen w-full flex-col bg-muted/40",children:(0,d.jsxs)(bD,{children:[e&&(0,d.jsxs)(bE,{children:[(0,d.jsx)(bG,{children:(0,d.jsx)("div",{className:"flex items-center justify-between p-2",children:(0,d.jsx)("h2",{className:"font-bold text-lg",children:"القائمة الرئيسية"})})}),(0,d.jsx)(bH,{children:(0,d.jsx)(bI,{children:(0,d.jsx)(bk,{})})})]}),(0,d.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,d.jsx)("header",{className:"sticky top-0 z-30 flex h-14 items-center gap-4 border-b bg-background/80 px-4 sm:static sm:h-auto sm:border-0 sm:bg-transparent sm:px-6 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,d.jsx)(bL,{})}),(0,d.jsx)(bN,{}),(0,d.jsx)("main",{className:"p-4 sm:px-6 sm:py-4 flex-1",children:a})]})]})})};function bR({children:a}){let{user:b,loading:c}=(0,x.A)();(0,z.useRouter)();let e=(0,z.usePathname)(),f=bO.includes(e);b&&"isClient"in b&&bP.some(a=>e.startsWith(a));let g="/"===e;return c?(0,d.jsx)(y.A,{}):b?(0,d.jsx)(bQ,{children:a}):f||g?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(bN,{}),a]}):(0,d.jsx)(y.A,{})}function bS({children:a}){return(0,d.jsx)(x.O,{children:(0,d.jsx)(w.z,{children:(0,d.jsx)(v._,{children:(0,d.jsxs)(h,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:[(0,d.jsx)(bR,{children:a}),(0,d.jsx)(u,{})]})})})})}},29303:(a,b,c)=>{"use strict";c.d(b,{T:()=>e});var d=c(85708);let e=(0,d.createServerReference)("601532f3b7a46dae258a5ff32f14fb4b3e2e141e9f",d.callServer,void 0,d.findSourceMapURL,"updateUser")},29406:(a,b,c)=>{Promise.resolve().then(c.bind(c,17218))},29631:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{PR:()=>j,fO:()=>i,tu:()=>k});var e=c(91488);c(27806);var f=c(80446),g=c(40410),h=a([f]);f=(h.then?(await h)():h)[0];let l="sequences",m=[{id:"RC",label:"سند قبض",prefix:"RC"},{id:"PV",label:"سند دفع",prefix:"PV"},{id:"EX",label:"سند مصاريف",prefix:"EX"},{id:"TR",label:"سند حوالة",prefix:"TR"},{id:"DS",label:"سند قبض مخصص",prefix:"DS"},{id:"JE",label:"سند قيد محاسبي",prefix:"JE"},{id:"BK",label:"إدخال حجز",prefix:"BK"},{id:"PR",label:"ربح شهري",prefix:"PR"},{id:"VS",label:"إدخال فيزا",prefix:"VS"},{id:"SUB",label:"إنشاء اشتراك",prefix:"SUB"},{id:"SUBP",label:"دفعة قسط اشتراك",prefix:"SUBP"},{id:"RF",label:"استرجاع تذكرة",prefix:"RF"},{id:"EXC",label:"تغيير تذكرة",prefix:"EXC"},{id:"VOID",label:"إلغاء (فويد)",prefix:"VOID"},{id:"EXT",label:"معاملة بورصة",prefix:"EXT"},{id:"EXP",label:"تسديد بورصة",prefix:"EXP"},{id:"SEG",label:"سكمنت",prefix:"SEG"},{id:"CL",label:"علاقة (عميل/مورد)",prefix:"CL"}];async function i(){let a=await (0,f.Lf)();if(!a)throw Error("Database not available.");let b=await a.collection(l).get();if(b.empty){let b=a.batch(),c=m.map(a=>({...a,value:0}));return c.forEach(c=>{b.set(a.collection(l).doc(c.id),c)}),await b.commit(),c}let c=b.docs.map(a=>a.data()),d=m.filter(a=>!c.some(b=>b.id===a.id));if(d.length>0){let b=a.batch();return d.forEach(c=>{b.set(a.collection(l).doc(c.id),{...c,value:0})}),await b.commit(),i()}return c}async function j(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available"};try{return await c.collection(l).doc(a).update(b),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function k(a){let b=await (0,f.Lf)();if(!b)throw Error("Database not available.");let c=b.collection(l).doc(a);try{let d=await b.runTransaction(async b=>{let d=await b.get(c),e=1,f=a,g=`سند ${a}`;if(d.exists){let b=d.data();e=(b.value||0)+1,f=b.prefix||a,g=b.label||g}return b.set(c,{value:e,prefix:f,label:g},{merge:!0}),{number:e,prefix:f}}),e=String(d.number).padStart(6,"0");return`${d.prefix}-${e}`}catch(b){return console.error(`Error getting next voucher number for prefix ${a}:`,b),`${a}-${Date.now().toString().slice(-6)}`}}(0,g.D)([i,j,k]),(0,e.A)(i,"00f8105cf2df698dda196c821059bffd2c12bb65d6",null),(0,e.A)(j,"60bfff327e3bf73dac5fa7bb6d2690e1fed6e5cf56",null),(0,e.A)(k,"40f3e2b0ca2e561c506ffb1575ff80c4dac60766e4",null),d()}catch(a){d(a)}})},33875:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{q:()=>m});var e=c(91488);c(27806);var f=c(80446),g=c(62641),h=c(91837),i=c(29631),j=c(58749),k=c(40410),l=a([f,g,i,j]);async function m(a){let b=await (0,g.$T)();if(!b)return{success:!1,error:"User not authenticated."};let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};try{let d=c.collection("journal-vouchers").doc(),e=await (0,i.tu)("JE"),f=a.entries.filter(a=>a.debit>0).map(b=>({accountId:b.accountId,amount:b.debit,description:a.notes})),g=a.entries.filter(a=>a.credit>0).map(b=>({accountId:b.accountId,amount:b.credit,description:a.notes}));return await d.set({invoiceNumber:e,date:a.date,currency:a.currency,exchangeRate:a.exchangeRate||null,notes:a.notes,createdBy:b.uid,officer:b.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),voucherType:"journal_voucher",debitEntries:f,creditEntries:g,isAudited:!1,isConfirmed:!1}),await (0,j.iL)({userId:b.uid,userName:b.name,action:"CREATE",targetType:"VOUCHER",description:`أنشأ قيدًا محاسبيًا برقم ${e}.`}),(0,h.revalidatePath)("/accounts/vouchers/list"),(0,h.revalidatePath)("/reports/account-statement"),{success:!0}}catch(a){return console.error("Error creating journal voucher: ",String(a)),{success:!1,error:a.message}}}[f,g,i,j]=l.then?(await l)():l,(0,k.D)([m]),(0,e.A)(m,"400c84b00cbc18181ec896b17d3329ab44688122ee",null),d()}catch(a){d(a)}})},35284:(a,b,c)=>{"use strict";c.d(b,{$:()=>j,r:()=>i});var d=c(21124),e=c(38301),f=c(96425),g=c(26691),h=c(44943);let i=(0,g.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-bold ring-offset-background transition-transform transform-gpu hover:-translate-y-0.5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",accent:"bg-accent text-accent-foreground shadow-md hover:bg-accent/90"},size:{default:"h-10 px-4 py-2 [&_svg]:size-4",sm:"h-9 rounded-md px-3 [&_svg]:size-4",lg:"h-11 rounded-lg px-8 [&_svg]:size-5",icon:"h-10 w-10 [&_svg]:size-5"}},defaultVariants:{variant:"default",size:"default"}}),j=e.forwardRef(({className:a,variant:b,size:c,asChild:e=!1,...g},j)=>{let k=e?f.DX:"button";return(0,d.jsx)(k,{className:(0,h.cn)(i({variant:b,size:c,className:a})),ref:j,...g})});j.displayName="Button"},37448:(a,b,c)=>{"use strict";c.d(b,{dj:()=>l});var d=c(38301);let e=0,f=new Map,g=a=>{if(f.has(a))return;let b=setTimeout(()=>{f.delete(a),j({type:"REMOVE_TOAST",toastId:a})},1e6);f.set(a,b)},h=[],i={toasts:[]};function j(a){i=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,3)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?g(c):a.toasts.forEach(a=>{g(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(i,a),h.forEach(a=>{a(i)})}function k({...a}){let b=(e=(e+1)%Number.MAX_SAFE_INTEGER).toString(),c=()=>j({type:"DISMISS_TOAST",toastId:b});return a.variant||(a.variant="default"),j({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||c()}}}),{id:b,dismiss:c,update:a=>j({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function l(){let[a,b]=d.useState(i);return d.useEffect(()=>(h.push(b),()=>{let a=h.indexOf(b);a>-1&&h.splice(a,1)}),[a]),{...a,toast:k,dismiss:a=>j({type:"DISMISS_TOAST",toastId:a})}}},38505:(a,b,c)=>{"use strict";c.d(b,{L:()=>e});var d=c(85708);let e=(0,d.createServerReference)("400e621b7f78c4800cffc85d668ca10cd73eb6853c",d.callServer,void 0,d.findSourceMapURL,"getClients")},39661:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{DI:()=>m,EP:()=>q,EZ:()=>o,KB:()=>t,Lf:()=>n,d5:()=>p,zO:()=>r,zZ:()=>s});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(62641),i=c(58749),j=c(29631),k=c(40410),l=a([f,h,i,j]);async function m(a){let{clients:b}=await n({...a,all:!0});return b.map(a=>({value:a.id,label:`${a.name} ${a.code?`(${a.code})`:""}`,relationType:a.relationType,paymentType:a.paymentType}))}async function n(a={}){let{all:b=!1,limit:c=15,page:d=1,searchTerm:e,relationType:g,paymentType:h,status:i,country:j,province:k,sortBy:l="useCount_desc"}=a,m=await (0,f.Lf)();if(!m)return{clients:[],total:0};try{let f,n=m.collection("clients");if(g&&"all"!==g){let a="client"===g?["client","both"]:"supplier"===g?["supplier","both"]:[g];a.length>0&&(n=n.where("relationType","in",a))}h&&"all"!==h&&(n=n.where("paymentType","==",h)),i&&"all"!==i&&(n=n.where("status","==",i)),!0===a.includeInactive||i||(n=n.where("status","==","active")),j&&"all"!==j&&(n=n.where("country","==",j)),k&&"all"!==k&&(n=n.where("province","==",k));let o=(await n.get()).docs;if(e){let a=e.toLowerCase();o=o.filter(b=>{let c=b.data();return c.name&&c.name.toLowerCase().includes(a)||c.phone&&String(c.phone).includes(a)||c.code&&c.code.toLowerCase().includes(a)})}let p=o.length;if(l){let[a,b]=l.split("_");o.sort((c,d)=>{let e=c.data(),f=d.data(),g=e[a],h=f[a];if(null==g)return 1;if(null==h)return -1;let i=0;return"string"==typeof g&&"string"==typeof h?i=g.localeCompare(h):g>h?i=1:g<h&&(i=-1),"desc"===b?-1*i:i})}if(b)f=o;else{let a=(d-1)*c;f=o.slice(a,a+c)}if(0===f.length)return{clients:[],total:0};return{clients:f.map(a=>{let b=a.data();return{...JSON.parse(JSON.stringify(b,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b)),id:a.id}}),total:p}}catch(a){return console.error("Error getting clients from Firestore: ",String(a)),{clients:[],total:0}}}async function o(a){let b=await (0,f.Lf)();if(!b)return null;try{let c=await b.collection("clients").doc(a).get();if(!c.exists)return null;let d=c.data(),e=JSON.parse(JSON.stringify(d,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b));return{id:c.id,...e}}catch(b){return console.error(`Error getting client by ID ${a}:`,String(b)),null}}async function p(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=c.name,e=await (0,j.tu)("CL"),f={...a,code:e,createdAt:new Date().toISOString(),createdBy:d,balance:{USD:0,IQD:0},lastTransaction:null,useCount:0};f.password&&f.password.length>=6||delete f.password;let h=await b.collection("clients").add(f);await (0,i.iL)({userId:c.uid,userName:c.name,action:"CREATE",targetType:"CLIENT",description:`أنشأ علاقة جديدة باسم: ${f.name} (ID: ${h.id})`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts");let k={...f,id:h.id};return{success:!0,client:k}}catch(a){return console.error("Error adding client:",a),{success:!1,error:a.message}}}async function q(a){let b=await (0,f.Lf)();if(!b)return{success:!1,count:0,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,count:0,error:"Unauthorized"};try{for(let d of a){let a=b.batch(),e=b.collection("clients").doc(),f=await (0,j.tu)("CL"),g={...d,code:f,createdAt:new Date().toISOString(),createdBy:`مستورد بواسطة ${c.name}`,type:d.type||"individual",relationType:d.relationType||"client",status:d.status||"active",balance:{USD:0,IQD:0},lastTransaction:null,useCount:0,avatarUrl:""};g.password||delete g.password,a.set(e,g),await a.commit()}return await (0,i.iL)({userId:c.uid,userName:c.name,action:"CREATE",targetType:"CLIENT",description:`استورد ${a.length} علاقات جديدة من ملف.`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/relations/settings"),(0,g.revalidatePath)("/reports/debts"),{success:!0,count:a.length}}catch(a){return console.error("Error adding multiple clients: ",String(a)),{success:!1,count:0,error:"Failed to add clients."}}}async function r(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};let d=await (0,h.$T)();if(!d)return{success:!1,error:"Unauthorized"};try{let e=JSON.parse(JSON.stringify(b));(""===b.password||void 0===b.password||null===b.password)&&delete e.password,await c.collection("clients").doc(a).update(e),await (0,i.iL)({userId:d.uid,userName:d.name,action:"UPDATE",targetType:"CLIENT",description:`عدل بيانات العلاقة (ID: ${a})`});let f=await c.collection("clients").doc(a).get(),h=JSON.parse(JSON.stringify(f.data(),(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b)),j={id:f.id,...h};return(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0,updatedClient:j}}catch(a){return console.error("Error updating client:",a),{success:!1,error:a.message}}}async function s(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=(await b.collection("clients").doc(a).get()).data();if(d?.useCount&&d.useCount>0)return{success:!1,error:"لا يمكن حذف هذه العلاقة لوجود معاملات مالية مرتبطة بها."};let e=d?.name||"unknown";return await b.collection("clients").doc(a).delete(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"CLIENT",description:`حذف العلاقة: ${e} (ID: ${a})`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function t(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=b.batch();return a.forEach(a=>{let c=b.collection("clients").doc(a);d.delete(c)}),await d.commit(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"CLIENT",description:`حذف ${a.length} علاقات بشكل جماعي.`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0}}catch(a){return{success:!1,error:a.message}}}[f,h,i,j]=l.then?(await l)():l,(0,k.D)([m,n,o,p,q,r,s,t]),(0,e.A)(m,"409ba91156ff082c07d90f218ef67bfea8be50f67c",null),(0,e.A)(n,"406c8a5fa8b6f219b1d6c0d2ed6d4215e348e5c534",null),(0,e.A)(o,"400c0115434cd29d4eca4428f9840cb7a074049ed1",null),(0,e.A)(p,"40939e0ffddd5729906956a18bd5a10b991b0ccc8b",null),(0,e.A)(q,"40d0448bacb32a373d23394258f9e7de4aa7fd38a9",null),(0,e.A)(r,"60e34f9cbe57141cf2262bc166578e2d558a98e99f",null),(0,e.A)(s,"40c58d0bc8d4f91d67a942b18e51dcb1bf43076f6e",null),(0,e.A)(t,"40211bb4321aca8530a09b81e44f46cc59da30c2c4",null),d()}catch(a){d(a)}})},40068:(a,b,c)=>{"use strict";c.d(b,{Cf:()=>n,Es:()=>p,HM:()=>l,L3:()=>q,c7:()=>o,lG:()=>i,rr:()=>r,zM:()=>j});var d=c(21124),e=c(38301),f=c(39641),g=c(90447),h=c(44943);let i=f.bL,j=f.l9,k=f.ZL,l=f.bm,m=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hJ,{ref:c,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b}));m.displayName=f.hJ.displayName;let n=e.forwardRef(({className:a,children:b,showCloseButton:c=!0,...e},i)=>(0,d.jsxs)(k,{children:[(0,d.jsx)(m,{}),(0,d.jsxs)(f.UC,{ref:i,className:(0,h.cn)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),onOpenAutoFocus:a=>a.preventDefault(),...e,children:[b,c&&(0,d.jsxs)(f.bm,{className:"absolute left-4 top-4 rounded-full p-1.5 opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground bg-muted hover:bg-muted/80",children:[(0,d.jsx)(g.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));n.displayName=f.UC.displayName;let o=({className:a,...b})=>(0,d.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-right",a),...b});o.displayName="DialogHeader";let p=({className:a,...b})=>(0,d.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 rtl:space-x-reverse",a),...b});p.displayName="DialogFooter";let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hE,{ref:c,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));q.displayName=f.hE.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.VY,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));r.displayName=f.VY.displayName},40982:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{d:()=>m});var e=c(91488);c(27806);var f=c(80446),g=c(62641),h=c(91837),i=c(58749),j=c(15105),k=c(40410),l=a([f,g,i,j]);async function m(a){let b=await (0,g.$T)();if(!b)return{success:!1,error:"User not authenticated."};if(!await (0,f.Lf)())return{success:!1,error:"Database not available."};try{let c=await (0,j.a)({sourceType:"manualExpense",sourceId:`expense-${Date.now()}`,description:`مصروف ${a.expenseType}: ${a.notes||""}`.trim(),amount:a.amount,currency:a.currency,date:new Date(a.date),userId:b.uid,debitAccountId:`expense_${a.expenseType}`,creditAccountId:a.boxId});return await (0,i.iL)({userId:b.uid,userName:b.name,action:"CREATE",targetType:"VOUCHER",description:`أنشأ سند مصاريف بمبلغ ${a.amount} ${a.currency}.`,targetId:c}),(0,h.revalidatePath)("/accounts/vouchers/list"),(0,h.revalidatePath)("/reports/account-statement"),{success:!0,voucherId:c}}catch(a){return console.error("Error creating expense voucher: ",String(a)),{success:!1,error:a.message}}}[f,g,i,j]=l.then?(await l)():l,(0,k.D)([m]),(0,e.A)(m,"4013135d45b93942093eced825516b1e20941831b7",null),d()}catch(a){d(a)}})},41925:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{UI:()=>k,X0:()=>m,bA:()=>l,js:()=>j});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(40410),i=a([f]);f=(i.then?(await i)():i)[0];let n="notifications";async function j(a,b={}){let c=await (0,f.Lf)();if(!c)return[];try{let d=c.collection(n).where("userId","==",a);b.unreadOnly&&(d=d.where("isRead","==",!1)),d=d.orderBy("createdAt","desc"),b.limit&&(d=d.limit(b.limit));let e=await d.get();if(e.empty)return[];return e.docs.map(a=>(a=>{let b=a.data();if(!b)return null;let c={...b,id:a.id};for(let a in c)c[a]&&"function"==typeof c[a].toDate&&(c[a]=c[a].toDate().toISOString());return c})(a))}catch(a){return console.error("Error getting notifications:",String(a)),[]}}async function k(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};try{if("createdBy"in a&&a.userId===a.createdBy)return{success:!0};return await b.collection(n).add({...a,createdAt:new Date().toISOString(),isRead:!1}),{success:!0}}catch(a){return console.error("Error creating notification:",String(a)),{success:!1,error:"Failed to create notification."}}}async function l(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};try{return await b.collection(n).doc(a).update({isRead:!0}),(0,g.revalidatePath)("/notifications"),{success:!0}}catch(a){return console.error("Error marking notification as read:",String(a)),{success:!1,error:"Failed to update notification."}}}async function m(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};try{let c=await b.collection(n).where("userId","==",a).where("isRead","==",!1).get();if(c.empty)return{success:!0};let d=b.batch();return c.docs.forEach(a=>{d.update(a.ref,{isRead:!0})}),await d.commit(),(0,g.revalidatePath)("/notifications"),{success:!0}}catch(a){return console.error("Error marking all as read:",String(a)),{success:!1,error:"Failed to update notifications."}}}(0,h.D)([j,k,l,m]),(0,e.A)(j,"6047a1a74fab99054e5a53a2c2e7f64dabaacec2d3",null),(0,e.A)(k,"40dd9176dc7d73bc74c73e9a2573564d24fb8f3d30",null),(0,e.A)(l,"4057f76de3bc71ea2a5efdd71bdf4d13792e53a1e8",null),(0,e.A)(m,"40842b09df19a23343ed36200473a84c02c9a9c375",null),d()}catch(a){d(a)}})},42329:(a,b,c)=>{"use strict";c.d(b,{C1:()=>h,LB:()=>i,lE:()=>j});var d=c(21124),e=c(38301),f=c(8015),g=c(44943);let h=e.forwardRef(({className:a,children:b,initialStep:c,steps:e,activeStep:f,...h},i)=>(0,d.jsx)("div",{ref:i,className:(0,g.cn)("flex w-full flex-row justify-between gap-x-2",a),...h,children:b}));h.displayName="Stepper";let i=e.forwardRef(({className:a,label:b,isCompleted:c,isActive:e,isOptional:h,icon:i,isLast:j,...k},l)=>(0,d.jsxs)("div",{ref:l,className:(0,g.cn)("flex flex-1 items-center gap-x-2",a),...k,children:[(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsx)("div",{className:(0,g.cn)("flex h-8 w-8 items-center justify-center rounded-full text-lg font-bold ring-2 transition-colors",e?"bg-primary text-primary-foreground ring-primary":c?"bg-secondary text-secondary-foreground ring-secondary":"bg-muted text-muted-foreground ring-muted"),children:c?(0,d.jsx)(f.A,{}):i})}),(0,d.jsx)("div",{className:"hidden md:flex flex-col",children:(0,d.jsx)("h3",{className:(0,g.cn)("font-medium transition-colors",e?"text-primary":"text-muted-foreground"),children:b})}),!j&&(0,d.jsx)("div",{className:"h-px w-full flex-1 bg-border transition-colors","aria-hidden":"true"})]}));i.displayName="StepperItem";let j=({initialStep:a=0,steps:b})=>{let[c,d]=e.useState(a),f=e.useCallback(()=>{d(a=>a<b.length-1?a+1:a)},[b.length]),g=e.useCallback(()=>{d(a=>a>0?a-1:a)},[]),h=e.useCallback(()=>{d(a)},[a]),i=c===b.length-1;return{activeStep:c,setActiveStep:d,goToNextStep:f,goToPreviousStep:g,resetSteps:h,isDisabledStep:0===c,isLastStep:i}}},43028:()=>{},43328:(a,b,c)=>{"use strict";c.d(b,{A:()=>F});var d=c(21124),e=c(38301),f=c(35284),g=c(68120),h=c(68254),i=c(45608),j=c(38692),k=c(34118),l=c(11943),m=c(54163),n=c(49113),o=c(49566),p=c(99546),q=c(31980),r=c(50937),s=c(37448),t=c(5488),u=c(44943),v=c(40068),w=c(21853),x=c(85708);let y=(0,x.createServerReference)("405181b3416ca6fb6435ab9096a0a68342e5255501",x.callServer,void 0,x.findSourceMapURL,"createStandardReceipt");var z=c(92351),A=c(25456),B=c(97802),C=c(63009);let D=p.Ik({date:p.p6({required_error:"التاريخ مطلوب"}),from:p.Yj().min(1,"اسم الدافع مطلوب"),toBox:p.Yj().min(1,"الصندوق مطلوب"),amount:p.Yj().or(p.ai()).transform(a=>Number(String(a).replace(/,/g,""))).refine(a=>a>0,{message:"المبلغ يجب أن يكون أكبر من صفر"}),currency:p.k5(["USD","IQD"]),details:p.Yj().optional()}),E=({currency:a,className:b,...c})=>(0,d.jsx)(A.O,{currency:a,className:(0,u.cn)("text-right",b),currencyClassName:(0,u.cn)("USD"===a?"bg-accent text-accent-foreground":"bg-primary text-primary-foreground"),...c});function F({onVoucherAdded:a,selectedCurrency:b,isEditing:c,initialData:p,onVoucherUpdated:u}){let{data:x}=(0,B.Z)(),{user:A}=(0,C.A)(),{toast:F}=(0,s.dj)(),G=(0,q.mN)({resolver:(0,r.u)(D),defaultValues:c?p:{date:new Date,currency:b,amount:void 0,details:"",from:"",toBox:A&&"role"in A?A.boxId:""}}),{control:H,handleSubmit:I,setValue:J,register:K,formState:{errors:L,isSubmitting:M},reset:N}=G,O=(0,e.useMemo)(()=>{let a=G.watch("toBox");return x?.boxes?.find(b=>b.id===a)?.name||"غير محدد"},[G,x?.boxes]),P=async b=>{let d=F({title:`جاري ${c?"تحديث":"إضافة"} السند...`});try{if(c&&p?.id){let a=await (0,z.o)(p.id,{originalData:b,date:b.date.toISOString()});if(!a.success)throw Error(a.error);u&&u(b)}else{let c=await y({date:b.date.toISOString(),from:b.from,toBox:b.toBox,amount:b.amount,currency:b.currency,details:b.details});if(!c.success)throw Error(c.error);a&&a(b),N()}d.update({id:d.id,title:`تم ${c?"تحديث":"إنشاء"} السند بنجاح`})}catch(a){d.update({id:d.id,title:"حدث خطأ",description:a.message,variant:"destructive"})}};return(0,d.jsxs)("form",{onSubmit:I(P),className:"flex flex-col h-full",children:[(0,d.jsxs)("div",{className:"p-6 space-y-6 flex-grow",children:[(0,d.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 items-start",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"date",children:"التاريخ"}),(0,d.jsx)(q.xI,{control:H,name:"date",render:({field:a})=>(0,d.jsx)(t.K,{date:a.value,setDate:a.onChange})}),L.date&&(0,d.jsx)("p",{className:"text-sm text-destructive mt-1",children:L.date.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"from",children:"استلام من"}),(0,d.jsx)(q.xI,{name:"from",control:H,render:({field:a})=>(0,d.jsx)(w.j,{searchAction:"all",value:a.value,onValueChange:a.onChange,placeholder:"ابحث عن عميل أو مورد..."})}),L.from&&(0,d.jsx)("p",{className:"text-destructive text-sm mt-1",children:L.from.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"toBox",children:"إيداع في صندوق"}),(0,d.jsx)(q.xI,{name:"toBox",control:H,render:({field:a})=>(0,d.jsxs)(i.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(i.bq,{children:(0,d.jsx)(i.yv,{placeholder:"اختر صندوق..."})}),(0,d.jsx)(i.gC,{children:(x?.boxes||[]).map(a=>(0,d.jsx)(i.eb,{value:a.id,children:a.name},a.id))})]})}),L.toBox&&(0,d.jsx)("p",{className:"text-destructive text-sm mt-1",children:L.toBox.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"amount",children:"المبلغ المستلم"}),(0,d.jsx)(q.xI,{name:"amount",control:H,render:({field:a})=>(0,d.jsx)(E,{currency:b,...a,onValueChange:a.onChange})}),L.amount&&(0,d.jsx)("p",{className:"text-destructive text-sm mt-1",children:L.amount.message})]})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"details",children:"تفاصيل إضافية / البيان"}),(0,d.jsx)(h.T,{id:"details",...K("details")}),L.details&&(0,d.jsx)("p",{className:"text-destructive text-sm mt-1",children:L.details.message})]})]}),(0,d.jsx)(v.Es,{className:"p-4 border-t bg-background sticky bottom-0",children:(0,d.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(j.A,{className:"h-4 w-4"})," ",(0,d.jsxs)("span",{children:["المستخدم: ",A?.name||"..."]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(k.A,{className:"h-4 w-4"})," ",(0,d.jsxs)("span",{children:["الصندوق: ",O]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(l.A,{className:"h-4 w-4"})," ",(0,d.jsx)("span",{children:"رقم الفاتورة: (تلقائي)"})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(f.$,{type:"button",onClick:()=>{},variant:"outline",disabled:M,children:[(0,d.jsx)(m.A,{className:"me-2 h-4 w-4"}),"حفظ وطباعة"]}),(0,d.jsxs)(f.$,{type:"submit",disabled:M,children:[M&&(0,d.jsx)(n.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(o.A,{className:"me-2 h-4 w-4"}),c?"حفظ التعديلات":"حفظ السند"]})]})]})})]})}},44943:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f,pY:()=>g});var d=c(43249),e=c(58829);function f(...a){return(0,e.QP)((0,d.$)(a))}let g=(a,b,c,d)=>{let e={};return Object.keys(a).map(a=>a.toLowerCase().trim()),c.forEach(b=>{let c,f=d?.[b.id],g=(b.aliases||f?.aliases||[b.label]).map(a=>a.toLowerCase().trim()),h=Array.from(new Set([b.id,b.label,...g].map(a=>a.toLowerCase().trim()))),i=Object.keys(a).find(a=>h.includes(a.toLowerCase().trim()));i&&(c=a[i]),null==c||""===String(c).trim()?e[b.id]=void 0!==b.defaultValue?b.defaultValue:"number"===b.dataType?0:"":"number"===b.dataType?e[b.id]=parseFloat(String(c).trim().replace(/,/g,""))||0:e[b.id]=String(c).trim()}),e}},44955:(a,b,c)=>{"use strict";c.d(b,{A:()=>I});var d=c(21124),e=c(38301),f=c.n(e),g=c(35284),h=c(68120),i=c(68254),j=c(10656),k=c(40822),l=c(75713),m=c(38692),n=c(11943),o=c(54163),p=c(49113),q=c(49566),r=c(99546),s=c(31980),t=c(50937),u=c(37448),v=c(5488),w=c(44943),x=c(40068),y=c(63009),z=c(21853),A=c(85708);let B=(0,A.createServerReference)("400c84b00cbc18181ec896b17d3329ab44688122ee",A.callServer,void 0,A.findSourceMapURL,"createJournalVoucher");var C=c(92351),D=c(25456),E=c(97802);let F=r.Ik({accountId:r.Yj().min(1,"الحساب مطلوب"),debit:r.au.number().min(0).default(0),credit:r.au.number().min(0).default(0)}),G=r.Ik({date:r.p6({required_error:"التاريخ مطلوب"}),currency:r.k5(["USD","IQD"]),notes:r.Yj().min(1,"بيان القيد مطلوب"),exchangeRate:r.au.number().optional(),entries:r.YO(F).min(2,"يجب وجود حركتين على الأقل (مدين ودائن).")}),H=({...a})=>(0,d.jsx)("div",{className:"relative",children:(0,d.jsx)(D.O,{placeholder:"0.00",...a})});function I({onVoucherAdded:a,onVoucherUpdated:b,isEditing:c,initialData:e,selectedCurrency:r}){let{toast:A}=(0,u.dj)(),{user:F}=(0,y.A)(),{data:I}=(0,E.Z)(),J=f().useMemo(()=>I?[...(I.clients||[]).map(a=>({value:a.id,label:`عميل: ${a.name}`})),...(I.suppliers||[]).map(a=>({value:a.id,label:`مورد: ${a.name}`})),...(I.boxes||[]).map(a=>({value:a.id,label:`صندوق: ${a.name}`})),...(I.exchanges||[]).map(a=>({value:a.id,label:`بورصة: ${a.name}`}))]:[],[I]),{control:K,handleSubmit:L,setValue:M,watch:N,register:O,formState:{errors:P,isSubmitting:Q},reset:R}=(0,s.mN)({resolver:(0,t.u)(G),defaultValues:c?e:{date:new Date,currency:r,notes:"",entries:[{accountId:"",debit:0,credit:0},{accountId:"",debit:0,credit:0}]}}),{fields:S,append:T,remove:U}=(0,s.jz)({control:K,name:"entries"}),V=N("entries"),W=V.reduce((a,b)=>a+(Number(b.debit)||0),0),X=V.reduce((a,b)=>a+(Number(b.credit)||0),0),Y=W-X,Z=async d=>{if(Math.abs(Y)>.01)return void A({title:"القيد غير متوازن",description:"مجموع المدين يجب أن يساوي مجموع الدائن.",variant:"destructive"});try{if(c&&e?.id){let a=await (0,C.o)(e.id,{...d,date:d.date.toISOString()});a.success?(A({title:"تم تحديث السند بنجاح"}),b&&b({})):A({title:"خطأ في التحديث",description:a.error,variant:"destructive"})}else{let b=await B({date:d.date.toISOString(),currency:d.currency,notes:d.notes,exchangeRate:d.exchangeRate,entries:d.entries});if(b.success)A({title:"تم إنشاء القيد المحاسبي بنجاح"}),a&&a({}),R();else throw Error(b.error)}}catch(a){A({title:"حدث خطأ",description:a.message,variant:"destructive"})}};return(0,d.jsxs)("form",{onSubmit:L(Z),className:"space-y-4",children:[(0,d.jsxs)("div",{className:"p-6 space-y-6 flex-grow",children:[(0,d.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 items-start",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{htmlFor:"date",children:"التاريخ"}),(0,d.jsx)(s.xI,{control:K,name:"date",render:({field:a})=>(0,d.jsx)(v.K,{date:a.value,setDate:a.onChange})}),P.date&&(0,d.jsx)("p",{className:"text-sm text-destructive h-4",children:P.date.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{htmlFor:"notes",children:"البيان / السبب"}),(0,d.jsx)(i.T,{id:"notes",placeholder:"أضف شرحًا لسبب القيد...",...O("notes")}),P.notes&&(0,d.jsx)("p",{className:"text-sm text-destructive h-4",children:P.notes.message})]}),"USD"===r&&(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(h.J,{htmlFor:"exchangeRate",children:"سعر الصرف (مقابل الدينار)"}),(0,d.jsx)(s.xI,{name:"exchangeRate",control:K,render:({field:a})=>(0,d.jsx)(D.O,{placeholder:"0.00",...a,onValueChange:a.onChange})})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("h4",{className:"font-semibold",children:"حركات القيد"}),(0,d.jsxs)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T({accountId:"",debit:void 0,credit:void 0}),children:[(0,d.jsx)(j.A,{className:"me-2 h-4 w-4"})," إضافة حركة"]})]}),S.map((a,b)=>(0,d.jsxs)("div",{className:"grid grid-cols-[1fr,auto,auto,auto] gap-2 items-center border p-2 rounded-lg",children:[(0,d.jsx)(s.xI,{name:`entries.${b}.accountId`,control:K,render:({field:a})=>(0,d.jsx)(z.j,{searchAction:"all",options:J,value:a.value,onValueChange:a.onChange,placeholder:"ابحث عن حساب..."})}),(0,d.jsx)(s.xI,{name:`entries.${b}.debit`,control:K,render:({field:a})=>(0,d.jsx)(H,{placeholder:"المدين",className:"w-28",...a,onValueChange:a.onChange})}),(0,d.jsx)(s.xI,{name:`entries.${b}.credit`,control:K,render:({field:a})=>(0,d.jsx)(H,{placeholder:"الدائن",className:"w-28",...a,onValueChange:a.onChange})}),(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"text-destructive h-8 w-8",onClick:()=>U(b),disabled:S.length<=2,children:(0,d.jsx)(k.A,{className:"h-4 w-4"})})]},a.id)),P.entries&&(0,d.jsx)("p",{className:"text-sm text-destructive",children:P.entries.message||P.entries?.root?.message})]}),(0,d.jsxs)("div",{className:"grid grid-cols-3 gap-4 p-4 border rounded-lg bg-muted/50",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(h.J,{children:"إجمالي المدين"}),(0,d.jsx)("p",{className:"font-bold text-lg text-green-600",children:W.toFixed(2)})]}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(h.J,{children:"إجمالي الدائن"}),(0,d.jsx)("p",{className:"font-bold text-lg text-red-600",children:X.toFixed(2)})]}),(0,d.jsxs)("div",{className:(0,w.cn)("text-center transition-colors",0!==Y?"text-destructive":"text-muted-foreground"),children:[(0,d.jsx)(h.J,{children:"الفرق (التوازن)"}),(0,d.jsxs)("p",{className:"font-bold text-lg flex items-center justify-center gap-2",children:[(0,d.jsx)(l.A,{className:"h-5 w-5"}),Y.toFixed(2)]})]})]})]}),(0,d.jsx)(x.Es,{className:"p-4 border-t bg-background sticky bottom-0",children:(0,d.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(m.A,{className:"h-4 w-4"})," ",(0,d.jsxs)("span",{children:["المستخدم: ",F?.name||"..."]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(n.A,{className:"h-4 w-4"})," ",(0,d.jsx)("span",{children:"رقم القيد: (تلقائي)"})]})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsxs)(g.$,{type:"button",onClick:()=>{},variant:"outline",disabled:Q,children:[(0,d.jsx)(o.A,{className:"me-2 h-4 w-4"}),"حفظ وطباعة"]}),(0,d.jsxs)(g.$,{type:"submit",disabled:Q,children:[Q&&(0,d.jsx)(p.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(q.A,{className:"me-2 h-4 w-4"}),c?"حفظ التعديلات":"حفظ القيد"]})]})]})})]})}},45608:(a,b,c)=>{"use strict";c.d(b,{bq:()=>m,eb:()=>q,gC:()=>p,l6:()=>k,yv:()=>l});var d=c(21124),e=c(38301),f=c(45693),g=c(57105),h=c(76488),i=c(8015),j=c(44943);let k=f.bL;f.YJ;let l=f.WT,m=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.l9,{ref:e,className:(0,j.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...c,children:[b,(0,d.jsx)(f.In,{asChild:!0,children:(0,d.jsx)(g.A,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=f.l9.displayName;let n=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.PP,{ref:c,className:(0,j.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(h.A,{className:"h-4 w-4"})}));n.displayName=f.PP.displayName;let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wn,{ref:c,className:(0,j.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(g.A,{className:"h-4 w-4"})}));o.displayName=f.wn.displayName;let p=e.forwardRef(({className:a,children:b,position:c="popper",...e},g)=>(0,d.jsx)(f.ZL,{children:(0,d.jsxs)(f.UC,{ref:g,className:(0,j.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...e,children:[(0,d.jsx)(n,{}),(0,d.jsx)(f.LM,{className:(0,j.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,d.jsx)(o,{})]})}));p.displayName=f.UC.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.JU,{ref:c,className:(0,j.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...b})).displayName=f.JU.displayName;let q=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.q7,{ref:e,className:(0,j.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(i.A,{className:"h-4 w-4"})})}),(0,d.jsx)(f.p4,{children:b})]}));q.displayName=f.q7.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wv,{ref:c,className:(0,j.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=f.wv.displayName},46283:(a,b,c)=>{"use strict";c.d(b,{A:()=>l,_:()=>k});var d=c(21124),e=c(38301),f=c(10994),g=c(63009),h=c(29303);let i=(0,f.x)("mudarib-modern"),j=(0,e.createContext)(void 0),k=({children:a})=>{let[b,c]=(0,e.useState)(!1),{user:k,loading:l,revalidateUser:m}=(0,g.A)(),n=(0,e.useMemo)(()=>k&&"role"in k&&k.preferences?.themeId?k.preferences.themeId:"mudarib-modern",[k]),o=(0,e.useMemo)(()=>l?i:(0,f.x)(n),[n,l]),p=(0,e.useCallback)(async a=>{if(!k||!("role"in k))return void console.warn("Cannot set theme, no authenticated user found.");c(!0);try{let b=k.preferences||{};await (0,h.T)(k.uid,{preferences:{...b,themeId:a}}),await m()}catch(a){throw console.error("Failed to save active theme to user profile",a),a}finally{c(!1)}},[k,m]),q=(0,e.useMemo)(()=>o?.config?.sidebar||{},[o]),r=(0,e.useMemo)(()=>o?.config?.card||{},[o]);return(0,d.jsx)(j.Provider,{value:{activeTheme:o,setActiveTheme:p,isSaving:b,sidebarSettings:q,cardSettings:r},children:a})},l=()=>{let a=(0,e.useContext)(j);if(void 0===a)throw Error("useThemeCustomization must be used within a ThemeCustomizationProvider");return a}},49845:(a,b,c)=>{"use strict";c.d(b,{A:()=>aa});var d=c(21124),e=c(38301),f=c.n(e),g=c(35284),h=c(40068),i=c(22741),j=c(90447),k=c(49113),l=c(31980),m=c(99546),n=c(50937),o=c(93758),p=c(45608),q=c(68254),r=c(37448),s=c(73887),t=c(13338),u=c(2747),v=c(74940),w=c(14270),x=c(40822),y=c(10656),z=c(49566),A=c(61603),B=c(51115),C=c(38692),D=c(33718),E=c(43215),F=c(77421),G=c(51886),H=c(83557),I=c(66782),J=c(27186),K=c(99651),L=c(85708);let M=(0,L.createServerReference)("40939e0ffddd5729906956a18bd5a10b991b0ccc8b",L.callServer,void 0,L.findSourceMapURL,"addClient");var N=c(65409),O=c(44943),P=c(72001),Q=c(68120),R=c(19581),S=c(42329),T=c(77837),U=c(1420),V=c(62186);let W=[{value:"text",label:"نص",icon:s.A},{value:"email",label:"بريد إلكتروني",icon:t.A},{value:"number",label:"رقم",icon:u.A},{value:"textarea",label:"مربع نص",icon:v.A},{value:"select",label:"قائمة منسدلة",icon:w.A}],X=({field:a,onFieldChange:b,onDelete:c,onSave:e})=>{let f=(c,d)=>{b((0,P.jM)(a,a=>{a[c]=d}))},h=(b,c,d)=>{f("options",(0,P.jM)(a.options||[],a=>{a[b][c]=d}))};return(0,d.jsx)(T.hl,{className:"w-80",children:(0,d.jsxs)("div",{className:"grid gap-4",children:[(0,d.jsx)("div",{className:"space-y-2",children:(0,d.jsxs)("h4",{className:"font-medium leading-none",children:["إعدادات الحقل: ",a.label]})}),(0,d.jsxs)("div",{className:"grid gap-4",children:[(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(Q.J,{htmlFor:`required-${a.id}`,className:"flex flex-row items-center gap-2 text-sm",children:"حقل مطلوب"}),(0,d.jsx)(U.d,{id:`required-${a.id}`,checked:a.required,onCheckedChange:a=>f("required",a)})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(Q.J,{htmlFor:`visible-${a.id}`,className:"flex flex-row items-center gap-2 text-sm",children:"حقل مرئي"}),(0,d.jsx)(U.d,{id:`visible-${a.id}`,checked:a.visible,onCheckedChange:a=>f("visible",a)})]})]}),(0,d.jsxs)("div",{className:"space-y-2 pt-3 border-t",children:[(0,d.jsx)("h5",{className:"font-semibold text-sm",children:"خصائص متقدمة"}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(Q.J,{children:"نوع الحقل"}),(0,d.jsxs)(p.l6,{value:a.type,onValueChange:a=>f("type",a),disabled:!a.deletable,children:[(0,d.jsx)(p.bq,{children:(0,d.jsx)(p.yv,{})}),(0,d.jsx)(p.gC,{children:W.map(a=>(0,d.jsx)(p.eb,{value:a.value,children:(0,d.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[a.label,(0,d.jsx)(a.icon,{className:"h-4 w-4"})]})},a.value))})]})]})]}),"select"===a.type&&(0,d.jsxs)("div",{className:"space-y-2 pt-3 border-t",children:[(0,d.jsx)("h5",{className:"font-semibold text-sm",children:"خيارات القائمة"}),(a.options||[]).map((b,c)=>(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(o.p,{placeholder:"النص الظاهر",value:b.label,onChange:a=>h(c,"label",a.target.value),className:"h-8"}),(0,d.jsx)(o.p,{placeholder:"القيمة",value:b.value,onChange:a=>h(c,"value",a.target.value),className:"h-8",disabled:!a.deletable&&!["paymentType","status","relationType"].includes(a.id)}),(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 text-destructive",onClick:()=>{f("options",(a.options||[]).filter((a,b)=>b!==c))},disabled:!a.deletable,children:(0,d.jsx)(x.A,{className:"h-4 w-4"})})]},c)),a.deletable&&(0,d.jsxs)(g.$,{variant:"outline",size:"sm",onClick:()=>{f("options",[...a.options||[],{value:`opt_${Date.now()}`,label:"خيار جديد"}])},children:[(0,d.jsx)(y.A,{className:"me-2 h-4 w-4"}),"إضافة خيار"]})]}),(0,d.jsxs)("div",{className:"pt-3 border-t space-y-3",children:[a.deletable&&(0,d.jsxs)(g.$,{variant:"destructive",size:"sm",onClick:c,className:"w-full",children:[(0,d.jsx)(x.A,{className:"me-2 h-4 w-4"})," حذف الحقل بشكل نهائي"]}),(0,d.jsxs)(g.$,{onClick:e,className:"w-full",children:[(0,d.jsx)(z.A,{className:"me-2 h-4 w-4"}),"حفظ إعدادات الحقل"]})]})]})]})})},Y=({fieldDef:a,isEditingLayout:b,onFieldChange:c,onDeleteField:e})=>{let{control:f,watch:h}=(0,l.xW)();h("type");let j=h("country"),k=[];if("select"===a.type)if("country"===a.id)k=R.A.map(a=>({value:a.name,label:a.name}));else if("province"===a.id){let a=R.A.find(a=>a.name===j);k=a?a.provinces.map(a=>({value:a.name,label:a.name})):[]}else k=a.options||[];let m="email"===a.type?t.A:"text"===a.type&&a.id.includes("phone")?A.A:"select"===a.type&&a.id.includes("type")?B.A:a.id.includes("name")?C.A:s.A;return(0,d.jsx)(J.zB,{control:f,name:a.id,render:({field:f})=>(0,d.jsxs)(J.eI,{className:"relative group",children:[b&&(0,d.jsxs)("div",{className:"absolute top-1 left-1 z-10 flex items-center gap-1",children:[(0,d.jsxs)(T.AM,{children:[(0,d.jsx)(T.Wv,{asChild:!0,children:(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"h-6 w-6",children:(0,d.jsx)(i.A,{className:"h-4 w-4"})})}),(0,d.jsx)(X,{field:a,onFieldChange:c,onDelete:e,onSave:()=>{}})]}),(0,d.jsx)(D.A,{className:"h-5 w-5 text-muted-foreground cursor-grab"})]}),(0,d.jsxs)(J.lR,{className:"flex items-center gap-1",children:[a.label,a.required&&(0,d.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,d.jsx)(J.MJ,{children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(m,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),"select"===a.type?(0,d.jsxs)(p.l6,{onValueChange:f.onChange,value:f.value||"",disabled:"province"===f.id&&!j,children:[(0,d.jsx)(p.bq,{className:"pr-10",children:(0,d.jsx)(p.yv,{placeholder:a.placeholder})}),(0,d.jsx)(p.gC,{children:k.map(a=>(0,d.jsx)(p.eb,{value:a.value,children:a.label},a.value))})]}):"textarea"===a.type?(0,d.jsx)(q.T,{placeholder:a.placeholder,...f,value:f.value||"",className:"pr-10"}):(0,d.jsx)(o.p,{placeholder:a.placeholder,type:a.type,...f,value:f.value||"",className:"pr-10"})]})}),(0,d.jsx)(J.C5,{})]})},a.id)};function Z({isEditing:a=!1,initialData:b,relationSections:c,onSuccess:h,currentStep:i=0,setCurrentStep:j=()=>{},isEditingLayout:o=!1}){let{toast:p}=(0,r.dj)(),[q,s]=(0,e.useState)(c||[]),t=f().useMemo(()=>((a,b)=>{if(!a||!Array.isArray(a)||0===a.length)return m.Ik({});let c=a.flatMap(a=>a.fields).reduce((a,b)=>{let c=m.bz();switch(b.type){case"email":c=m.Yj().email({message:"بريد إلكتروني غير صحيح"});break;case"number":c=m.au.number();break;default:c=m.Yj()}return b.required?["text","textarea","select"].includes(b.type)?c=c.min(1,{message:"هذا الحقل مطلوب"}):"number"===b.type&&(c=c.min(1e-5,"هذا الحقل مطلوب")):c=c.optional().or(m.eu("")),a[b.id]=c,a},{});return m.Ik(c)})(q,0),[q,a]);f().useMemo(()=>q?.flatMap(a=>a.fields)||[],[q]);let u=(0,l.mN)({resolver:(0,n.u)(t),values:a?b:{type:"individual",status:"active"}}),{formState:{isSubmitting:v},control:w,watch:x,trigger:B}=u,D=x("type"),J=(a,b,c)=>{s((0,P.jM)(d=>{d[a].fields[b]=c}))},L=(a,b)=>{s((0,P.jM)(c=>{c[a].fields.splice(b,1)}))},R=a=>{let b=`custom_${Date.now()}`;s((0,P.jM)(c=>{c[a].fields.push({id:b,label:"حقل جديد",type:"text",required:!1,visible:!0,deletable:!0,placeholder:"",appliesTo:["individual","company"],aliases:[],options:[]})}))},T=async()=>{W(!0);let a=await (0,N.X)({relationSections:q});a.success?p({title:"تم حفظ الواجهة بنجاح"}):p({title:"خطأ",description:a.error,variant:"destructive"}),W(!1)},[U,W]=f().useState(!1),X=(0,e.useCallback)((a,b)=>a&&a.fields&&Array.isArray(a.fields)?a.fields.filter(a=>"type"!==a.id&&(!!o||!!a.visible)&&(!b||!a.appliesTo||!(a.appliesTo.length>0)||a.appliesTo.includes(b))):[],[o]),Z=f().useMemo(()=>{let a=q||[];return Array.isArray(a)?[a.find(a=>"sec_basic"===a.id),{id:"sec_other_details",title:"باقي التفاصيل",description:"معلومات الاتصال، تفاصيل الشركة، وأي بيانات أخرى.",deletable:!1,fields:a.filter(a=>"sec_basic"!==a.id).flatMap(a=>a.fields)}].filter(Boolean):[]},[q]),$=Z[i],_=async a=>{a.preventDefault();let b=X($,D).map(a=>a.id);await B(b)&&j(a=>a+1)},aa=async c=>{let d=p({title:`جاري ${a?"تحديث":"إضافة"} الحساب...`,description:"سيتم إغلاق النافذة."});try{let e;if(a&&b){if(!(e=await (0,K.z)(b.id,c)).success)throw Error(e.error);e.updatedClient&&h(e.updatedClient)}else{if(!(e=await M(c)).success)throw Error(e.error);e.client&&h(e.client)}d.update({id:d.id,title:`تم ${a?"تحديث":"إضافة"} الحساب بنجاح`,description:""})}catch(a){d.update({id:d.id,title:"خطأ",description:a.message,variant:"destructive"})}},ab=(0,e.useCallback)((a,b)=>{if(0===X(a,D).length&&!o)return null;let c="sec_basic"===a.id?C.A:"sec_contact"===a.id?A.A:"sec_company"===a.id?E.A:"sec_login"===a.id?F.A:G.A;return(0,d.jsxs)(V.Zp,{className:(0,O.cn)("shadow-sm",o?"border-primary border-2":""),children:[(0,d.jsxs)(V.aR,{children:[(0,d.jsxs)(V.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(c,{className:"h-5 w-5 text-primary"}),a.title]}),a.description&&(0,d.jsx)(V.BT,{children:a.description})]}),(0,d.jsxs)(V.Wu,{className:"space-y-4",children:[(0,d.jsx)("div",{className:(0,O.cn)("grid grid-cols-1 gap-x-4 gap-y-5",o?"":"sm:grid-cols-2"),children:X(a,D).map((a,c)=>(0,d.jsx)("div",{className:(0,O.cn)(("textarea"===a.type||["name"].includes(a.id))&&"md:col-span-2"),children:(0,d.jsx)(Y,{fieldDef:a,isEditingLayout:o,onFieldChange:a=>J(b,c,a),onDeleteField:()=>L(b,c)})},a.id))}),o&&a.deletable&&(0,d.jsxs)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>R(b),children:[(0,d.jsx)(y.A,{className:"me-2 h-4 w-4"}),"إضافة حقل جديد لهذا القسم"]})]})]},a.id)},[q,X,u,D,o,J,L,R]);return o?(0,d.jsx)(l.Op,{...u,children:(0,d.jsxs)("div",{className:"p-6 space-y-4",children:[q.map((a,b)=>ab(a,b)),(0,d.jsx)("div",{className:"flex justify-end pt-4 border-t",children:(0,d.jsxs)(g.$,{size:"lg",onClick:T,disabled:U,children:[U&&(0,d.jsx)(k.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(z.A,{className:"me-2 h-4 w-4"}),"حفظ التعديلات في الواجهة"]})})]})}):a?(0,d.jsx)(l.Op,{...u,children:(0,d.jsxs)("form",{onSubmit:u.handleSubmit(aa),className:"space-y-6 p-6",children:[q.map((a,b)=>ab(a,b)),(0,d.jsx)("div",{className:"flex justify-end pt-4",children:(0,d.jsxs)(g.$,{type:"submit",disabled:v,children:[v?(0,d.jsx)(k.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,d.jsx)(z.A,{className:"me-2 h-4 w-4"}),"حفظ التعديلات"]})})]})}):(0,d.jsx)(l.Op,{...u,children:(0,d.jsxs)("form",{onSubmit:u.handleSubmit(aa),className:"flex flex-col h-full",children:[(0,d.jsx)("div",{className:"p-6",children:(0,d.jsx)(S.C1,{activeStep:i,children:Z.map((a,b)=>(0,d.jsx)(S.LB,{label:a.title,isCompleted:i>b,isActive:i===b,isLast:b===Z.length-1},a.id))})}),(0,d.jsxs)("div",{className:"px-6 pb-6 flex-grow overflow-y-auto",children:[0===i&&$&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(Q.J,{children:"نوع الجهة"}),(0,d.jsx)(l.xI,{name:"type",control:u.control,render:({field:a})=>(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,d.jsxs)(g.$,{type:"button",variant:"individual"===a.value?"default":"outline",onClick:()=>a.onChange("individual"),className:"h-20 flex-col gap-2",children:[(0,d.jsx)(C.A,{className:"h-8 w-8"}),(0,d.jsx)("span",{children:"فرد"})]}),(0,d.jsxs)(g.$,{type:"button",variant:"company"===a.value?"default":"outline",onClick:()=>a.onChange("company"),className:"h-20 flex-col gap-2",children:[(0,d.jsx)(E.A,{className:"h-8 w-8"}),(0,d.jsx)("span",{children:"شركة"})]})]})})]}),(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-5",children:X($,D).map((a,b)=>(0,d.jsx)("div",{className:(0,O.cn)(["name"].includes(a.id)&&"sm:col-span-2"),children:(0,d.jsx)(Y,{fieldDef:a,isEditingLayout:!1,onFieldChange:a=>J(0,b,a),onDeleteField:()=>L(0,b)})},a.id))})]}),1===i&&(0,d.jsx)("div",{className:"space-y-6",children:q.filter(a=>"sec_basic"!==a.id).map((a,b)=>ab(a,b+1))})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center gap-2 p-4 border-t sticky bottom-0 bg-background mt-auto",children:[(0,d.jsxs)(g.$,{type:"button",variant:"outline",onClick:()=>j(a=>a-1),disabled:0===i,children:[(0,d.jsx)(H.A,{className:"me-2 h-4 w-4"})," السابق"]}),i<Z.length-1?(0,d.jsxs)(g.$,{type:"button",onClick:_,disabled:v,children:["التالي ",(0,d.jsx)(I.A,{className:"ms-2 h-4 w-4"})]}):(0,d.jsxs)(g.$,{type:"submit",disabled:v,children:[v?(0,d.jsx)(k.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,d.jsx)(z.A,{className:"me-2 h-4 w-4"}),a?"حفظ التعديلات":"حفظ"]})]})]})})}var $=c(42378),_=c(97802);function aa({onClientAdded:a,onClientUpdated:b,isEditing:c,initialData:l,children:m}){let[n,o]=(0,e.useState)(!1);(0,$.useRouter)();let[p,q]=(0,e.useState)({width:"850px",height:"90vh"}),[r,s]=(0,e.useState)(0),{data:t,loaded:u,fetchData:v,refreshData:w}=(0,_.Z)(),[x,y]=(0,e.useState)(!1),{relationSections:z}=f().useMemo(()=>({relationSections:t?.settings?.relationSections||[]}),[t]);return(0,d.jsxs)(h.lG,{open:n,onOpenChange:a=>{o(a),a?s(0):y(!1)},children:[(0,d.jsx)(h.zM,{asChild:!0,children:m}),(0,d.jsxs)(h.Cf,{showCloseButton:!1,className:"p-0 max-h-[90vh] flex flex-col",style:{maxWidth:p.width,width:"95vw",height:p.height},children:[(0,d.jsxs)(h.c7,{className:"bg-primary text-primary-foreground p-3 rounded-t-lg flex flex-row items-center justify-between sticky top-0 z-10 border-b",children:[(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)(g.$,{onClick:()=>y(a=>!a),variant:x?"secondary":"ghost",size:"icon",className:"text-white hover:bg-white/20 h-8 w-8",children:(0,d.jsx)(i.A,{className:"h-5 w-5"})})}),(0,d.jsx)("div",{className:"text-right",children:(0,d.jsx)(h.L3,{className:"text-white",children:c?"تعديل بيانات العلاقة":"إضافة علاقة جديدة"})}),(0,d.jsx)(h.HM,{asChild:!0,children:(0,d.jsx)(g.$,{variant:"ghost",size:"icon",className:"text-primary-foreground hover:bg-white/20 h-7 w-7 rounded-full",children:(0,d.jsx)(j.A,{className:"h-4 w-4"})})})]}),(0,d.jsx)("div",{className:"flex-grow overflow-y-auto",children:u?(0,d.jsx)(Z,{isEditing:c,initialData:l,relationSections:z,onSuccess:d=>{c?b&&b(d):a&&a(d),w(),o(!1)},currentStep:r,setCurrentStep:s,isEditingLayout:x}):(0,d.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,d.jsx)(k.A,{className:"h-8 w-8 animate-spin"})})})]})]})}},49888:(a,b,c)=>{"use strict";c.d(b,{Jj:()=>d});let d={"dashboard:read":"عرض لوحة التحكم","bookings:read":"عرض حجوزات الطيران","bookings:create":"إنشاء حجوزات الطيران","bookings:update":"تعديل حجوزات الطيران","bookings:delete":"حذف حجوزات الطيران","bookings:operations":"إجراء عمليات (استرجاع، تغيير)","visas:read":"عرض طلبات الفيزا","visas:create":"إنشاء طلبات فيزا","visas:update":"تعديل طلبات الفيزا","visas:delete":"حذف طلبات الفيزا","subscriptions:read":"عرض الاشتراكات","subscriptions:create":"إنشاء الاشتراكات","subscriptions:update":"تعديل الاشتراكات","subscriptions:delete":"حذف الاشتراكات","subscriptions:payments":"إدارة دفعات الأقساط","vouchers:read":"عرض السندات","vouchers:create":"إنشاء السندات","vouchers:update":"تعديل السندات","vouchers:delete":"حذف السندات","remittances:read":"عرض الحوالات","remittances:create":"إنشاء الحوالات","remittances:audit":"تدقيق الحوالات","remittances:receive":"استلام الحوالات",segment_access:"الوصول إلى ميزة السكمنت","segments:read":"عرض السكمنت","segments:create":"إنشاء سجلات سكمنت","segments:update":"تعديل سجلات سكمنت","segments:delete":"حذف سجلات سكمنت","relations:read":"عرض العملاء والموردين","relations:create":"إنشاء العملاء والموردين","relations:update":"تعديل العملاء والموردين","relations:delete":"حذف العملاء والموردين","relations:credentials":"إدارة بيانات الدخول للعملاء","users:read":"عرض المستخدمين والأدوار","users:create":"إنشاء المستخدمين والأدوار","users:update":"تعديل المستخدمين والأدوار","users:delete":"حذف المستخدمين والأدوار","users:permissions":"إدارة صلاحيات الأدوار","hr:read":"عرض بيانات الموارد البشرية","hr:update":"تعديل بيانات الرواتب والأرباح","reports:read:all":"عرض جميع التقارير","reports:account_statement":"عرض كشف الحساب","reports:debts":"عرض تقرير الأرصدة","reports:profits":"عرض تقارير الأرباح","reports:flight_analysis":"عرض تحليل الرحلات","settings:read":"عرض الإعدادات","settings:update":"تعديل الإعدادات","settings:finance:manage":"إدارة مركز التحكم المالي","system:audit_log:read":"عرض سجل النشاطات","system:error_log:read":"عرض سجل الأخطاء","system:data_audit:run":"تشغيل فحص البيانات",public:"صلاحية عامة"}},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>i,metadata:()=>h});var d=c(75338),e=c(78333),f=c.n(e),g=c(17218);c(61135),c(43028),c(12832);let h={title:"Mudarib Accounting",description:"نظام محاسبي متكامل لشركات السفر والسياحة"};function i({children:a}){return(0,d.jsxs)("html",{lang:"ar",dir:"rtl",suppressHydrationWarning:!0,"data-scroll-behavior":"smooth",children:[(0,d.jsx)("head",{children:(0,d.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"})}),(0,d.jsx)("body",{className:f().variable,children:(0,d.jsx)(g.Providers,{children:a})})]})}},54756:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Xx:()=>o,_u:()=>q,mt:()=>s});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(62641),i=c(58749),j=c(19769),k=c(46204),l=c(40410),m=a([f,h,i]);async function n(){try{return await new Promise(a=>setTimeout(a,500)),{service:"Google Drive",success:!0,message:"الاتصال ناجح"}}catch(a){return{service:"Google Drive",success:!1,message:`فشل الاتصال: ${a.message}`}}}[f,h,i]=m.then?(await m)():m;let r="app_settings",s=(0,k.cache)(async()=>{let a=await (0,f.Lf)();if(!a)return console.warn("Database not available, returning default settings."),j.xd;try{let b=await a.collection("settings").doc(r).get();if(!b.exists){console.log("No settings found in database, seeding with default settings.");let b={...j.xd,databaseStatus:{isDatabaseConnected:!0}};return await a.collection("settings").doc(r).set(b),b}let c=b.data();if(c.databaseStatus?.isDatabaseConnected!==!0)return{...c,databaseStatus:{isDatabaseConnected:!0}};return c}catch(a){return console.error("Error getting settings:",String(a)),{...j.xd,databaseStatus:{isDatabaseConnected:!0}}}});async function o(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};let d=b.collection("settings").doc(r);try{let b={...await s(),...a};return await d.set(b,{merge:!0}),await (0,i.iL)({userId:c.uid,userName:c.name,action:"UPDATE",targetType:"SETTINGS",description:`قام بتحديث إعدادات النظام.`}),(0,g.revalidatePath)("/settings","layout"),(0,g.revalidatePath)("/","layout"),{success:!0}}catch(a){return console.error("Error updating settings:",String(a)),{success:!1,error:"Failed to update settings."}}}async function p(){let a=await (0,f.Lf)();if(!a)return{service:"Firebase",success:!1,message:"فشل تهيئة Firebase Admin SDK. تحقق من متغيرات البيئة."};try{return await a.collection("health_checks").limit(1).get(),{service:"Firebase",success:!0,message:`الاتصال ناجح`}}catch(b){console.error("Firebase connection test failed:",String(b));let a=`فشل الاتصال: ${b.message}`;return 7===b.code||"string"==typeof b.message&&(b.message.includes("permission-denied")||b.message.includes("PERMISSION_DENIED"))?a="فشل الاتصال: تم رفض الإذن. تحقق من صلاحيات حساب الخدمة (IAM) في Google Cloud Console.":"string"==typeof b.message&&b.message.includes("Could not refresh access token")?a="فشل في المصادقة. يرجى التحقق من صحة بيانات اعتماد حساب الخدمة (Service Account) المضمنة.":"string"==typeof b.message&&b.message.includes("Unable to detect a Project Id")&&(a="فشل في المصادقة: لم يتم العثور على معرف المشروع. تحقق من أن ملف الخدمة يحتوي على `project_id`."),{service:"Firebase",success:!1,message:a}}}async function q(){return await Promise.all([p(),n()])}(0,l.D)([s,o,q]),(0,e.A)(s,"7fe3cedf8b5b39f6ca6561f08402f1ad7a82ecff97",null),(0,e.A)(o,"40bd3493b6cd183a3f75aa7b2dffe9f325b07a2b9d",null),(0,e.A)(q,"0004c295195cb02aa74b7e03b9ab47835262f651f3",null),d()}catch(a){d(a)}})},54864:(a,b,c)=>{"use strict";c.d(b,{m:()=>e});var d=c(85708);let e=(0,d.createServerReference)("7fe3cedf8b5b39f6ca6561f08402f1ad7a82ecff97",d.callServer,void 0,d.findSourceMapURL,"getSettings")},58749:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{iL:()=>j});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(40410),i=a([f]);f=(i.then?(await i)():i)[0];let k="audit_logs",l=a=>{let b=a.data();if(!b)return null;let c={...b,id:a.id};for(let a in c)c[a]&&"function"==typeof c[a].toDate&&(c[a]=c[a].toDate().toISOString());return c};async function j(a){let b=await (0,f.Lf)();if(!b)return void console.error("Audit Log failed: Database not available.");try{await b.collection(k).add({...a,level:a.level||"info",createdAt:new Date().toISOString()}),(0,g.revalidatePath)("/system/activity-log"),(0,g.revalidatePath)("/system/error-log")}catch(a){console.error("Error creating audit log: ",String(a))}}let m=async()=>{let a=await (0,f.Lf)();if(!a)return[];try{let b=await a.collection(k).orderBy("createdAt","desc").limit(200).get();if(b.empty)return[];return b.docs.map(a=>l(a)).filter(a=>"error"!==a.level)}catch(a){throw console.error("Error getting audit logs: ",String(a)),Error("Failed to fetch audit logs.")}},n=async()=>{let a=await (0,f.Lf)();if(!a)return[];try{let b=await a.collection(k).orderBy("createdAt","desc").limit(200).get();if(b.empty)return[];return b.docs.map(a=>l(a)).filter(a=>"error"===a.level)}catch(a){throw console.error("Error getting error logs: ",String(a)),Error("Failed to fetch error logs.")}};(0,h.D)([j,m,n]),(0,e.A)(j,"40ae79a531e9ac50ecc04279061a2192af6e60d6f4",null),(0,e.A)(m,"7fd691cbe2382ade3c2dc739956026d2c3c806df06",null),(0,e.A)(n,"7f06d4b21a91bbe15e581c350a136426169075ee5f",null),d()}catch(a){d(a)}})},60977:(a,b,c)=>{"use strict";c.d(b,{r:()=>e});var d=c(85708);let e=(0,d.createServerReference)("7fff34be9ad53d22bcedbe289fd19cffbcbb61a920",d.callServer,void 0,d.findSourceMapURL,"getExchanges")},61135:()=>{},62186:(a,b,c)=>{"use strict";c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h,wL:()=>l});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-4 sm:p-6 text-right",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-lg sm:text-xl font-bold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-4 sm:p-6 pt-0",a),...b}));k.displayName="CardContent";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-4 sm:p-6 pt-0",a),...b}));l.displayName="CardFooter"},62641:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{$T:()=>t,EZ:()=>s,HW:()=>l,Lx:()=>o,S:()=>p,Sm:()=>n,X7:()=>m,ht:()=>u,kl:()=>r,y4:()=>q});var e=c(91488);c(27806);var f=c(80446),g=c(70495),h=c(90521),i=c(49888),j=c(40410),k=a([f,h]);async function l(){let a=await t();return!a||"isClient"in a?{user:null,hasPermission:()=>!1}:{user:a,hasPermission:b=>"admin"===a.role||(a.permissions?.includes(b)??!1)}}[f,h]=k.then?(await k)():k;let r=async a=>{let b=await (0,f.Lf)();if(!b)return null;try{let c=await b.collection("users").doc(a).get();if(!c.exists)return null;let d=c.data(),e=await (0,h.O0)(),f=[];if(d.role)if("admin"===d.role)f=Object.keys(i.Jj);else{let a=e.find(a=>a.id===d.role);a&&(f=a.permissions||[])}return{...d,uid:a,permissions:[...new Set(f)]}}catch(a){return console.error("Error fetching user by ID:",String(a)),null}},s=async a=>{let b=await (0,f.Lf)();if(!b)return null;try{let c=await b.collection("clients").doc(a).get();if(!c.exists)return null;let d=c.data(),e=JSON.parse(JSON.stringify(d,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b));return{id:c.id,...e}}catch(b){return console.error(`Error getting client by ID ${a}:`,String(b)),null}},t=async()=>{let a=(0,g.UL)().get("session");if(!a?.value)return null;try{let b=await (0,f.iS)(),c=await b.verifySessionCookie(a.value,!0),d=await r(c.uid);if(d)return d;if(c.isClient){let a=await s(c.uid);if(a)return{...a,isClient:!0}}return console.warn(`Session cookie for UID ${c.uid} is valid, but user not found in Firestore. Logging out.`),(0,g.UL)().delete("session"),null}catch(a){return console.warn("Session verification failed, session is likely invalid. Clearing cookie.",String(a)),(0,g.UL)().delete("session"),null}};async function m(a){let b=await (0,f.iS)();try{let c=await b.verifyIdToken(a,!0),d=await r(c.uid);if(!d)throw Error("User not found in database.");c.role!==d?.role&&await b.setCustomUserClaims(c.uid,{role:d?.role||"viewer"});let e=await b.createSessionCookie(a,{expiresIn:6048e5});return(0,g.UL)().set("session",e,{maxAge:604800,httpOnly:!0,secure:!0,path:"/",sameSite:"none"}),{success:!0,user:d}}catch(a){return console.error("Error creating session cookie:",String(a)),{success:!1,error:a.message}}}async function n(a){(await (0,g.UL)()).set("session",JSON.stringify(a),{httpOnly:!0,secure:!0,maxAge:604800,path:"/",sameSite:"lax"})}let u=async a=>{let b=await (0,f.Lf)();if(!b)return null;try{let c=b.collection("users"),d=await c.where("email","==",a).limit(1).get();if(d.empty)return null;let e=d.docs[0];return{...e.data(),uid:e.id}}catch(a){return console.error("Error getting user by email:",String(a)),null}};async function o(a){return await m(a)}async function p(a){let b=await (0,f.iS)();try{let c=await b.createCustomToken(a);return{success:!0,customToken:c}}catch(a){return console.error("Error creating custom token for user:",String(a)),{success:!1,error:a.message}}}async function q(){(await (0,g.UL)()).delete("session")}(0,j.D)([l,r,s,t,m,n,u,o,p,q]),(0,e.A)(l,"00d790a9c67325f46e1dda5ba33e59ecfd95062466",null),(0,e.A)(r,"7f33ef79ae72de1c2db1340cf81f1c0a0a525a8033",null),(0,e.A)(s,"7f7cc5ac28f76953e580388c96325185bdb57f592c",null),(0,e.A)(t,"7faf63d9d8686c0ff053833c82fd60b3e9c6fa0bff",null),(0,e.A)(m,"408d4523c5fa8dbd353900a15d896d0ebee083358b",null),(0,e.A)(n,"40213622e57351942781ff52345df063ded4056884",null),(0,e.A)(u,"7f33fcd02c8b1dfc136d21fd7035ce40fe2d48b135",null),(0,e.A)(o,"40fc6757a7ed8ba6cf86a7bf30e6bf0934f153f439",null),(0,e.A)(p,"4085aac590f12a4a641b5bc7fff47d5353af49510e",null),(0,e.A)(q,"00454095f373f8afcf3cd8b88a3e9643ba6181edb6",null),d()}catch(a){d(a)}})},62889:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},63009:(a,b,c)=>{"use strict";c.d(b,{O:()=>r,A:()=>s});var d=c(21124),e=c(38301),f=c.n(e),g=c(68618);c(45937);var h=c(13737),i=c(85708);let j=(0,i.createServerReference)("7faf63d9d8686c0ff053833c82fd60b3e9c6fa0bff",i.callServer,void 0,i.findSourceMapURL,"getCurrentUserFromSession");var k=c(8823);let l=(0,i.createServerReference)("4085aac590f12a4a641b5bc7fff47d5353af49510e",i.callServer,void 0,i.findSourceMapURL,"signInAsUser"),m=(0,i.createServerReference)("00454095f373f8afcf3cd8b88a3e9643ba6181edb6",i.callServer,void 0,i.findSourceMapURL,"logoutUser");var n=c(42378),o=c(22042),p=c(37448);let q=(0,e.createContext)(void 0);function r({children:a}){let[b,c]=(0,e.useState)(null),[i,r]=(0,e.useState)(!0),[s,t]=(0,e.useState)("");(0,n.useRouter)(),(0,n.usePathname)();let[u,v]=(0,e.useState)(0),{toast:w}=(0,p.dj)();f().useRef(Date.now());let x=(0,e.useCallback)(async()=>{try{let a=await j();c(a)}catch(a){console.error("Failed to revalidate user session:",a),c(null)}},[]),y=async(a,b)=>{r(!0),t("");try{let d=await (0,g.x9)(h.j,a,b),e=await (0,g.p9)(d.user,!0),f=await (0,k.L)(e);if(f.error||!f.success||!f.user)throw Error(f.error||"Failed to create session or retrieve user data.");return c(f.user),{success:!0}}catch(b){console.error("Sign in failed:",b);let a="An unexpected error occurred.";if(b.code)switch(b.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":a="البريد الإلكتروني أو كلمة المرور غير صحيحة.";break;case"auth/invalid-email":a="صيغة البريد الإلكتروني غير صحيحة.";break;default:a=b.message}else a=b.message;return t(a),{success:!1,error:a}}finally{r(!1)}},z=async a=>{try{let{success:b,customToken:d,error:e}=await l(a);if(b&&d){await (0,g.p)(h.j,d);let a=await (0,g.p9)(h.j.currentUser,!0),b=await (0,k.L)(a);if(b.error||!b.user)throw Error(b.error||"Failed to establish session for user.");c(b.user)}else throw Error(e||"Failed to get custom token.")}catch(b){console.error(`Sign in as user ${a} failed:`,b)}},A=async()=>{r(!0),await (0,g.CI)(h.j),await m(),c(null),window.location.href="/"};return(0,d.jsx)(q.Provider,{value:{user:b,loading:i,signIn:y,signOut:A,hasPermission:a=>!!b&&(!("isClient"in b)||!b.isClient)&&(0,o._m)(b,a),signInAsUser:z,revalidateUser:x,unreadChatCount:u,error:s},children:a})}function s(){let a=(0,e.useContext)(q);if(void 0===a)throw Error("useAuth must be used within an AuthProvider");return a}},64772:(a,b,c)=>{"use strict";c.d(b,{Fc:()=>i,TN:()=>k,XL:()=>j});var d=c(21124),e=c(38301),f=c(26691),g=c(44943);let h=(0,f.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=e.forwardRef(({className:a,variant:b,...c},e)=>(0,d.jsx)("div",{ref:e,role:"alert",className:(0,g.cn)(h({variant:b}),a),...c}));i.displayName="Alert";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h5",{ref:c,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",a),...b}));j.displayName="AlertTitle";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",a),...b}));k.displayName="AlertDescription"},65409:(a,b,c)=>{"use strict";c.d(b,{X:()=>e});var d=c(85708);let e=(0,d.createServerReference)("40bd3493b6cd183a3f75aa7b2dffe9f325b07a2b9d",d.callServer,void 0,d.findSourceMapURL,"updateSettings")},68120:(a,b,c)=>{"use strict";c.d(b,{J:()=>j});var d=c(21124),e=c(38301),f=c(46029),g=c(26691),h=c(44943);let i=(0,g.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.b,{ref:c,className:(0,h.cn)(i(),a),...b}));j.displayName=f.b.displayName},68254:(a,b,c)=>{"use strict";c.d(b,{T:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:c,...b}));g.displayName="Textarea"},68464:(a,b,c)=>{"use strict";c.d(b,{R:()=>d});let d={projectId:"fly4all-78277122-3cbd0",privateKey:"-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC62eIaOJqkBGL/\nIvxqOzN8/etbwsVKx8vNMRXVQ4RbS2/jB2JBJhonNWHf0Lll36QFnnfM0v1sGzz3\nck3eCAxT4snkbI0nb71u6tLff1YSur7p7GmCOeq1LKsc6uI5sFC3G0PJLZFYj2hG\n0djgQobNoVmLFfi9m1DhReDSFvk1PpJt1hxMhKKq11KR9ER90IUE2L6vuDR0Fa1Z\n9Y72htITxAq7Wd9zAlwlt7vcK5cQAbLBYrQVqPDrrmwNS5JPyDLhiEY6fbGeyiFE\nXdFNhktEsazoFN6w/V5NQ/aJH04fn3V36lBdc9sO7+wRufWRBaeoBs1FurPhpY1q\nxKorBLllAgMBAAECggEAFjzZrby4XNZf0NUhXOREVbcjpHVbBTIfpYFWw52oOjRR\ncd/eV/oYqTtvdVNySTdTXk7Um7YtrojUWe/K6CaljvNCC3NG3l9sWG/OnoZZYFvE\n3nLCQNszPZI+IDAtMefzx0MRr3cCohtZMfqGGPSZ9g2iqky4YJqERvdJ0T8mNCmU\n8GB6+qoKUGMt2O5DzVO250CGgIcgfqFd1dqvC+8PD3S2FL1dqwEgxpHeXhg+7NUU\n78+SmNRxcCTdqlgx5V9ihqgGaajVHWmGEMfDS+XatG+BAoc+Fi/ubOHPXH9Iniwd\njJcJ9CaSyZPFz0N+sY5uFB/wk2cYIKCdjzHTrJPzmQKBgQDgm8UI7Q3GScdbv29p\nQX++BOzqJKMiO7d0nOsW/7AobFVsSpXTsU0RovAkCtYY+P67qxQDwK3RSDs36YQE\nUyRwJhHnzJOKf5zj2nVFKgHgSSJdZEolMTM1KVicESDer6knsT7EN8M+iVGXl0JO\nz277bJ5hhNMkPnB1e7dOh6zq+QKBgQDU9zLg30dvNXNwSHv0QDZqADomi9U9nkZ+\nJhgJDmi+VMUxWfb61U0W/azewShL7YIsOHdTLensrAPBj5xzuB2OftKnEuaO3Nsv\nzJeQ3jOM5wXnqHpl9EXYVvlJTzM7tCyRJuiDFyhBmezCxikLjsjxWjwlcEGhc84Z\n+7E1IAUQzQKBgBVL78TG5VV1zWdPoXqzcS9NPEF/M9CdJOnzrv7BQ6yxiO/5qncm\nCo6vimGAfYhko5KbyAwLCvAbDzJf+9qFH6FamrwF07+AFhosro3eS8s+Y/nC9pzM\nK3TQ9Mvne9xhf4J59d+ZAfQ+BPSArRLX7Ef+po3MkFCRcwxQrLLPfn/RAoGBAL1f\nuBF42sfMSwOsoPTYaMqnuw3tyEhLxzmD3FmpQ4EEVnmFG3d/V1a7aw6FyrSB1gBG\nke0YZew8JfboImJQdY/xvJYu23Bsekgt8RU0UbjY8kpGadjhd35iELicwd00YXEN\nnTJ81CJJotysY3FQneTorZVJFkNgfARk6PZpq7d9AoGBAJVxFwblg6SQ+QZMUqaU\n5dXAESNOHv08DkYd0o/LmwfX1/odY9VwkR0unwMY3NncAWVSNh7u/C3DjLciaHzJ\nJr2o/GSZ2p1HxUsUa0aqN/q4BFTkO7ryFeCFcN3AO6hfgzKnoFUFYBD4iSHPkgX/\nfrErRvbecpYKP5V4y0awUggt\n-----END PRIVATE KEY-----\n".replace(/\\n/g,"\n"),clientEmail:"firebase-adminsdk-fbsvc@fly4all-78277122-3cbd0.iam.gserviceaccount.com"}},75117:(a,b,c)=>{"use strict";c.d(b,{A:()=>G});var d=c(21124),e=c(38301),f=c(35284),g=c(68120),h=c(68254),i=c(45608),j=c(98341),k=c(38692),l=c(11943),m=c(54163),n=c(49113),o=c(49566),p=c(99546),q=c(31980),r=c(50937),s=c(37448),t=c(77837),u=c(27410),v=c(63822),w=c(44943),x=c(40068),y=c(63009),z=c(85708);let A=(0,z.createServerReference)("4013135d45b93942093eced825516b1e20941831b7",z.callServer,void 0,z.findSourceMapURL,"createExpenseVoucher");var B=c(92351),C=c(25456),D=c(93758);let E=p.Ik({date:p.p6({required_error:"التاريخ مطلوب"}),expenseType:p.Yj().min(1,"نوع المصروف مطلوب"),amount:p.Yj().or(p.ai()).transform(a=>Number(String(a).replace(/,/g,""))).refine(a=>a>0,{message:"المبلغ يجب أن يكون أكبر من صفر"}),currency:p.k5(["USD","IQD"]),payee:p.Yj().optional(),boxId:p.Yj().min(1,"الصندوق مطلوب"),notes:p.Yj().optional(),exchangeRate:p.au.number().optional(),attachments:p.bz().optional()}),F=({currency:a,className:b,...c})=>(0,d.jsx)(C.O,{currency:a,className:(0,w.cn)("text-right",b),currencyClassName:(0,w.cn)("USD"===a?"bg-accent text-accent-foreground":"bg-primary text-primary-foreground"),...c});function G({boxes:a,onVoucherAdded:b,selectedCurrency:c,onVoucherUpdated:p,isEditing:z,initialData:C}){let{toast:G}=(0,s.dj)(),[H,I]=(0,e.useState)(!1),{user:J}=(0,y.A)(),{control:K,handleSubmit:L,setValue:M,register:N,formState:{errors:O,isSubmitting:P},reset:Q}=(0,q.mN)({resolver:(0,r.u)(E),defaultValues:z?C:{date:new Date,currency:c,amount:0,notes:"",payee:"",boxId:J&&"role"in J?J.boxId:""}}),R=async a=>{try{if(z&&C?.id){let b=await (0,B.o)(C.id,{...a,date:a.date.toISOString()});b.success?(G({title:"تم تحديث السند بنجاح"}),p&&p({})):G({title:"خطأ في التحديث",description:b.error,variant:"destructive"})}else{let c=await A({date:(0,v.GP)(a.date,"yyyy-MM-dd"),expenseType:a.expenseType,amount:a.amount,currency:a.currency,boxId:a.boxId,notes:a.notes,payee:a.payee,exchangeRate:a.exchangeRate});if(c.success)G({title:"تم تسجيل المصروف بنجاح"}),b&&b({}),Q();else throw Error(c.error)}}catch(a){G({title:"حدث خطأ",description:a.message,variant:"destructive"})}};return(0,d.jsxs)("form",{onSubmit:L(R),className:"space-y-4",children:[(0,d.jsx)("div",{className:"p-6 space-y-6 flex-grow",children:(0,d.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 items-start",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"date",children:"التاريخ"}),(0,d.jsx)(q.xI,{control:K,name:"date",render:({field:a})=>(0,d.jsxs)(t.AM,{open:H,onOpenChange:I,children:[(0,d.jsx)(t.Wv,{asChild:!0,children:(0,d.jsxs)(f.$,{variant:"outline",className:(0,w.cn)("w-full justify-start text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?(0,v.GP)(a.value,"yyyy-MM-dd"):(0,d.jsx)("span",{children:"اختر تاريخ"}),(0,d.jsx)(j.A,{className:"ms-auto h-4 w-4 opacity-50"})]})}),(0,d.jsx)(t.hl,{className:"w-auto p-0",children:(0,d.jsx)(u.V,{mode:"single",selected:a.value,onSelect:b=>{b&&a.onChange(b),I(!1)}})})]})}),O.date&&(0,d.jsx)("p",{className:"text-sm text-destructive h-4",children:O.date.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"payee",children:"الجهة المستفيدة (اختياري)"}),(0,d.jsx)(D.p,{id:"payee",placeholder:"مثال: موظف، شركة الكهرباء...",...N("payee")})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"notes",children:"التفاصيل / الملاحظات"}),(0,d.jsx)(h.T,{id:"notes",placeholder:"أضف تفاصيل إضافية هنا...",...N("notes")})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"expenseType",children:"نوع المصروف"}),(0,d.jsx)(q.xI,{name:"expenseType",control:K,render:({field:a})=>(0,d.jsxs)(i.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(i.bq,{id:"expenseType",children:(0,d.jsx)(i.yv,{placeholder:"اختر نوع المصروف..."})}),(0,d.jsxs)(i.gC,{children:[(0,d.jsx)(i.eb,{value:"salaries",children:"رواتب"}),(0,d.jsx)(i.eb,{value:"rent",children:"إيجار"}),(0,d.jsx)(i.eb,{value:"utilities",children:"فواتير وخدمات"}),(0,d.jsx)(i.eb,{value:"supplies",children:"قرطاسية ومستلزمات"})]})]})}),O.expenseType&&(0,d.jsx)("p",{className:"text-sm text-destructive",children:O.expenseType.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"boxId",children:"الصندوق"}),(0,d.jsx)(q.xI,{name:"boxId",control:K,render:({field:b})=>(0,d.jsxs)(i.l6,{onValueChange:b.onChange,value:b.value,children:[(0,d.jsx)(i.bq,{id:"boxId",children:(0,d.jsx)(i.yv,{placeholder:"اختر الصندوق..."})}),(0,d.jsx)(i.gC,{children:a.map(a=>(0,d.jsx)(i.eb,{value:a.id,children:a.name},a.id))})]})}),O.boxId&&(0,d.jsx)("p",{className:"text-sm text-destructive",children:O.boxId.message})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"amount",children:"المبلغ"}),(0,d.jsx)(q.xI,{name:"amount",control:K,render:({field:a})=>(0,d.jsx)(F,{currency:c,...a,onValueChange:a.onChange})}),O.amount&&(0,d.jsx)("p",{className:"text-sm text-destructive",children:O.amount.message})]}),"USD"===c&&(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)(g.J,{htmlFor:"exchangeRate",children:"سعر الصرف (مقابل الدينار)"}),(0,d.jsx)(q.xI,{name:"exchangeRate",control:K,render:({field:a})=>(0,d.jsx)(F,{currency:"IQD",...a,onValueChange:a.onChange})})]})]})]})}),(0,d.jsx)(x.Es,{className:"p-4 border-t bg-background sticky bottom-0",children:(0,d.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(k.A,{className:"h-4 w-4"})," ",(0,d.jsxs)("span",{children:["المستخدم: ",J?.name||"..."]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(l.A,{className:"h-4 w-4"})," ",(0,d.jsx)("span",{children:"رقم الفاتورة: (تلقائي)"})]})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsxs)(f.$,{type:"button",onClick:()=>{},variant:"outline",disabled:P,children:[(0,d.jsx)(m.A,{className:"me-2 h-4 w-4"}),"حفظ وطباعة"]}),(0,d.jsxs)(f.$,{type:"submit",disabled:P,children:[P&&(0,d.jsx)(n.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,d.jsx)(o.A,{className:"me-2 h-4 w-4"}),z?"حفظ التعديلات":"حفظ سند المصاريف"]})]})]})})]})}},77837:(a,b,c)=>{"use strict";c.d(b,{AM:()=>h,Wv:()=>i,hl:()=>j});var d=c(21124),e=c(38301),f=c(810),g=c(44943);let h=f.bL,i=f.l9,j=e.forwardRef(({className:a,align:b="center",sideOffset:c=4,...e},h)=>(0,d.jsx)(f.ZL,{children:(0,d.jsx)(f.UC,{ref:h,align:b,sideOffset:c,className:(0,g.cn)("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...e})}));j.displayName=f.UC.displayName},79541:(a,b,c)=>{"use strict";c.d(b,{l:()=>e});var d=c(85708);let e=(0,d.createServerReference)("40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3",d.callServer,void 0,d.findSourceMapURL,"getUsers")},79994:(a,b,c)=>{"use strict";c.d(b,{c:()=>e});var d=c(85708);let e=(0,d.createServerReference)("7f085acd10c7b589563e59e7e18d605a9cf6eb6b56",d.callServer,void 0,d.findSourceMapURL,"getBoxes")},80446:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{$E:()=>q,Lf:()=>o,iS:()=>p});var e=c(91488);c(27806);var f=c(9801),g=c(14276),h=c(7879),i=c(24803),j=c(68464),k=c(40410),l=a([f,g,h,i]);[f,g,h,i]=l.then?(await l)():l;let r=null,s=null;async function m(){if((0,f.getApps)().length>0)return r=(0,f.getApp)();if(!j.R||!j.R.projectId||!j.R.privateKey||!j.R.clientEmail)throw console.error("Firebase Admin SDK Service Account object is not valid."),s=Error("Default Firebase service account is not valid in firebase-service-account.ts.");try{console.log("Initializing Firebase Admin SDK...");let a=(0,f.initializeApp)({credential:(0,f.cert)(j.R),storageBucket:`${j.R.projectId}.appspot.com`});return r=a,console.log("Firebase Admin SDK initialized successfully."),a}catch(a){throw console.error("Failed to initialize Firebase Admin SDK:",String(a)),s=a instanceof Error?a:Error(String(a))}}async function n(){if(r)return r;if(s)throw s;return await m()}async function o(){let a=await n();return(0,h.getFirestore)(a)}async function p(){let a=await n();return(0,g.getAuth)(a)}async function q(){let a=await n();return(0,i.getStorage)(a)}(0,k.D)([o,p,q]),(0,e.A)(o,"009e84f93947e0a432e28675ea07a71949bfe66943",null),(0,e.A)(p,"0084d26686615403d39adac4c095e2f442ed3af27d",null),(0,e.A)(q,"0079928ff14026085419c5483c28b98ee3311389f6",null),d()}catch(a){d(a)}})},82357:(a,b,c)=>{"use strict";c.d(b,{rN:()=>j,uJ:()=>i});let d=a=>(a??"").trim(),e=(a,b)=>Array.from(new Set([...b,...Object.keys(a||{})])).reduce((b,c)=>(b[c]=d(a?.[c]),b),{}),f=a=>Object.values(a).find(a=>a.length>0)||"",g=["tickets","visas","subscriptions","segments","profit_distribution","other"],h=["tickets","visas","subscriptions","partners","operating","cost_tickets","cost_visas","operating_salaries","operating_rent","operating_utilities","marketing"];function i(a){let b={...a?.revenueMap||{},...a?.customRevenues||{}},c={...a?.expenseMap||{},...a?.customExpenses||{}},i=e(b,g),j=e(c,h),k=d(a?.receivableAccountId||a?.arAccountId),l=d(a?.payableAccountId||a?.apAccountId),m=d(a?.generalRevenueId)||f(i),n=d(a?.generalExpenseId)||f(j);return{receivableAccountId:k,payableAccountId:l,hybridRelationAccountId:d(a?.hybridRelationAccountId),clearingAccountId:d(a?.clearingAccountId),defaultCashId:d(a?.defaultCashId),defaultBankId:d(a?.defaultBankId),arAccountId:k,apAccountId:l,generalRevenueId:m,generalExpenseId:n,preventDirectCashRevenue:!!a?.preventDirectCashRevenue,revenueMap:i,expenseMap:j}}function j(a){let b=e(a.revenueMap||{},g),c=e(a.expenseMap||{},h),i=d(a.receivableAccountId),j=d(a.payableAccountId),k=d(a.generalRevenueId)||f(b),l=d(a.generalExpenseId)||f(c);return{receivableAccountId:i,payableAccountId:j,hybridRelationAccountId:d(a.hybridRelationAccountId),clearingAccountId:d(a.clearingAccountId),defaultCashId:d(a.defaultCashId),defaultBankId:d(a.defaultBankId),preventDirectCashRevenue:!!a.preventDirectCashRevenue,generalRevenueId:k,generalExpenseId:l,arAccountId:i,apAccountId:j,revenueMap:b,customRevenues:b,expenseMap:c,customExpenses:c}}},86851:(a,b,c)=>{"use strict";c.d(b,{CG:()=>k,Fm:()=>p,Qs:()=>r,cj:()=>j,h:()=>o,qp:()=>q});var d=c(21124),e=c(38301),f=c(39641),g=c(26691),h=c(90447),i=c(44943);let j=f.bL,k=f.l9;f.bm;let l=f.ZL,m=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));m.displayName=f.hJ.displayName;let n=(0,g.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),o=e.forwardRef(({side:a="right",className:b,children:c,...e},g)=>(0,d.jsxs)(l,{children:[(0,d.jsx)(m,{}),(0,d.jsxs)(f.UC,{ref:g,className:(0,i.cn)(n({side:a}),b),...e,children:[c,(0,d.jsxs)(f.bm,{className:"absolute left-4 top-4 rounded-full p-1.5 opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary bg-muted hover:bg-muted/80",children:[(0,d.jsx)(h.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));o.displayName=f.UC.displayName;let p=({className:a,...b})=>(0,d.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-right",a),...b});p.displayName="SheetHeader";let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hE,{ref:c,className:(0,i.cn)("text-lg font-semibold text-foreground",a),...b}));q.displayName=f.hE.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.VY,{ref:c,className:(0,i.cn)("text-sm text-muted-foreground",a),...b}));r.displayName=f.VY.displayName},87965:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{L:()=>p,_:()=>o});var e=c(91488);c(27806);var f=c(80446),g=c(62641),h=c(91837),i=c(54756),j=c(29631),k=c(7879),l=c(58749),m=c(40410),n=a([f,g,i,j,k,l]);async function o(a){let b=await (0,g.$T)(),c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};if(!b)return{success:!1,error:"User not authenticated."};try{let d=await (0,i.mt)(),e=d.voucherSettings?.distributed;if(!e)return{success:!1,error:"Distributed voucher settings are not configured."};let f=b.name||"System",g=c.batch(),m=c.collection("journal-vouchers").doc(),n=await (0,j.tu)("DS"),o=[],p=[];p.push({accountId:a.boxId,amount:a.totalAmount,description:`استلام إجمالي مبلغ من ${a.accountId}`}),a.companyAmount>0&&o.push({accountId:a.accountId,amount:a.companyAmount,description:`تسوية جزء من حسابهم`}),Object.entries(a.distributions).filter(([,a])=>a?.enabled&&a?.amount>0).forEach(([a,b])=>{let c=e.distributionChannels?.find(b=>b.id===a);o.push({accountId:c?.accountId||"unknown_distribution_account",amount:Number(b.amount),description:`توزيع إلى ${c?.label||"حساب توزيع"}`})});let q=o.reduce((a,b)=>a+b.amount,0);if(Math.abs(q-a.totalAmount)>.01)return{success:!1,error:"مجموع مبالغ التوزيع وحصة الشركة لا يساوي المبلغ المستلم."};let r={...a,date:a.date.toISOString()};g.set(m,{invoiceNumber:n,date:a.date.toISOString(),currency:a.currency,exchangeRate:a.exchangeRate||null,notes:a.notes||"",createdBy:b.uid,officer:f,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),voucherType:"journal_from_distributed_receipt",debitEntries:p,creditEntries:o,isAudited:!1,isConfirmed:!1,originalData:r}),g.update(c.collection("clients").doc(a.accountId),{useCount:k.FieldValue.increment(1)}),g.update(c.collection("boxes").doc(a.boxId),{useCount:k.FieldValue.increment(1)});let s=await c.collection("clients").doc(a.accountId).get(),t=s.data()?.name||a.accountId;return await g.commit(),await (0,l.iL)({userId:b.uid,userName:f,action:"CREATE",targetType:"VOUCHER",targetId:m.id,description:`أنشأ سند قبض مخصص للعميل ${t} برقم ${n} بمبلغ ${a.totalAmount} ${a.currency}.`}),(0,h.revalidatePath)("/accounts/vouchers/list"),(0,h.revalidatePath)("/reports/account-statement"),{success:!0,newVoucher:{id:m.id,...r}}}catch(a){return console.error("Error creating balanced entry from distributed: ",a.message),{success:!1,error:a.message}}}async function p(a,b){let c=await (0,g.$T)(),d=await (0,f.Lf)();if(!d)return{success:!1,error:"Database not available."};if(!c)return{success:!1,error:"User not authenticated."};try{let e=await (0,i.mt)(),f=e.voucherSettings?.distributed;if(!f)return{success:!1,error:"Distributed voucher settings are not configured."};let g=d.collection("journal-vouchers").doc(a),j=[],k=[];k.push({accountId:b.boxId,amount:b.totalAmount,description:`استلام إجمالي مبلغ من ${b.accountId}`}),b.companyAmount>0&&j.push({accountId:b.accountId,amount:b.companyAmount,description:`تسوية جزء من حسابهم`}),Object.entries(b.distributions).filter(([,a])=>a?.enabled&&a?.amount>0).forEach(([a,b])=>{let c=f.distributionChannels?.find(b=>b.id===a);j.push({accountId:c?.accountId||"unknown_distribution_account",amount:Number(b.amount),description:`توزيع إلى ${c?.label||"حساب توزيع"}`})});let m=j.reduce((a,b)=>a+b.amount,0);if(Math.abs(m-b.totalAmount)>.01)return{success:!1,error:"مجموع مبالغ التوزيع وحصة الشركة لا يساوي المبلغ المستلم."};let n={...b,date:b.date.toISOString()};await g.update({date:b.date.toISOString(),currency:b.currency,exchangeRate:b.exchangeRate||null,notes:b.notes||"",debitEntries:k,creditEntries:j,originalData:n,updatedAt:new Date().toISOString()});let o=await d.collection("clients").doc(b.accountId).get(),p=o.data()?.name||b.accountId;return await (0,l.iL)({userId:c.uid,userName:c.name,action:"UPDATE",targetType:"VOUCHER",targetId:a,description:`عدل سند القبض المخصص للعميل ${p}.`}),(0,h.revalidatePath)("/accounts/vouchers/list"),(0,h.revalidatePath)("/reports/account-statement"),{success:!0}}catch(a){return console.error("Error updating balanced entry from distributed: ",a.message),{success:!1,error:a.message}}}[f,g,i,j,k,l]=n.then?(await n)():n,(0,m.D)([o,p]),(0,e.A)(o,"40c15e87ca74d3ad5ae09fdc0c6d9616384469f25f",null),(0,e.A)(p,"60eed12072721bc1c2c48214672b423b5d4cc8a6f3",null),d()}catch(a){d(a)}})},89308:(a,b,c)=>{"use strict";c.d(b,{$m:()=>k,As:()=>j,nD:()=>i,ub:()=>l});var d=c(21124),e=c(38301),f=c(62225),g=c(57105),h=c(44943);let i=f.bL,j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.q7,{ref:c,className:(0,h.cn)("border-b",a),...b}));j.displayName="AccordionItem";let k=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsx)(f.Y9,{className:"flex",children:(0,d.jsxs)(f.l9,{ref:e,className:(0,h.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:no-underline data-[state=open]:text-primary [&[data-state=open]>svg]:rotate-180",a),...c,children:[b,(0,d.jsx)(g.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));k.displayName=f.l9.displayName;let l=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsx)(f.UC,{ref:e,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...c,children:(0,d.jsx)("div",{className:(0,h.cn)("pb-4 pt-0",a),children:b})}));l.displayName=f.UC.displayName},90521:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Cm:()=>u,O0:()=>t,TK:()=>r,hG:()=>s,ht:()=>o,lo:()=>p,nu:()=>q,qV:()=>w,v_:()=>v});var e=c(91488);c(27806);var f=c(14276),g=c(80446),h=c(91837),i=c(67132),j=c(41331),k=c(63097),l=c(55511),m=c(40410),n=a([f,g]);[f,g]=n.then?(await n)():n;let x=a=>{if(!a)return null;let b=JSON.parse(JSON.stringify(a));for(let a in b)b[a]&&(b[a].hasOwnProperty("_seconds")||"function"==typeof b[a].toDate)&&(b[a]=new Date(1e3*b[a]._seconds||b[a].toDate()).toISOString());return b};async function o(a){let b=await (0,g.Lf)();if(!b)return null;try{let c=b.collection("users"),d=await c.where("email","==",a).limit(1).get();if(d.empty)return null;let e=d.docs[0];return{...x(e.data()),uid:e.id}}catch(a){return console.error("Error getting user by email:",String(a)),null}}async function p({includeHrData:a=!1,all:b=!1,from:c,to:d}={}){try{let b=await (0,g.Lf)(),e=(0,f.getAuth)(),[h,l]=await Promise.all([e.listUsers(),b.collection("users").get()]),m=new Map(l.docs.map(a=>[a.id,x(a.data())])),n=h.users.map(a=>{let b=m.get(a.uid)||{};return{uid:a.uid,name:a.displayName||b.name||"No Name",username:b.username||"",email:a.email||b.email||"",phone:a.phoneNumber||b.phone||"",avatarUrl:a.photoURL||b.avatarUrl,status:b.status||(a.disabled?"blocked":"pending"),role:b.role||"viewer",department:b.department,position:b.position,boxId:b.boxId,baseSalary:b.baseSalary||0,bonuses:b.bonuses||0,deductions:b.deductions||0,notes:b.notes,attendance:b.attendance||[],ticketProfit:b.ticketProfit,visaProfit:b.visaProfit,groupProfit:b.groupProfit,changeProfit:b.changeProfit,segmentProfit:b.segmentProfit,preferences:b.preferences||{},calculatedTotalProfit:0,calculatedNetSalary:0}});if(a){let a=c?(0,i.o)(c):void 0,e=d?(0,j.D)(d):void 0,f=await b.collection("journal-vouchers").get(),g={};f.forEach(b=>{let c=b.data(),d=c.officer,f=(0,k.H)(c.date);if(d&&(!a||!e||f>=a&&f<=e)){g[d]||(g[d]=0);let a=c.originalData?.salePrice||(c.originalData?.passengers||[]).reduce((a,b)=>a+(b.salePrice||0),0),b=c.originalData?.purchasePrice||(c.originalData?.passengers||[]).reduce((a,b)=>a+(b.purchasePrice||0),0);g[d]+=a-b}}),n.forEach(a=>{a.calculatedTotalProfit=g[a.name]||0,a.calculatedNetSalary=(a.baseSalary||0)+(a.bonuses||0)-(a.deductions||0)+a.calculatedTotalProfit})}return n}catch(a){return console.error("Error fetching users:",String(a)),[]}}async function q(a){let b=await (0,f.getAuth)(),c=await (0,g.Lf)(),{email:d,password:e,name:i,phone:j,...k}=a,m=e&&e.length>=6?e:(0,l.randomBytes)(16).toString("hex"),n=j;n&&!n.startsWith("+")&&(n=n.startsWith("0")?`+964${j.substring(1)}`:`+964${j}`);let o=await b.createUser({email:d,password:m,displayName:i,phoneNumber:n,disabled:"blocked"===a.status});return await c.collection("users").doc(o.uid).set({...k,name:i,email:d,phone:n}),(0,h.revalidatePath)("/users"),{success:!0,newUser:{uid:o.uid,...a}}}async function r(a,b){let c=await (0,f.getAuth)(),d=await (0,g.Lf)(),{email:e,name:i,phone:j,password:k,status:l,avatarUrl:m,...n}=b,o={};e&&(o.email=e),i&&(o.displayName=i),j&&(o.phoneNumber=j),m&&(o.photoURL=m),k&&k.length>=6&&(o.password=k),l&&(o.disabled="blocked"===l),Object.keys(o).length>0&&await c.updateUser(a,o);let p={...n,email:e,name:i,phone:j,status:l,avatarUrl:m};Object.keys(p).forEach(a=>void 0===p[a]&&delete p[a]),Object.keys(p).length>0&&await d.collection("users").doc(a).set(p,{merge:!0}),(0,h.revalidatePath)("/users");let q=await d.collection("users").doc(a).get(),r=x(q.data());return{success:!0,updatedUser:{...r,uid:a}}}async function s(a){let b=await (0,f.getAuth)(),c=await (0,g.Lf)();return await b.deleteUser(a),await c.collection("users").doc(a).delete(),(0,h.revalidatePath)("/users"),{success:!0}}async function t(){let a=await (0,g.Lf)();return(await a.collection("roles").get()).docs.map(a=>({id:a.id,...a.data()}))}async function u(a){let b=await (0,g.Lf)(),c=a.name.toLowerCase().replace(/\s+/g,"_");return await b.collection("roles").doc(c).set(a),(0,h.revalidatePath)("/users"),{success:!0,newRole:{id:c,...a}}}async function v(a,b){let c=await (0,g.Lf)();return await c.collection("roles").doc(a).update(b),(0,h.revalidatePath)("/users"),{success:!0}}async function w(){try{let a=await (0,f.getAuth)(),b=(await a.listUsers()).users.map(a=>({uid:a.uid,email:a.email,displayName:a.displayName,creationTime:new Date(a.metadata.creationTime).toLocaleDateString()}));return{success:!0,users:b}}catch(a){return console.error("Error listing all auth users:",String(a)),{success:!1,error:a.message}}}(0,m.D)([o,p,q,r,s,t,u,v,w]),(0,e.A)(o,"406818275705b776627a9e14558eaa7857fbec9b73",null),(0,e.A)(p,"40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3",null),(0,e.A)(q,"40d4790cf5bfe15d462399ad8c52d1baec8babf86f",null),(0,e.A)(r,"601532f3b7a46dae258a5ff32f14fb4b3e2e141e9f",null),(0,e.A)(s,"40ef77a697a84cf599002575e6afc4c1de58c3cdab",null),(0,e.A)(t,"005773e734ccf3535fa61ed9b34042d47625b1ede6",null),(0,e.A)(u,"40e13d085ff779b8dfbb82e790ebb21702ce079192",null),(0,e.A)(v,"601838acb9f969bfd30fa9f583c86dd453b19524dd",null),(0,e.A)(w,"00afcee30c25fc6521aeaf596fabd0fef5e0ca707f",null),d()}catch(a){d(a)}})},92351:(a,b,c)=>{"use strict";c.d(b,{o:()=>e});var d=c(85708);let e=(0,d.createServerReference)("6052254d233f0ea6b36992b2b81ce07178dee95ad7",d.callServer,void 0,d.findSourceMapURL,"updateVoucher")},93758:(a,b,c)=>{"use strict";c.d(b,{p:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-10 w-full rounded-lg border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));g.displayName="Input"},94762:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{cl:()=>o,fW:()=>m,lc:()=>k,rj:()=>l});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(46204),i=c(40410),j=a([f]);f=(j.then?(await j)():j)[0];let n="boxes",o=(0,h.cache)(async()=>{let a=await (0,f.Lf)();if(!a)return console.warn("Database not available, returning empty boxes list."),[];try{let b=await a.collection(n).get();if(b.empty)return[];return b.docs.map(a=>{let b=a.data();return{id:a.id,name:b.name||"",openingBalanceUSD:b.openingBalanceUSD||0,openingBalanceIQD:b.openingBalanceIQD||0}})}catch(a){return console.error("Error getting boxes from Firestore: ",String(a)),[]}});async function k(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};try{return await b.collection(n).add(a),(0,g.revalidatePath)("/boxes"),{success:!0}}catch(a){return console.error("Error adding box: ",String(a)),{success:!1,error:"Failed to add box."}}}async function l(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};try{return await c.collection(n).doc(a).update(b),(0,g.revalidatePath)("/boxes"),{success:!0}}catch(a){return console.error("Error updating box: ",String(a)),{success:!1,error:"Failed to update box."}}}async function m(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};try{return await b.collection(n).doc(a).delete(),(0,g.revalidatePath)("/boxes"),{success:!0}}catch(a){return console.error("Error deleting box: ",String(a)),{success:!1,error:"Failed to delete box."}}}(0,i.D)([o,k,l,m]),(0,e.A)(o,"7f085acd10c7b589563e59e7e18d605a9cf6eb6b56",null),(0,e.A)(k,"401b140032a44590c12253e287a8d7d0383408525e",null),(0,e.A)(l,"6073e98acf09f5000817ebcdd05234acc9c4d29f85",null),(0,e.A)(m,"409ee2d098a25e0103bd4e5cbd3c84c821bce98df9",null),d()}catch(a){d(a)}})},97737:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},97802:(a,b,c)=>{"use strict";c.d(b,{Z:()=>n,z:()=>m});var d=c(21124),e=c(38301),f=c(38505),g=c(79994),h=c(79541),i=c(54864),j=c(63009),k=c(60977);let l=(0,e.createContext)({data:null,loaded:!1,fetchData:async()=>{},refreshData:async()=>{}}),m=({children:a})=>{let[b,c]=(0,e.useState)(null),[m,n]=(0,e.useState)(!1),[o,p]=(0,e.useState)(!1),{user:q,loading:r}=(0,j.A)(),s=(0,e.useCallback)(async(a=!1)=>{if(!o&&(!m||a)){p(!0);try{let[a,b,d,e,j]=await Promise.all([(0,f.L)({all:!0,includeInactive:!1,relationType:"all"}),(0,g.c)(),(0,h.l)({all:!0}),(0,i.m)(),(0,k.r)()]),l=a.clients,m=l.filter(a=>"client"===a.relationType||"both"===a.relationType),o=l.filter(a=>"supplier"===a.relationType||"both"===a.relationType),p=j.accounts||[];c({clients:m,suppliers:o,boxes:b,users:d,exchanges:p,settings:e}),n(!0)}catch(a){console.error("Failed to load initial voucher navigation data:",a)}finally{p(!1)}}},[o,m]);(0,e.useEffect)(()=>{r||!q||"isClient"in q&&q.isClient||s()},[q,r,s]);let t=(0,e.useCallback)(async()=>{await s(!0)},[s]);return(0,d.jsx)(l.Provider,{value:{data:b,loaded:m,fetchData:s,refreshData:t},children:a})},n=()=>{let a=(0,e.useContext)(l);if(void 0===a)throw Error("useVoucherNav must be used within a VoucherNavProvider");return a}},99187:(a,b,c)=>{"use strict";c.d(b,{E:()=>h});var d=c(21124);c(38301);var e=c(26691),f=c(44943);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("span",{className:(0,f.cn)(g({variant:b}),a),...c})}},99651:(a,b,c)=>{"use strict";c.d(b,{z:()=>e});var d=c(85708);let e=(0,d.createServerReference)("60e34f9cbe57141cf2262bc166578e2d558a98e99f",d.callServer,void 0,d.findSourceMapURL,"updateClient")}};