"use strict";exports.id=6587,exports.ids=[6587],exports.modules={46587:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Xx:()=>o,_u:()=>q,mt:()=>s});var e=c(75879);c(68633);var f=c(43513),g=c(16780),h=c(33152),i=c(86988),j=c(65512),k=c(74515),l=c(51669),m=a([f,h,i]);async function n(){try{return await new Promise(a=>setTimeout(a,500)),{service:"Google Drive",success:!0,message:"الاتصال ناجح"}}catch(a){return{service:"Google Drive",success:!1,message:`فشل الاتصال: ${a.message}`}}}[f,h,i]=m.then?(await m)():m;let r="app_settings",s=(0,k.cache)(async()=>{let a=await (0,f.Lf)();if(!a)return console.warn("Database not available, returning default settings."),j.xd;try{let b=await a.collection("settings").doc(r).get();if(!b.exists){console.log("No settings found in database, seeding with default settings.");let b={...j.xd,databaseStatus:{isDatabaseConnected:!0}};return await a.collection("settings").doc(r).set(b),b}let c=b.data();if(c.databaseStatus?.isDatabaseConnected!==!0)return{...c,databaseStatus:{isDatabaseConnected:!0}};return c}catch(a){return console.error("Error getting settings:",String(a)),{...j.xd,databaseStatus:{isDatabaseConnected:!0}}}});async function o(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};let d=b.collection("settings").doc(r);try{let b={...await s(),...a};return await d.set(b,{merge:!0}),await (0,i.iL)({userId:c.uid,userName:c.name,action:"UPDATE",targetType:"SETTINGS",description:`قام بتحديث إعدادات النظام.`}),(0,g.revalidatePath)("/settings","layout"),(0,g.revalidatePath)("/","layout"),{success:!0}}catch(a){return console.error("Error updating settings:",String(a)),{success:!1,error:"Failed to update settings."}}}async function p(){let a=await (0,f.Lf)();if(!a)return{service:"Firebase",success:!1,message:"فشل تهيئة Firebase Admin SDK. تحقق من متغيرات البيئة."};try{return await a.collection("health_checks").limit(1).get(),{service:"Firebase",success:!0,message:`الاتصال ناجح`}}catch(b){console.error("Firebase connection test failed:",String(b));let a=`فشل الاتصال: ${b.message}`;return 7===b.code||"string"==typeof b.message&&(b.message.includes("permission-denied")||b.message.includes("PERMISSION_DENIED"))?a="فشل الاتصال: تم رفض الإذن. تحقق من صلاحيات حساب الخدمة (IAM) في Google Cloud Console.":"string"==typeof b.message&&b.message.includes("Could not refresh access token")?a="فشل في المصادقة. يرجى التحقق من صحة بيانات اعتماد حساب الخدمة (Service Account) المضمنة.":"string"==typeof b.message&&b.message.includes("Unable to detect a Project Id")&&(a="فشل في المصادقة: لم يتم العثور على معرف المشروع. تحقق من أن ملف الخدمة يحتوي على `project_id`."),{service:"Firebase",success:!1,message:a}}}async function q(){return await Promise.all([p(),n()])}(0,l.D)([s,o,q]),(0,e.A)(s,"7fe3cedf8b5b39f6ca6561f08402f1ad7a82ecff97",null),(0,e.A)(o,"40bd3493b6cd183a3f75aa7b2dffe9f325b07a2b9d",null),(0,e.A)(q,"0004c295195cb02aa74b7e03b9ab47835262f651f3",null),d()}catch(a){d(a)}})},65512:(a,b,c)=>{c.d(b,{xd:()=>e});var d=c(97092);let e={currencySettings:{defaultCurrency:"USD",exchangeRates:{USD_IQD:1480},currencies:[{code:"USD",name:"US Dollar",symbol:"$"},{code:"IQD",name:"Iraqi Dinar",symbol:"ع.د"}]},exchangeRateTemplate:"*تحديث سعر الصرف*\\n\\n 1 دولار أمريكي = *{rate}* دينار عراقي\\n\\nتاريخ التحديث: {date}",remittanceSettings:{offices:["الريان","الطيف","ماستر","عطاء الغري"],methods:["زين كاش","ماستر كارد","حوالة مصرفية","نقدي"],distributionColumnsUsd:[{id:"externalAmount",label:"خارجي"}],distributionColumnsIqd:[{id:"flyAmount",label:"فلاي"},{id:"internalAmount",label:"داخلي"}],headerColorUsd:"#1e40af",headerColorIqd:"#166534"},voucherSettings:{receiptInvoiceCounter:1e3,paymentInvoiceCounter:1e3,receiptTableColumns:[],paymentTableColumns:[],expenseAccounts:[{id:"expense_salaries",name:"رواتب"},{id:"expense_rent",name:"إيجار"}]},invoiceSequenceSettings:{ticketBookingCounter:0,visaBookingCounter:0,groupBookingCounter:0},creditPolicySettings:{defaultCreditLimit:1e4,defaultGracePeriodDays:30},databaseStatus:{isDatabaseConnected:!0},theme:{landingPage:{heroTitle:"لشركات السياحة والسفر",heroSubtitle:"حلول متكاملة لإدارة الحسابات المالية، تذاكر الطيران، الفيزا، والفواتير بكل ذكاء وسهولة.",heroSubtitleColor:"#52525b",heroTitleColor:"#1e293b",heroFontFamily:"",smartTickets:{title:"إدخال ذكي للتذاكر والفواتير",description:"وداعًا للإدخال اليدوي. نظامنا يقرأ ملفات PDF ويستخرج البيانات تلقائيًا، مما يوفر وقتك ويزيد من دقة بياناتك.",imageUrl:"https://images.unsplash.com/photo-1517999348311-5bc38e05b1c6?q=80&w=2070&auto=format&fit=crop"},sourceAuditing:{title:"مطابقة الكشوفات بذكاء",description:"أداة مبتكرة لمقارنة كشف حسابك مع كشف حساب الموردين، وتحديد الفروقات والاختلافات تلقائيًا بدقة تصل إلى 99%.",imageUrl:"https://images.unsplash.com/photo-1554224155-1696413565d3?q=80&w=2070&auto=format&fit=crop"},financialManagement:{title:"إدارة مالية شاملة",description:"من سندات القبض والصرف إلى شجرة الحسابات والتقارير المتقدمة، كل ما تحتاجه لإدارة مالية شركتك في مكان واحد.",imageUrl:"https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=2070&auto=format&fit=crop"},servicesSection:{title:"خدماتنا المحاسبية",description:"نظام متكامل يغطي جميع احتياجات شركات السياحة والسفر، مصمم خصيصًا ليتوافق مع طبيعة عملكم."},partnersSection:{title:"شركاء النجاح",description:"نفخر بالتعاون مع نخبة من شركات السياحة والسفر الرائدة التي وثقت في نظامنا لتحقيق أهدافها.",partners:[{name:"FlyBaghdad",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/FQ.svg"},{name:"UR Airlines",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/UD.svg"},{name:"Iraqi Airways",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/IA.svg"},{name:"Anadolujet",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/TK.svg"},{name:"Turkish Airlines",logoUrl:"https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/TK.svg"}]},faqSection:{title:"الأسئلة الشائعة",description:"هل لديك سؤال؟ قد تجد إجابتك هنا.",faqs:[{question:"ما هو نظام Mudarib؟",answer:"هو نظام محاسبي متكامل مصمم خصيصًا لشركات السياحة والسفر."},{question:"هل يدعم النظام اللغة العربية؟",answer:"نعم، النظام يدعم اللغة العربية بشكل كامل مع واجهات RTL."},{question:"هل يمكن تخصيص مظهر النظام؟",answer:"بالتأكيد، يمكنك تخصيص الألوان والخطوط والشعارات من صفحة الإعدادات."}]},accountStatements:{title:"إدارة ومتابعة الديون بسهولة",description:"نظام متكامل لمتابعة ديون العملاء والموردين، مع كشوفات حسابات تفصيلية وتنبيهات آلية للمدفوعات المستحقة.",imageUrl:"https://images.unsplash.com/photo-1556742502-ec7c0e9f34b1?q=80&w=1974&auto=format&fit=crop"},financialAnalysis:{title:"تحليلات مالية دقيقة لاتخاذ القرارات",description:"احصل على رؤية عميقة لأداء شركتك المالي. تتبع الأرباح، حلل التكاليف، وادرس هيكل حساباتك بسهولة عبر شجرة الحسابات التفاعلية.",imageUrl:"https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=2070&auto=format&fit=crop"},footerImageUrl:"https://images.unsplash.com/photo-1549492423-400259a5e5a4?q=80&w=2148&auto=format&fit=crop"},invoice:{companyName:"Mudarib",companyAddress:"Iraq - Holy Karbala - Silo St.",companyPhone:"+964 781 000 3377",companyWeb:"codescope.dev",headerColor:"#e0f2f1",titleColor:"#663399",footerText:"شكرًا لتعاملكم معنا!"}},importFieldsSettings:{name:{label:"الاسم الكامل",aliases:["name","الاسم","اسم العميل","اسم الشركة","company name","supplier name","اسم المورد"]},phone:{label:"رقم الهاتف",aliases:["phone","الهاتف","رقم الهاتف","mobile","رقم الجوال"]},email:{label:"البريد الإلكتروني",aliases:["email","البريد الالكتروني","بريد الكتروني"]},type:{label:"نوع الجهة",aliases:["type","النوع","entity type"]},relationType:{label:"نوع العلاقة",aliases:["relationtype","relation type","نوع العلاقة"]},status:{label:"الحالة",aliases:["status","الحالة"]},code:{label:"معرف الشركة (يوزر فلاي)",aliases:["code","companyid","company id","معرف الشركة","يوزر فلاي"]},paymentType:{label:"نوع التعامل",aliases:["paymenttype","payment type","نوع التعامل","التعامل","نوع الدفع"]},details:{label:"التفاصيل",aliases:["details","notes","ملاحظات","تفاصيل"]},country:{label:"الدولة",aliases:["country","البلد","دولة"]},province:{label:"المحافظة",aliases:["province","state","المحافظة","الولاية"]},streetAddress:{label:"تفاصيل العنوان",aliases:["address","العنوان","streetaddress","street address"]}},importLogicSettings:{creditKeywords:["credit","آجل","debit","دبت"],cashKeywords:["cash","كاش","نقد","نقدي"]},relationSections:[{id:"sec_basic",title:"المعلومات الأساسية",deletable:!1,description:"الحقول الأساسية لتعريف العميل أو المورد.",fields:[{id:"name",label:"الاسم الكامل",type:"text",required:!0,visible:!0,deletable:!1,placeholder:"اسم العميل أو المورد",appliesTo:["individual","company"],aliases:["name","الاسم","اسم العميل","اسم الشركة","company name","supplier name","اسم المورد"]},{id:"type",label:"نوع الجهة",type:"select",required:!0,visible:!0,deletable:!1,options:[{value:"individual",label:"فرد"},{value:"company",label:"شركة"}],appliesTo:["individual","company"],aliases:["type","النوع","entity type"]},{id:"relationType",label:"نوع العلاقة",type:"select",required:!0,visible:!0,deletable:!1,options:[{value:"client",label:"عميل"},{value:"supplier",label:"مورد"},{value:"both",label:"كلاهما"}],appliesTo:["individual","company"],aliases:["relationtype","relation type","نوع العلاقة","العميل او المورد","client or supplier"]},{id:"status",label:"الحالة",type:"select",required:!0,visible:!0,deletable:!1,options:[{value:"active",label:"نشط"},{value:"inactive",label:"غير نشط"}],appliesTo:["individual","company"],aliases:["status","الحالة"]}]},{id:"sec_contact",title:"معلومات الاتصال والعنوان",deletable:!1,description:"بيانات الاتصال والتواصل والتفاصيل الجغرافية.",fields:[{id:"phone",label:"رقم الهاتف",type:"text",required:!1,visible:!0,deletable:!1,placeholder:"07700000000",appliesTo:["individual","company"],aliases:["phone","الهاتف","رقم الهاتف","mobile","رقم الجوال"]},{id:"email",label:"البريد الإلكتروني",type:"email",required:!1,visible:!0,deletable:!0,placeholder:"example@mail.com",appliesTo:["individual","company"],aliases:["email","البريد الالكتروني","بريد الكتروني"]},{id:"country",label:"الدولة",type:"select",required:!1,visible:!0,deletable:!1,appliesTo:["individual","company"],aliases:["country","البلد","دولة"]},{id:"province",label:"المحافظة/الولاية",type:"select",required:!1,visible:!0,deletable:!1,appliesTo:["individual","company"],aliases:["province","state","المحافظة","الولاية"]},{id:"streetAddress",label:"تفاصيل العنوان",type:"text",required:!1,visible:!0,deletable:!1,placeholder:"المنطقة، الشارع، رقم المبنى...",appliesTo:["individual","company"],aliases:["address","العنوان","streetaddress","street address"]}]},{id:"sec_company",title:"تفاصيل الشركة وتسجيل الدخول",deletable:!1,description:"الحقول الخاصة بالشركات وإدارة الوصول للنظام.",fields:[{id:"code",label:"معرف الشركة (يوزر فلاي)",type:"text",required:!1,visible:!0,deletable:!0,appliesTo:["company"],aliases:["code","companyid","company id","معرف الشركة","يوزر فلاي"]},{id:"paymentType",label:"نوع التعامل",type:"select",required:!0,visible:!0,deletable:!0,options:[{value:"cash",label:"نقدي"},{value:"credit",label:"آجل"}],appliesTo:["company","individual"],aliases:["paymenttype","payment type","نوع التعامل","التعامل","نوع الدفع"]}]},{id:"sec_login",title:"إدارة تسجيل الدخول",deletable:!1,description:"إدارة الوصول للنظام لهذه العلاقة.",fields:[{id:"loginIdentifier",label:"معرف تسجيل الدخول",type:"text",required:!1,visible:!0,deletable:!1,placeholder:"اختر معرفًا فريدًا لتسجيل الدخول",appliesTo:["individual","company"],aliases:["login id","login identifier","username","معرف الدخول","اسم المستخدم"]},{id:"password",label:"كلمة المرور",type:"password",required:!1,visible:!0,deletable:!1,placeholder:"اتركه فارغًا لعدم التغيير",appliesTo:["individual","company"],aliases:["password","كلمة المرور"]}]},{id:"sec_other",title:"تفاصيل أخرى",deletable:!0,description:"حقول إضافية وتفاصيل.",fields:[{id:"details",label:"التفاصيل",type:"textarea",required:!1,visible:!0,deletable:!0,appliesTo:["individual","company"],aliases:["details","notes","ملاحظات","تفاصيل"]}]}],financeAccounts:(0,d.rN)({preventDirectCashRevenue:!1}),customRevenueAccounts:{ticketsRevenueAccountId:"",visaRevenueAccountId:"",subscriptionsRevenueAccountId:"",segmentsRevenueAccountId:""},preventDirectProfitToCash:!0}},86988:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{iL:()=>j,oH:()=>n,t6:()=>m});var e=c(75879);c(68633);var f=c(43513),g=c(16780),h=c(51669),i=a([f]);f=(i.then?(await i)():i)[0];let k="audit_logs",l=a=>{let b=a.data();if(!b)return null;let c={...b,id:a.id};for(let a in c)c[a]&&"function"==typeof c[a].toDate&&(c[a]=c[a].toDate().toISOString());return c};async function j(a){let b=await (0,f.Lf)();if(!b)return void console.error("Audit Log failed: Database not available.");try{await b.collection(k).add({...a,level:a.level||"info",createdAt:new Date().toISOString()}),(0,g.revalidatePath)("/system/activity-log"),(0,g.revalidatePath)("/system/error-log")}catch(a){console.error("Error creating audit log: ",String(a))}}let m=async()=>{let a=await (0,f.Lf)();if(!a)return[];try{let b=await a.collection(k).orderBy("createdAt","desc").limit(200).get();if(b.empty)return[];return b.docs.map(a=>l(a)).filter(a=>"error"!==a.level)}catch(a){throw console.error("Error getting audit logs: ",String(a)),Error("Failed to fetch audit logs.")}},n=async()=>{let a=await (0,f.Lf)();if(!a)return[];try{let b=await a.collection(k).orderBy("createdAt","desc").limit(200).get();if(b.empty)return[];return b.docs.map(a=>l(a)).filter(a=>"error"===a.level)}catch(a){throw console.error("Error getting error logs: ",String(a)),Error("Failed to fetch error logs.")}};(0,h.D)([j,m,n]),(0,e.A)(j,"40ae79a531e9ac50ecc04279061a2192af6e60d6f4",null),(0,e.A)(m,"7fd691cbe2382ade3c2dc739956026d2c3c806df06",null),(0,e.A)(n,"7f06d4b21a91bbe15e581c350a136426169075ee5f",null),d()}catch(a){d(a)}})}};