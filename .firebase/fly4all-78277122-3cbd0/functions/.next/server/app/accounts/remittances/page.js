(()=>{var a={};a.id=7801,a.ids=[7801],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},299:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},643:a=>{"use strict";a.exports=require("node:perf_hooks")},1708:a=>{"use strict";a.exports=require("node:process")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{"use strict";a.exports=require("node:buffer")},7252:a=>{"use strict";a.exports=require("express")},7879:a=>{"use strict";a.exports=import("firebase-admin/firestore")},9517:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9801:a=>{"use strict";a.exports=import("firebase-admin/app")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:a=>{"use strict";a.exports=require("assert")},14276:a=>{"use strict";a.exports=import("firebase-admin/auth")},14365:(a,b,c)=>{Promise.resolve().then(c.bind(c,86183)),Promise.resolve().then(c.bind(c,57193))},14985:a=>{"use strict";a.exports=require("dns")},16698:a=>{"use strict";a.exports=require("node:async_hooks")},18373:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(87604).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])},19063:a=>{"use strict";a.exports=require("require-in-the-middle")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:a=>{"use strict";a.exports=require("dgram")},19771:a=>{"use strict";a.exports=require("process")},20641:(a,b,c)=>{"use strict";c.d(b,{Q:()=>j});var d=c(91488);c(27806);var e=c(38710),f=c(79592),g=c(40410);let h=f.Ik({messageText:f.Yj().describe("The remittance message text, as written in a chat app like WhatsApp.")}),i=f.Ik({companyName:f.Yj().describe("The name of the sending company or person."),amount:f.au.number().describe("The numerical amount of the remittance. This should be a number, not a string."),currency:f.k5(["dinar","dollar"]).describe('The currency of the remittance, either "dinar" or "dollar".'),method:f.Yj().describe("The transfer method (e.g., Master, Al-Taif, Zain Cash)."),recipient:f.Yj().optional().describe("The intended recipient of the funds (e.g., Fly, merchant, exchange)."),notes:f.Yj().optional().describe("Any additional notes, divisions, or clarifying details.")});async function j(a){return l(a)}let k=e.ai.definePrompt({name:"analyzeRemittancePrompt",input:{schema:h},output:{schema:i},prompt:`You are an expert financial assistant specializing in analyzing remittance messages from Iraqi travel agencies. Your task is to extract structured data from the following text message. The message is written in Arabic, often using colloquialisms.

Analyze the message and extract the following fields:
- companyName: The name of the sending company.
- amount: The numeric value of the money transferred. Convert textual numbers (like "مليون") to digits. Ignore commas.
- currency: Determine if the amount is in "dinar" or "dollar". If a number like "720" or "720,000" is mentioned with an equivalent like "600", assume the larger number is dinar and it's equivalent to the smaller number in dollars. The amount field should contain the primary value mentioned.
- method: The transfer method (e.g., "ماستر", "الطيف", "زين كاش", "بورصة").
- recipient: The entity the money is being transferred to (e.g., "فلاي", "تاجر", "بورصة"). If not specified, leave it empty.
- notes: Any other information, like divisions, purposes, or notes. Include the equivalent dollar amount here if it exists.

Return the result as a structured JSON object.

Message:
{{{messageText}}}
`}),l=e.ai.defineFlow({name:"analyzeRemittanceFlow",inputSchema:h,outputSchema:i},async a=>{let{output:b}=await k(a);if(!b)throw Error("Failed to analyze remittance text.");return b});(0,g.D)([j]),(0,d.A)(j,"404a94dfe04fe7c955d488cb56135349bb06d8e5d6",null)},21820:a=>{"use strict";a.exports=require("os")},24803:a=>{"use strict";a.exports=import("firebase-admin/storage")},25054:(a,b,c)=>{"use strict";c.d(b,{H:()=>e});var d=c(29921);function e(a,b){let c,e,n=b?.additionalDigits??2,o=function(a){let b,c={},d=a.split(f.dateTimeDelimiter);if(d.length>2)return c;if(/:/.test(d[0])?b=d[0]:(c.date=d[0],b=d[1],f.timeZoneDelimiter.test(c.date)&&(c.date=a.split(f.timeZoneDelimiter)[0],b=a.substr(c.date.length,a.length))),b){let a=f.timezone.exec(b);a?(c.time=b.replace(a[1],""),c.timezone=a[1]):c.time=b}return c}(a);if(o.date){let a=function(a,b){let c=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+b)+"})|(\\d{2}|[+-]\\d{"+(2+b)+"})$)"),d=a.match(c);if(!d)return{year:NaN,restDateString:""};let e=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:null===f?e:100*f,restDateString:a.slice((d[1]||d[2]).length)}}(o.date,n);c=function(a,b){var c,d,e,f,h,i,k;if(null===b)return new Date(NaN);let n=a.match(g);if(!n)return new Date(NaN);let o=!!n[4],p=j(n[1]),q=j(n[2])-1,r=j(n[3]),s=j(n[4]),t=j(n[5])-1;if(o){return(c=s,d=t,c>=1&&c<=53&&d>=0&&d<=6)?function(a,b,c){let d=new Date(0);d.setUTCFullYear(a,0,4);let e=d.getUTCDay()||7;return d.setUTCDate(d.getUTCDate()+((b-1)*7+c+1-e)),d}(b,s,t):new Date(NaN)}{let a=new Date(0);return(e=b,f=q,h=r,f>=0&&f<=11&&h>=1&&h<=(l[f]||(m(e)?29:28))&&(i=b,(k=p)>=1&&k<=(m(i)?366:365)))?(a.setUTCFullYear(b,q,Math.max(p,r)),a):new Date(NaN)}}(a.restDateString,a.year)}if(!c||isNaN(c.getTime()))return new Date(NaN);let p=c.getTime(),q=0;if(o.time&&isNaN(q=function(a){var b,c,e;let f=a.match(h);if(!f)return NaN;let g=k(f[1]),i=k(f[2]),j=k(f[3]);return(b=g,c=i,e=j,24===b?0===c&&0===e:e>=0&&e<60&&c>=0&&c<60&&b>=0&&b<25)?g*d.s0+i*d.Cg+1e3*j:NaN}(o.time)))return new Date(NaN);if(o.timezone){if(isNaN(e=function(a){var b;if("Z"===a)return 0;let c=a.match(i);if(!c)return 0;let e="+"===c[1]?-1:1,f=parseInt(c[2]),g=c[3]&&parseInt(c[3])||0;return(b=g)>=0&&b<=59?e*(f*d.s0+g*d.Cg):NaN}(o.timezone)))return new Date(NaN)}else{let a=new Date(p+q),b=new Date(0);return b.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),b.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),b}return new Date(p+q+e)}let f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},g=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,i=/^([+-])(\d{2})(?::?(\d{2}))?$/;function j(a){return a?parseInt(a):1}function k(a){return a&&parseFloat(a.replace(",","."))||0}let l=[31,null,31,30,31,30,31,31,30,31,30,31];function m(a){return a%400==0||a%4==0&&a%100!=0}},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32842:(a,b,c)=>{"use strict";c.d(b,{tU:()=>D,av:()=>G,j7:()=>E,Xi:()=>F});var d=c(21124),e=c(38301),f=c(87868),g=c(2332),h=c(88617),i=c(29988),j=c(6406),k=c(10498),l=c(11720),m=c(75656),n="Tabs",[o,p]=(0,g.A)(n,[h.RG]),q=(0,h.RG)(),[r,s]=o(n),t=e.forwardRef((a,b)=>{let{__scopeTabs:c,value:e,onValueChange:f,defaultValue:g,orientation:h="horizontal",dir:i,activationMode:o="automatic",...p}=a,q=(0,k.jH)(i),[s,t]=(0,l.i)({prop:e,onChange:f,defaultProp:g??"",caller:n});return(0,d.jsx)(r,{scope:c,baseId:(0,m.B)(),value:s,onValueChange:t,orientation:h,dir:q,activationMode:o,children:(0,d.jsx)(j.sG.div,{dir:q,"data-orientation":h,...p,ref:b})})});t.displayName=n;var u="TabsList",v=e.forwardRef((a,b)=>{let{__scopeTabs:c,loop:e=!0,...f}=a,g=s(u,c),i=q(c);return(0,d.jsx)(h.bL,{asChild:!0,...i,orientation:g.orientation,dir:g.dir,loop:e,children:(0,d.jsx)(j.sG.div,{role:"tablist","aria-orientation":g.orientation,...f,ref:b})})});v.displayName=u;var w="TabsTrigger",x=e.forwardRef((a,b)=>{let{__scopeTabs:c,value:e,disabled:g=!1,...i}=a,k=s(w,c),l=q(c),m=A(k.baseId,e),n=B(k.baseId,e),o=e===k.value;return(0,d.jsx)(h.q7,{asChild:!0,...l,focusable:!g,active:o,children:(0,d.jsx)(j.sG.button,{type:"button",role:"tab","aria-selected":o,"aria-controls":n,"data-state":o?"active":"inactive","data-disabled":g?"":void 0,disabled:g,id:m,...i,ref:b,onMouseDown:(0,f.mK)(a.onMouseDown,a=>{g||0!==a.button||!1!==a.ctrlKey?a.preventDefault():k.onValueChange(e)}),onKeyDown:(0,f.mK)(a.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&k.onValueChange(e)}),onFocus:(0,f.mK)(a.onFocus,()=>{let a="manual"!==k.activationMode;o||g||!a||k.onValueChange(e)})})})});x.displayName=w;var y="TabsContent",z=e.forwardRef((a,b)=>{let{__scopeTabs:c,value:f,forceMount:g,children:h,...k}=a,l=s(y,c),m=A(l.baseId,f),n=B(l.baseId,f),o=f===l.value,p=e.useRef(o);return e.useEffect(()=>{let a=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(a)},[]),(0,d.jsx)(i.C,{present:g||o,children:({present:c})=>(0,d.jsx)(j.sG.div,{"data-state":o?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":m,hidden:!c,id:n,tabIndex:0,...k,ref:b,style:{...a.style,animationDuration:p.current?"0s":void 0},children:c&&h})})});function A(a,b){return`${a}-trigger-${b}`}function B(a,b){return`${a}-content-${b}`}z.displayName=y;var C=c(44943);let D=t,E=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(v,{ref:c,className:(0,C.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));E.displayName=v.displayName;let F=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(x,{ref:c,className:(0,C.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));F.displayName=x.displayName;let G=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(z,{ref:c,className:(0,C.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));G.displayName=z.displayName},32925:(a,b,c)=>{Promise.resolve().then(c.bind(c,70777)),Promise.resolve().then(c.bind(c,6471))},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},37067:a=>{"use strict";a.exports=require("node:http")},37830:a=>{"use strict";a.exports=require("node:stream/web")},38522:a=>{"use strict";a.exports=require("node:zlib")},38710:(a,b,c)=>{"use strict";c.d(b,{ai:()=>f});var d=c(8567),e=c(55446);let f=(0,d.genkit)({plugins:[(0,e.YF)()],model:"googleai/gemini-1.5-flash"})},38994:(a,b,c)=>{Promise.resolve().then(c.bind(c,62660))},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},44708:a=>{"use strict";a.exports=require("node:https")},47002:a=>{function b(a){var b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b}b.keys=()=>[],b.resolve=b,b.id=47002,a.exports=b},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},56801:a=>{"use strict";a.exports=require("import-in-the-middle")},57075:a=>{"use strict";a.exports=require("node:stream")},57193:(a,b,c)=>{"use strict";c.d(b,{Separator:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call Separator() from the server but Separator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/components/ui/separator.tsx","Separator")},57975:a=>{"use strict";a.exports=require("node:util")},62660:(a,b,c)=>{"use strict";c.d(b,{default:()=>aa});var d=c(21124),e=c(38301),f=c.n(e),g=c(62186),h=c(35284),i=c(10656),j=c(79202),k=c(99187),l=c(63822),m=c(11563);let n=(0,c(8808).A)("CircleDotDashed",[["path",{d:"M10.1 2.18a9.93 9.93 0 0 1 3.8 0",key:"1qdqn0"}],["path",{d:"M17.6 3.71a9.95 9.95 0 0 1 2.69 2.7",key:"1bq7p6"}],["path",{d:"M21.82 10.1a9.93 9.93 0 0 1 0 3.8",key:"1rlaqf"}],["path",{d:"M20.29 17.6a9.95 9.95 0 0 1-2.7 2.69",key:"1xk03u"}],["path",{d:"M13.9 21.82a9.94 9.94 0 0 1-3.8 0",key:"l7re25"}],["path",{d:"M6.4 20.29a9.95 9.95 0 0 1-2.69-2.7",key:"1v18p6"}],["path",{d:"M2.18 13.9a9.93 9.93 0 0 1 0-3.8",key:"xdo6bj"}],["path",{d:"M3.71 6.4a9.95 9.95 0 0 1 2.7-2.69",key:"1jjmaz"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);var o=c(299),p=c(9517),q=c(90023),r=c(27810),s=c(44943),t=c(40068),u=c(37448),v=c(49113),w=c(85708);let x=(0,w.createServerReference)("60266b614460f4fd778e8111e66e4c8bff9744db3e",w.callServer,void 0,w.findSourceMapURL,"auditRemittance");var y=c(68254),z=c(68120);function A({remittance:a,onSuccess:b}){let[c,f]=(0,e.useState)(!1),[g,i]=(0,e.useState)(""),[j,k]=(0,e.useState)(!1),{toast:l}=(0,u.dj)(),m=async()=>{k(!0);let c=await x(a.id,g);c.success?(l({title:"تم تدقيق الحوالة بنجاح"}),b(),f(!1)):l({title:"خطأ",description:c.error,variant:"destructive"}),k(!1)};return(0,d.jsxs)(t.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(t.zM,{asChild:!0,children:(0,d.jsxs)(h.$,{variant:"outline",size:"sm",children:[(0,d.jsx)(o.A,{className:"me-2 h-4 w-4"})," تدقيق"]})}),(0,d.jsxs)(t.Cf,{children:[(0,d.jsxs)(t.c7,{children:[(0,d.jsx)(t.L3,{children:"تدقيق الحوالة"}),(0,d.jsx)(t.rr,{children:"تأكيد صحة بيانات الحوالة قبل إرسالها للاستلام."})]}),(0,d.jsx)("div",{className:"py-4 space-y-4",children:(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(z.J,{htmlFor:"audit-notes",children:"ملاحظات التدقيق (اختياري)"}),(0,d.jsx)(y.T,{id:"audit-notes",value:g,onChange:a=>i(a.target.value)})]})}),(0,d.jsx)(t.Es,{children:(0,d.jsxs)(h.$,{onClick:m,disabled:j,children:[j&&(0,d.jsx)(v.A,{className:"me-2 h-4 w-4 animate-spin"}),"تأكيد التدقيق"]})})]})]})}let B=(0,w.createServerReference)("60c7ace3c7601560697ba8ea1632ea71447c0b65ec",w.callServer,void 0,w.findSourceMapURL,"receiveRemittance");var C=c(45608);function D({remittance:a,onSuccess:b}){let[c,f]=(0,e.useState)(!1),[g,i]=(0,e.useState)(a.boxId),[j,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)([]),{toast:n}=(0,u.dj)(),o=async()=>{if(!g)return void n({title:"الرجاء اختيار الصندوق",variant:"destructive"});k(!0);let c=await B(a,g);c.success?(n({title:"تم استلام الحوالة وتسجيل سند القبض بنجاح"}),b(),f(!1)):n({title:"خطأ",description:c.error,variant:"destructive"}),k(!1)};return(0,d.jsxs)(t.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(t.zM,{asChild:!0,children:(0,d.jsxs)(h.$,{size:"sm",children:[(0,d.jsx)(p.A,{className:"me-2 h-4 w-4"})," تأكيد الاستلام"]})}),(0,d.jsxs)(t.Cf,{children:[(0,d.jsxs)(t.c7,{children:[(0,d.jsx)(t.L3,{children:"تأكيد استلام الحوالة"}),(0,d.jsx)(t.rr,{children:'سيؤدي هذا الإجراء إلى تغيير حالة الحوالة إلى "مستلمة" وإنشاء سند قبض تلقائي بالمبلغ في الصندوق المحدد.'})]}),(0,d.jsx)("div",{className:"py-4 space-y-4",children:(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(z.J,{children:"الصندوق"}),(0,d.jsxs)(C.l6,{value:g,onValueChange:i,children:[(0,d.jsx)(C.bq,{children:(0,d.jsx)(C.yv,{placeholder:"اختر صندوقًا..."})}),(0,d.jsx)(C.gC,{children:l.map(a=>(0,d.jsx)(C.eb,{value:a.id,children:a.name},a.id))})]})]})}),(0,d.jsx)(t.Es,{children:(0,d.jsxs)(h.$,{onClick:o,disabled:j||!g,children:[j&&(0,d.jsx)(v.A,{className:"me-2 h-4 w-4 animate-spin"}),"تأكيد الاستلام"]})})]})]})}c(79994);var E=c(97802),F=c(12495);let G={pending_audit:{label:"بانتظار التدقيق",icon:n,className:"bg-yellow-100 text-yellow-800"},pending_reception:{label:"بانتظار الاستلام",icon:o.A,className:"bg-blue-100 text-blue-800"},received:{label:"مستلمة",icon:p.A,className:"bg-green-100 text-green-800"}};function H({remittances:a,onSuccess:b}){let{data:c,loaded:f}=(0,E.Z)(),g=(0,e.useMemo)(()=>new Map(c?.users?.map(a=>[a.uid,a.name])),[c?.users]),i=(0,e.useMemo)(()=>new Map(c?.boxes?.map(a=>[a.id,a.name])),[c?.boxes]);return f?(0,d.jsx)("div",{className:"border rounded-lg overflow-x-auto",children:(0,d.jsxs)(j.XI,{children:[(0,d.jsx)(j.A0,{children:(0,d.jsxs)(j.Hj,{children:[(0,d.jsx)(j.nd,{children:"التاريخ"}),(0,d.jsx)(j.nd,{children:"الشركة"}),(0,d.jsx)(j.nd,{children:"المكتب"}),(0,d.jsx)(j.nd,{children:"المبلغ (USD)"}),(0,d.jsx)(j.nd,{children:"المبلغ (IQD)"}),(0,d.jsx)(j.nd,{children:"الصندوق"}),(0,d.jsx)(j.nd,{children:"الحالة"}),(0,d.jsx)(j.nd,{children:"الإجراءات"})]})}),(0,d.jsx)(j.BF,{children:0===a.length?(0,d.jsx)(j.Hj,{children:(0,d.jsx)(j.nA,{colSpan:8,className:"h-24 text-center",children:"لا توجد حوالات لعرضها."})}):a.map(a=>{let c=G[a.status],e=g.get(a.assignedToUid)||"غير معروف",f=i.get(a.boxId)||"غير معروف";return(0,d.jsxs)(j.Hj,{children:[(0,d.jsxs)(j.nA,{children:[(0,d.jsx)("div",{className:"font-medium",children:a.createdAt?(0,l.GP)(new Date(a.createdAt),"yyyy-MM-dd"):"-"}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:["بواسطة: ",a.createdBy]})]}),(0,d.jsx)(j.nA,{children:a.companyName}),(0,d.jsx)(j.nA,{children:a.officeName}),(0,d.jsx)(j.nA,{className:"font-mono text-right",children:a.totalAmountUsd?.toLocaleString()}),(0,d.jsx)(j.nA,{className:"font-mono text-right",children:a.totalAmountIqd?.toLocaleString()}),(0,d.jsxs)(j.nA,{children:[(0,d.jsx)("div",{children:f}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:["المخول: ",e]})]}),(0,d.jsx)(j.nA,{children:(0,d.jsxs)(k.E,{variant:"outline",className:(0,s.cn)("gap-1.5",c.className),children:[(0,d.jsx)(c.icon,{className:"h-3 w-3"}),c.label]})}),(0,d.jsx)(j.nA,{children:(0,d.jsxs)(m.rI,{children:[(0,d.jsx)(m.ty,{asChild:!0,children:(0,d.jsx)(h.$,{variant:"ghost",size:"icon",children:(0,d.jsx)(q.A,{className:"h-4 w-4"})})}),(0,d.jsxs)(m.SQ,{children:["pending_audit"===a.status&&(0,d.jsx)(m._2,{asChild:!0,children:(0,d.jsx)(A,{remittance:a,onSuccess:b})}),"pending_reception"===a.status&&(0,d.jsx)(m._2,{asChild:!0,children:(0,d.jsx)(D,{remittance:a,onSuccess:b})}),"received"!==a.status&&(0,d.jsx)(F.A,{isEditing:!0,initialData:a,onSaveSuccess:b,children:(0,d.jsxs)(m._2,{onSelect:a=>a.preventDefault(),children:[(0,d.jsx)(r.A,{className:"me-2 h-4 w-4"})," تعديل"]})}),(0,d.jsx)(m._2,{className:"text-destructive focus:text-destructive",children:"حذف"})]})]})})]},a.id)})})]})}):(0,d.jsx)("div",{className:"text-center p-8",children:"جاري تحميل البيانات..."})}var I=c(93758),J=c(40822),K=c(51886),L=c(65409),M=c(72001),N=c(32842);let O=({items:a,onItemsChange:b,placeholder:c})=>(0,d.jsxs)("div",{className:"space-y-2",children:[a.map((c,e)=>(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(I.p,{value:c,onChange:c=>b((0,M.jM)(a,a=>{a[e]=c.target.value}))}),(0,d.jsx)(h.$,{variant:"ghost",size:"icon",className:"h-9 w-9 text-destructive",onClick:()=>b(a.filter((a,b)=>b!==e)),children:(0,d.jsx)(J.A,{className:"h-4 w-4"})})]},e)),(0,d.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>b([...a,""]),children:[(0,d.jsx)(i.A,{className:"me-2 h-4 w-4"})," إضافة ",c]})]});function P({initialSettings:a,onSuccess:b}){let[c,f]=(0,e.useState)(!1),[g,i]=(0,e.useState)(!1),{toast:j}=(0,u.dj)(),[k,l]=(0,e.useState)(a),m=async()=>{k&&(i(!0),(await (0,L.X)({remittanceSettings:k})).success?(j({title:"تم حفظ الإعدادات"}),b(),f(!1)):j({title:"خطأ",description:"Failed to save settings.",variant:"destructive"}),i(!1))};return(0,d.jsxs)(t.lG,{open:c,onOpenChange:f,children:[(0,d.jsx)(t.zM,{asChild:!0,children:(0,d.jsxs)(h.$,{variant:"outline",children:[(0,d.jsx)(K.A,{className:"me-2 h-4 w-4"})," الإعدادات"]})}),(0,d.jsxs)(t.Cf,{className:"max-w-3xl",children:[(0,d.jsxs)(t.c7,{children:[(0,d.jsx)(t.L3,{children:"إعدادات الحوالات"}),(0,d.jsx)(t.rr,{children:"إدارة المكاتب وطرق التحويل وأعمدة توزيع المبالغ المخصصة."})]}),k?(0,d.jsxs)(N.tU,{defaultValue:"offices",className:"w-full",children:[(0,d.jsxs)(N.j7,{className:"grid w-full grid-cols-4",children:[(0,d.jsx)(N.Xi,{value:"offices",children:"المكاتب"}),(0,d.jsx)(N.Xi,{value:"methods",children:"طرق التحويل"}),(0,d.jsx)(N.Xi,{value:"dist_usd",children:"توزيع USD"}),(0,d.jsx)(N.Xi,{value:"dist_iqd",children:"توزيع IQD"})]}),(0,d.jsx)(N.av,{value:"offices",children:(0,d.jsx)(O,{items:k.offices,onItemsChange:a=>l(b=>b?{...b,offices:a.filter(Boolean)}:null),placeholder:"مكتب"})}),(0,d.jsx)(N.av,{value:"methods",children:(0,d.jsx)(O,{items:k.methods,onItemsChange:a=>l(b=>b?{...b,methods:a.filter(Boolean)}:null),placeholder:"طريقة"})}),(0,d.jsx)(N.av,{value:"dist_usd",children:(0,d.jsx)(O,{items:(k.distributionColumnsUsd||[]).map(a=>a.label),onItemsChange:a=>l(b=>b?{...b,distributionColumnsUsd:a.filter(Boolean).map((a,b)=>({id:`usd_col_${b}`,label:a}))}:null),placeholder:"حقل"})}),(0,d.jsx)(N.av,{value:"dist_iqd",children:(0,d.jsx)(O,{items:(k.distributionColumnsIqd||[]).map(a=>a.label),onItemsChange:a=>l(b=>b?{...b,distributionColumnsIqd:a.filter(Boolean).map((a,b)=>({id:`iqd_col_${b}`,label:a}))}:null),placeholder:"حقل"})})]}):(0,d.jsx)("div",{className:"flex justify-center p-8",children:(0,d.jsx)(v.A,{className:"animate-spin"})}),(0,d.jsx)(t.Es,{children:(0,d.jsxs)(h.$,{onClick:m,disabled:g||!k,children:[g&&(0,d.jsx)(v.A,{className:"me-2 h-4 w-4 animate-spin"}),"حفظ الإعدادات"]})})]})]})}var Q=c(59901),R=c(49566);let S=(0,w.createServerReference)("404a94dfe04fe7c955d488cb56135349bb06d8e5d6",w.callServer,void 0,w.findSourceMapURL,"analyzeRemittanceText");var T=c(31980),U=c(99546),V=c(50937),W=c(27186),X=c(88580),Y=c(63009),Z=c(21853);let $=U.Ik({companyName:U.Yj().min(1,"اسم الشركة مطلوب"),officeName:U.Yj().min(1,"اسم المكتب مطلوب"),method:U.Yj().min(1,"طريقة التحويل مطلوبة"),assignedToUid:U.Yj().min(1,"المخول بالاستلام مطلوب"),boxId:U.Yj().min(1,"الصندوق المستلم مطلوب"),totalAmountUsd:U.au.number().default(0),totalAmountIqd:U.au.number().default(0),notes:U.Yj().optional()});function _({remittanceSettings:a,onRemittanceAdded:b}){let[c,i]=(0,e.useState)(null),[j,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)(""),{toast:n}=(0,u.dj)(),{data:o}=(0,E.Z)(),{user:p}=(0,Y.A)(),q=f().useMemo(()=>(o?.users||[]).map(a=>({value:a.uid,label:a.name})),[o?.users]),r=(0,T.mN)({resolver:(0,V.u)($),defaultValues:{totalAmountUsd:void 0,totalAmountIqd:void 0}}),s=async()=>{if(!l.trim())return void n({title:"الرجاء إدخال نص الحوالة.",variant:"destructive"});k(!0),i(null);try{let a=await S({messageText:l});i(a),r.reset({companyName:a.companyName,method:a.method,notes:a.notes,totalAmountUsd:"dollar"===a.currency?a.amount:void 0,totalAmountIqd:"dinar"===a.currency?a.amount:void 0,officeName:"",assignedToUid:"",boxId:p&&"role"in p?p.boxId:""})}catch(a){n({title:"خطأ في التحليل",description:a.message,variant:"destructive"})}finally{k(!1)}},t=async a=>{let c=await (0,X.Q)({...a,distribution:{},totalAmountUsd:a.totalAmountUsd||0,totalAmountIqd:a.totalAmountIqd||0});c.success&&c.newRemittance?(n({title:"تمت إضافة الحوالة بنجاح"}),b(c.newRemittance),i(null),m(""),r.reset()):n({title:"خطأ",description:c.error,variant:"destructive"})};return(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{children:[(0,d.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(Q.A,{className:"h-5 w-5 text-primary"}),"الإدخال الذكي للحوالات"]}),(0,d.jsx)(g.BT,{children:"أدخل نص الحوالة كما تكتبه في واتساب، وسيقوم النظام بتحليله."})]}),(0,d.jsxs)(g.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(z.J,{htmlFor:"remittance-text",children:"نص الحوالة"}),(0,d.jsx)(y.T,{id:"remittance-text",placeholder:"مثال: فيوجر فلاي 720.000 ماستر",rows:4,value:l,onChange:a=>m(a.target.value)})]}),(0,d.jsxs)(h.$,{onClick:s,disabled:j||!l.trim(),className:"w-full",children:[j?(0,d.jsx)(v.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,d.jsx)(Q.A,{className:"me-2 h-4 w-4"}),"تحليل النص"]}),c&&(0,d.jsx)(W.lV,{...r,children:(0,d.jsxs)("form",{onSubmit:r.handleSubmit(t),className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[(0,d.jsx)(W.zB,{control:r.control,name:"companyName",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"الشركة"}),(0,d.jsx)(W.MJ,{children:(0,d.jsx)(Z.j,{searchAction:"all",value:a.value,onValueChange:a.onChange})}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsx)(W.zB,{control:r.control,name:"totalAmountUsd",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"المبلغ (USD)"}),(0,d.jsx)(W.MJ,{children:(0,d.jsx)(I.p,{type:"number",...a,value:a.value||""})}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsx)(W.zB,{control:r.control,name:"totalAmountIqd",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"المبلغ (IQD)"}),(0,d.jsx)(W.MJ,{children:(0,d.jsx)(I.p,{type:"number",...a,value:a.value||""})}),(0,d.jsx)(W.C5,{})]})})]}),(0,d.jsx)(W.zB,{control:r.control,name:"method",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"الطريقة"}),(0,d.jsx)(W.MJ,{children:(0,d.jsx)(I.p,{...a})}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsx)(W.zB,{control:r.control,name:"officeName",render:({field:b})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"المكتب"}),(0,d.jsxs)(C.l6,{onValueChange:b.onChange,value:b.value,children:[(0,d.jsx)(W.MJ,{children:(0,d.jsx)(C.bq,{children:(0,d.jsx)(C.yv,{placeholder:"اختر المكتب..."})})}),(0,d.jsx)(C.gC,{children:a.offices.map(a=>(0,d.jsx)(C.eb,{value:a,children:a},a))})]}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsx)(W.zB,{control:r.control,name:"assignedToUid",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"المخول بالاستلام"}),(0,d.jsxs)(C.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(W.MJ,{children:(0,d.jsx)(C.bq,{children:(0,d.jsx)(C.yv,{placeholder:"اختر موظفًا..."})})}),(0,d.jsx)(C.gC,{children:q.map(a=>(0,d.jsx)(C.eb,{value:a.value,children:a.label},a.value))})]}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsx)(W.zB,{control:r.control,name:"boxId",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"الصندوق المستلم"}),(0,d.jsxs)(C.l6,{onValueChange:a.onChange,value:a.value,children:[(0,d.jsx)(W.MJ,{children:(0,d.jsx)(C.bq,{children:(0,d.jsx)(C.yv,{placeholder:"اختر صندوقًا..."})})}),(0,d.jsx)(C.gC,{children:(o?.boxes||[]).map(a=>(0,d.jsx)(C.eb,{value:a.id,children:a.name},a.id))})]}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsx)(W.zB,{control:r.control,name:"notes",render:({field:a})=>(0,d.jsxs)(W.eI,{children:[(0,d.jsx)(z.J,{children:"ملاحظات"}),(0,d.jsx)(W.MJ,{children:(0,d.jsx)(y.T,{...a})}),(0,d.jsx)(W.C5,{})]})}),(0,d.jsxs)(h.$,{type:"submit",disabled:r.formState.isSubmitting,className:"w-full",children:[r.formState.isSubmitting?(0,d.jsx)(v.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,d.jsx)(R.A,{className:"me-2 h-4 w-4"}),"حفظ الحوالة"]})]})})]})]})}function aa({initialRemittances:a,onDataChange:b}){let[c,f]=(0,e.useState)(a),{data:j,loaded:k}=(0,E.Z)(),l=j?.settings?.remittanceSettings,m=a=>{f((0,M.jM)(b=>{b.unshift(a)})),b()};return k&&l?(0,d.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-[1fr,500px] gap-6 items-start",children:[(0,d.jsx)("div",{className:"space-y-6",children:(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(g.ZB,{children:"سجل الحوالات"}),(0,d.jsx)(g.BT,{children:"آخر الحوالات التي تم تسجيلها في النظام."})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(P,{initialSettings:l,onSuccess:b}),(0,d.jsx)(F.A,{onRemittanceAdded:m,children:(0,d.jsxs)(h.$,{children:[(0,d.jsx)(i.A,{className:"me-2 h-4 w-4"}),"إضافة يدوية"]})})]})]}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)(H,{remittances:c,onSuccess:b})})]})}),(0,d.jsx)("div",{className:"xl:sticky top-20",children:(0,d.jsx)(_,{remittanceSettings:l,onRemittanceAdded:m})})]}):(0,d.jsx)("div",{children:"جاري تحميل الإعدادات..."})}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63195:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/accounts/remittances/components/remittances-content.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/accounts/remittances/components/remittances-content.tsx","default")},64653:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g});var d=c(75338),e=c(57193),f=c(86183);function g({children:a}){return(0,d.jsx)("div",{className:"w-full",children:(0,d.jsxs)("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-4 p-4 sm:p-6",children:[(0,d.jsx)(f.default,{}),(0,d.jsx)(e.Separator,{}),(0,d.jsx)("div",{className:"pb-8",children:a})]})})}},67647:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["accounts",{children:["remittances",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,96920)),"/home/user/studio/src/app/accounts/remittances/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,64653)),"/home/user/studio/src/app/accounts/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"/home/user/studio/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["/home/user/studio/src/app/accounts/remittances/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/accounts/remittances/page",pathname:"/accounts/remittances",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/accounts/remittances/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},68162:(a,b,c)=>{"use strict";c.d(b,{Fc:()=>i,TN:()=>k,XL:()=>j});var d=c(75338),e=c(74515),f=c(86281),g=c(70673);let h=(0,f.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=e.forwardRef(({className:a,variant:b,...c},e)=>(0,d.jsx)("div",{ref:e,role:"alert",className:(0,g.cn)(h({variant:b}),a),...c}));i.displayName="Alert";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h5",{ref:c,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",a),...b}));j.displayName="AlertTitle";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",a),...b}));k.displayName="AlertDescription"},69769:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{"006a7d18b222ac9fd27f636e3f60be09c88c550762":()=>i.ib,"400c0115434cd29d4eca4428f9840cb7a074049ed1":()=>k.EZ,"400c84b00cbc18181ec896b17d3329ab44688122ee":()=>n.q,"400e621b7f78c4800cffc85d668ca10cd73eb6853c":()=>e.Lf,"4013135d45b93942093eced825516b1e20941831b7":()=>m.d,"401b140032a44590c12253e287a8d7d0383408525e":()=>f.lc,"40211bb4321aca8530a09b81e44f46cc59da30c2c4":()=>k.KB,"403331dfc341d9a7f9cbe156b5d10cfd49a20be531":()=>e.d5,"40341251e8d632597ecf83a7ab87f3793a83f06b51":()=>l.r,"403c01bdb267219d16430eb023611daabec8b63ec8":()=>g.nX,"404a94dfe04fe7c955d488cb56135349bb06d8e5d6":()=>o.Q,"405181b3416ca6fb6435ab9096a0a68342e5255501":()=>h.u,"405872236907704344162aca1c38160d1eac727fe8":()=>e.DI,"405ce651eeff5dd6c93f3965b62049b45a42e5a7d4":()=>g.LD,"406c8a5fa8b6f219b1d6c0d2ed6d4215e348e5c534":()=>k.Lf,"407ad343a0d07dddd296d749ab0d60ad67dfc5bb39":()=>g.rC,"4085652545b10cc37283ef55992935bd43a8ce947e":()=>e.zZ,"408c54ad33973364b68d8475849f76b4a4ca590722":()=>e.EP,"408c94c431661ae65070856bc4a78d84f2cbfcba1c":()=>e.EZ,"40939e0ffddd5729906956a18bd5a10b991b0ccc8b":()=>k.d5,"409ba91156ff082c07d90f218ef67bfea8be50f67c":()=>k.DI,"409ee2d098a25e0103bd4e5cbd3c84c821bce98df9":()=>f.fW,"40b3f399476b2e0c0084bb235048022f7151d8d61a":()=>i.Qt,"40c15e87ca74d3ad5ae09fdc0c6d9616384469f25f":()=>j._,"40c58d0bc8d4f91d67a942b18e51dcb1bf43076f6e":()=>k.zZ,"40d0448bacb32a373d23394258f9e7de4aa7fd38a9":()=>k.EP,"40f4619201eea9704cbf15357e730e9458fc66e834":()=>e.KB,"6011fc1c38056bdf4ffec77b46cde7479e7bed0ffe":()=>g.vL,"6023146a7bfefc423ba02712c56694a31432de707c":()=>e.zO,"6052254d233f0ea6b36992b2b81ce07178dee95ad7":()=>i.oS,"6073e98acf09f5000817ebcdd05234acc9c4d29f85":()=>f.rj,"60e34f9cbe57141cf2262bc166578e2d558a98e99f":()=>k.zO,"60eed12072721bc1c2c48214672b423b5d4cc8a6f3":()=>j.L,"7003bafa516cae88838b2870c227bb8f7b1ef595ec":()=>g.Nb,"70303f32e5ed8b56558bdc328a329d038fd2e61ace":()=>g.I0,"7036a92c4c51de937e481f7c0d6bc541b735f99157":()=>g.k5,"704baf0749912d6e636a66524e43f80ce5c8454d38":()=>g.xo,"70a2ee919f2d86ac514a326d140a0804c759a4d955":()=>g.Kq,"7efe1f798361b3ef301fd7b48f8f3206292a2cecba":()=>g.AZ,"7f085acd10c7b589563e59e7e18d605a9cf6eb6b56":()=>f.cl,"7f4fa596b78e1050be57bd23eeef63bf754e59a5c8":()=>i.xi,"7f56b7b077f6ef503c674aaefafd2b7951d91adaa8":()=>g.LQ,"7fbd1d6bc63ebe1b1eeb689b35afc9c8cba834559f":()=>g.f9,"7fc073ecd1a2a3a687a33b240d39c28a9944119247":()=>i.Z7,"7fff34be9ad53d22bcedbe289fd19cffbcbb61a920":()=>g.ro});var e=c(95378),f=c(94762),g=c(24799),h=c(28541),i=c(18210),j=c(87965),k=c(39661),l=c(13732),m=c(40982),n=c(33875),o=c(20641),p=a([e,f,g,h,i,j,k,l,m,n]);[e,f,g,h,i,j,k,l,m,n]=p.then?(await p)():p,d()}catch(a){d(a)}})},70673:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f});var d=c(81171),e=c(11167);function f(...a){return(0,e.QP)((0,d.$)(a))}},70777:(a,b,c)=>{"use strict";c.d(b,{default:()=>o});var d=c(21124),e=c(3991),f=c.n(e),g=c(42378),h=c(34118),i=c(91779),j=c(77249),k=c(63198),l=c(51886),m=c(44943);let n=[{href:"/accounts",label:"مركز الحسابات",icon:h.A,isActive:a=>"/accounts"===a},{href:"/accounts/remittances",label:"الحوالات",icon:i.A,isActive:a=>a.startsWith("/accounts/remittances")},{href:"/accounts/vouchers",label:"السندات",icon:j.A,isActive:a=>a.startsWith("/accounts/vouchers")},{href:"/finance/overview",label:"النظرة المالية",icon:k.A,isActive:a=>a.startsWith("/finance/overview")},{href:"/settings/accounting",label:"الإعدادات المحاسبية",icon:l.A,isActive:a=>a.startsWith("/settings/accounting")}];function o(){let a=(0,g.usePathname)();return(0,d.jsx)("nav",{"aria-label":"التنقل بين صفحات الحسابات",className:"flex flex-wrap justify-end gap-2",children:n.map(b=>{let c=b.isActive(a);return(0,d.jsxs)(f(),{href:b.href,className:(0,m.cn)("flex items-center gap-2 rounded-full border px-4 py-2 text-sm font-medium transition-colors",c?"border-primary bg-primary text-primary-foreground shadow":"border-muted-foreground/20 text-muted-foreground hover:border-primary/40 hover:bg-primary/5 hover:text-foreground"),children:[(0,d.jsx)("span",{className:"truncate",children:b.label}),(0,d.jsx)(b.icon,{className:"h-4 w-4"})]},b.href)})})}},73024:a=>{"use strict";a.exports=require("node:fs")},73136:a=>{"use strict";a.exports=require("node:url")},73496:a=>{"use strict";a.exports=require("http2")},73566:a=>{"use strict";a.exports=require("worker_threads")},74075:a=>{"use strict";a.exports=require("zlib")},74998:a=>{"use strict";a.exports=require("perf_hooks")},76760:a=>{"use strict";a.exports=require("node:path")},77030:a=>{"use strict";a.exports=require("node:net")},77598:a=>{"use strict";a.exports=require("node:crypto")},79202:(a,b,c)=>{"use strict";c.d(b,{A0:()=>h,BF:()=>i,Gg:()=>j,Hj:()=>k,XI:()=>g,nA:()=>m,nd:()=>l});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{className:"relative w-full overflow-auto",children:(0,d.jsx)("table",{ref:c,className:(0,f.cn)("w-full caption-bottom text-sm",a),...b})}));g.displayName="Table";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("thead",{ref:c,className:(0,f.cn)("[&_tr]:border-b",a),...b}));h.displayName="TableHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tbody",{ref:c,className:(0,f.cn)("[&_tr:last-child]:border-0",a),...b}));i.displayName="TableBody";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tfoot",{ref:c,className:(0,f.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...b}));j.displayName="TableFooter";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tr",{ref:c,className:(0,f.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));k.displayName="TableRow";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("th",{ref:c,className:(0,f.cn)("h-12 px-4 text-right align-middle font-bold text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...b}));l.displayName="TableHead";let m=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("td",{ref:c,className:(0,f.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...b}));m.displayName="TableCell",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("caption",{ref:c,className:(0,f.cn)("mt-4 text-sm text-muted-foreground",a),...b})).displayName="TableCaption"},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},79748:a=>{"use strict";a.exports=require("fs/promises")},81630:a=>{"use strict";a.exports=require("http")},84297:a=>{"use strict";a.exports=require("async_hooks")},84440:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{"0004c295195cb02aa74b7e03b9ab47835262f651f3":()=>j._u,"00454095f373f8afcf3cd8b88a3e9643ba6181edb6":()=>h.y4,"005773e734ccf3535fa61ed9b34042d47625b1ede6":()=>i.O0,"0079928ff14026085419c5483c28b98ee3311389f6":()=>g.$E,"0084d26686615403d39adac4c095e2f442ed3af27d":()=>g.iS,"008e375b291b129374a1d717237693fdb7fe3fee4e":()=>e.$$RSC_SERVER_ACTION_0,"009e84f93947e0a432e28675ea07a71949bfe66943":()=>g.Lf,"00afcee30c25fc6521aeaf596fabd0fef5e0ca707f":()=>i.qV,"00d790a9c67325f46e1dda5ba33e59ecfd95062466":()=>h.HW,"00f8105cf2df698dda196c821059bffd2c12bb65d6":()=>l.fO,"40213622e57351942781ff52345df063ded4056884":()=>h.Sm,"40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3":()=>i.lo,"406818275705b776627a9e14558eaa7857fbec9b73":()=>i.ht,"4085aac590f12a4a641b5bc7fff47d5353af49510e":()=>h.S,"408c79ddd0d0a9122724301d14534a0975eed69018":()=>f.Qp,"408d4523c5fa8dbd353900a15d896d0ebee083358b":()=>h.X7,"40ae79a531e9ac50ecc04279061a2192af6e60d6f4":()=>k.iL,"40bd3493b6cd183a3f75aa7b2dffe9f325b07a2b9d":()=>j.Xx,"40d4790cf5bfe15d462399ad8c52d1baec8babf86f":()=>i.nu,"40e13d085ff779b8dfbb82e790ebb21702ce079192":()=>i.Cm,"40ef77a697a84cf599002575e6afc4c1de58c3cdab":()=>i.hG,"40f3e2b0ca2e561c506ffb1575ff80c4dac60766e4":()=>l.tu,"40fc6757a7ed8ba6cf86a7bf30e6bf0934f153f439":()=>h.Lx,"601532f3b7a46dae258a5ff32f14fb4b3e2e141e9f":()=>i.TK,"601838acb9f969bfd30fa9f583c86dd453b19524dd":()=>i.v_,"60266b614460f4fd778e8111e66e4c8bff9744db3e":()=>f.eA,"60bfff327e3bf73dac5fa7bb6d2690e1fed6e5cf56":()=>l.PR,"60c7862a4ca16493782c4d556b1c72f9ee8d90ed17":()=>f.Ww,"60c7ace3c7601560697ba8ea1632ea71447c0b65ec":()=>f.Uo,"7f06d4b21a91bbe15e581c350a136426169075ee5f":()=>k.oH,"7f33ef79ae72de1c2db1340cf81f1c0a0a525a8033":()=>h.kl,"7f33fcd02c8b1dfc136d21fd7035ce40fe2d48b135":()=>h.ht,"7f7cc5ac28f76953e580388c96325185bdb57f592c":()=>h.EZ,"7faf63d9d8686c0ff053833c82fd60b3e9c6fa0bff":()=>h.$T,"7fd691cbe2382ade3c2dc739956026d2c3c806df06":()=>k.t6,"7fe304717562da7e993bf1bc3e43f26d6024716c28":()=>f.UR,"7fe3cedf8b5b39f6ca6561f08402f1ad7a82ecff97":()=>j.mt});var e=c(96920),f=c(94848),g=c(43513),h=c(33152),i=c(40776),j=c(46587),k=c(86988),l=c(97842),m=a([e,f,g,h,i,j,k,l]);[e,f,g,h,i,j,k,l]=m.then?(await m)():m,d()}catch(a){d(a)}})},86183:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/accounts/components/accounts-nav-tabs.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/accounts/components/accounts-nav-tabs.tsx","default")},86281:(a,b,c)=>{"use strict";c.d(b,{F:()=>g});var d=c(81171);let e=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,f=d.$,g=(a,b)=>c=>{var d;if((null==b?void 0:b.variants)==null)return f(a,null==c?void 0:c.class,null==c?void 0:c.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==c?void 0:c[a],d=null==h?void 0:h[a];if(null===b)return null;let f=e(b)||e(d);return g[a][f]}),j=c&&Object.entries(c).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return f(a,i,null==b||null==(d=b.compoundVariants)?void 0:d.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==c?void 0:c.class,null==c?void 0:c.className)}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87604:(a,b,c)=>{"use strict";c.d(b,{A:()=>h});var d=c(74515);let e=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var f={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let g=(0,d.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:c=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,d.createElement)("svg",{ref:l,...f,width:b,height:b,stroke:a,strokeWidth:g?24*Number(c)/Number(b):c,className:e("lucide",h),...k},[...j.map(([a,b])=>(0,d.createElement)(a,b)),...Array.isArray(i)?i:[i]])),h=(a,b)=>{let c=(0,d.forwardRef)(({className:c,...f},h)=>(0,d.createElement)(g,{ref:h,iconNode:b,className:e(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,c),...f}));return c.displayName=`${a}`,c}},90023:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},91645:a=>{"use strict";a.exports=require("net")},91779:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]])},94735:a=>{"use strict";a.exports=require("events")},94848:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Qp:()=>n,UR:()=>t,Uo:()=>p,Ww:()=>q,eA:()=>o});var e=c(75879);c(68633);var f=c(43513),g=c(16780),h=c(33152),i=c(46587),j=c(97842),k=c(86988),l=c(51669),m=a([f,h,i,j,k]);[f,h,i,j,k]=m.then?(await m)():m;let r=a=>{if(!a)return;if("function"==typeof a.toDate)return a.toDate().toISOString();if("string"==typeof a)try{if(!isNaN(Date.parse(a)))return a}catch(a){}let b=new Date(a);if(!isNaN(b.getTime()))return b.toISOString()},s=a=>{let b=a.data();return{...b,id:a.id,createdAt:r(b.createdAt),updatedAt:r(b.updatedAt),auditedAt:r(b.auditedAt),receivedAt:r(b.receivedAt)}},t=async()=>{let a=await (0,i.mt)();if(!a.databaseStatus?.isDatabaseConnected)return console.log("Database connection is disabled in settings. Skipping getRemittances fetch."),[];let b=await (0,f.Lf)();if(!b)return[];try{let a=await b.collection("remittances").orderBy("createdAt","desc").get();if(a.empty)return[];return a.docs.map(s)}catch(a){return console.error("Error getting remittances from Firestore: ",String(a)),[]}};async function n(a){let b=await (0,h.$T)();if(!b)return{success:!1,error:"User not authenticated."};let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};try{let d=c.collection("remittances").doc(),e={...a,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:b.name,status:"pending_audit",isAudited:!1};await d.set(e),await (0,k.iL)({userId:b.uid,userName:b.name,action:"CREATE",targetType:"VOUCHER",description:`أضاف حوالة جديدة من ${a.companyName} بمبلغ ${a.totalAmountUsd>0?`${a.totalAmountUsd} USD`:`${a.totalAmountIqd} IQD`}.`}),(0,g.revalidatePath)("/accounts/remittances");let f={id:d.id,...e};return{success:!0,newRemittance:f}}catch(a){return console.error("Error adding remittance: ",String(a)),{success:!1,error:"Failed to add remittance."}}}async function o(a,b){let c=await (0,h.$T)();if(!c)return{success:!1,error:"User not authenticated."};let d=await (0,f.Lf)();if(!d)return{success:!1,error:"Database not available."};try{let e=d.collection("remittances").doc(a);return await e.update({status:"pending_reception",isAudited:!0,auditedBy:c.name,auditedAt:new Date().toISOString(),updatedAt:new Date().toISOString(),auditNotes:b}),await (0,k.iL)({userId:c.uid,userName:c.name,action:"APPROVE",targetType:"VOUCHER",description:`دقق الحوالة رقم ${a}.`}),(0,g.revalidatePath)("/accounts/remittances"),{success:!0}}catch(a){return console.error("Error auditing remittance: ",String(a)),{success:!1,error:"Failed to audit remittance."}}}async function p(a,b){let c=await (0,h.$T)();if(!c)return{success:!1,error:"User not authenticated."};let d=await (0,f.Lf)();if(!d)return{success:!1,error:"Database not available."};let e=d.batch(),i=d.collection("remittances").doc(a.id);e.update(i,{status:"received",receivedBy:c.name,receivedAt:new Date().toISOString(),updatedAt:new Date().toISOString()});let l=d.collection("journal-vouchers").doc(),m={invoiceNumber:await (0,j.tu)("TR"),date:new Date().toISOString(),currency:a.totalAmountUsd>0?"USD":"IQD",exchangeRate:null,notes:`استلام حوالة من مكتب ${a.officeName}`,createdBy:c.uid,officer:c.name,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),voucherType:"journal_from_remittance",debitEntries:[{accountId:b,amount:a.totalAmountUsd>0?a.totalAmountUsd:a.totalAmountIqd,description:`ايداع حوالة من ${a.companyName}`}],creditEntries:[{accountId:`remittance_source_${a.officeName.toLowerCase()}`,amount:a.totalAmountUsd>0?a.totalAmountUsd:a.totalAmountIqd,description:`من حساب مكتب ${a.officeName}`}],isAudited:!0,isConfirmed:!0,originalData:a};e.set(l,m);try{return await e.commit(),await (0,k.iL)({userId:c.uid,userName:c.name,action:"APPROVE",targetType:"VOUCHER",description:`استلم الحوالة رقم ${a.id} وأنشأ سندًا مرافقًا.`}),(0,g.revalidatePath)("/accounts/remittances"),(0,g.revalidatePath)("/accounts/vouchers/list"),{success:!0}}catch(a){return console.error("Error receiving remittance:",String(a)),{success:!1,error:"Failed to process remittance reception."}}}async function q(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};let d=await (0,h.$T)();if(!d)return{success:!1,error:"User not authenticated."};try{return await c.collection("remittances").doc(a).update({...b,updatedAt:new Date().toISOString()}),await (0,k.iL)({userId:d.uid,userName:d.name,action:"UPDATE",targetType:"VOUCHER",description:`عدل بيانات الحوالة رقم ${a}.`}),(0,g.revalidatePath)("/accounts/remittances"),{success:!0}}catch(a){return{success:!1,error:a.message}}}(0,l.D)([t,n,o,p,q]),(0,e.A)(t,"7fe304717562da7e993bf1bc3e43f26d6024716c28",null),(0,e.A)(n,"408c79ddd0d0a9122724301d14534a0975eed69018",null),(0,e.A)(o,"60266b614460f4fd778e8111e66e4c8bff9744db3e",null),(0,e.A)(p,"60c7ace3c7601560697ba8ea1632ea71447c0b65ec",null),(0,e.A)(q,"60c7862a4ca16493782c4d556b1c72f9ee8d90ed17",null),d()}catch(a){d(a)}})},95378:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{DI:()=>m,EP:()=>q,EZ:()=>o,KB:()=>t,Lf:()=>n,d5:()=>p,zO:()=>r,zZ:()=>s});var e=c(91488);c(27806);var f=c(80446),g=c(91837),h=c(62641),i=c(58749),j=c(29631),k=c(40410),l=a([f,h,i,j]);async function m(a){let{clients:b}=await n({...a,all:!0});return b.map(a=>({value:a.id,label:`${a.name} ${a.code?`(${a.code})`:""}`,relationType:a.relationType,paymentType:a.paymentType}))}async function n(a={}){let{all:b=!1,limit:c=15,page:d=1,searchTerm:e,relationType:g,paymentType:h,status:i,country:j,province:k,sortBy:l="useCount_desc"}=a,m=await (0,f.Lf)();if(!m)return{clients:[],total:0};try{let f,n=m.collection("clients");g&&"all"!==g&&(n=n.where("relationType","in","client"===g?["client","both"]:"supplier"===g?["supplier","both"]:[g])),h&&"all"!==h&&(n=n.where("paymentType","==",h)),i&&"all"!==i&&(n=n.where("status","==",i)),!0===a.includeInactive||i||(n=n.where("status","==","active")),j&&"all"!==j&&(n=n.where("country","==",j)),k&&"all"!==k&&(n=n.where("province","==",k));let o=(await n.get()).docs;if(e){let a=e.toLowerCase();o=o.filter(b=>{let c=b.data();return c.name&&c.name.toLowerCase().includes(a)||c.phone&&String(c.phone).includes(a)||c.code&&c.code.toLowerCase().includes(a)})}let p=o.length;if(l){let[a,b]=l.split("_");o.sort((c,d)=>{let e=c.data(),f=d.data(),g=e[a],h=f[a];if(null==g)return 1;if(null==h)return -1;let i=0;return"string"==typeof g&&"string"==typeof h?i=g.localeCompare(h):g>h?i=1:g<h&&(i=-1),"desc"===b?-1*i:i})}if(b)f=o;else{let a=(d-1)*c;f=o.slice(a,a+c)}if(0===f.length)return{clients:[],total:0};return{clients:f.map(a=>{let b=a.data();return{...JSON.parse(JSON.stringify(b,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b)),id:a.id}}),total:p}}catch(a){return console.error("Error getting clients from Firestore: ",String(a)),{clients:[],total:0}}}async function o(a){let b=await (0,f.Lf)();if(!b)return null;try{let c=await b.collection("clients").doc(a).get();if(!c.exists)return null;let d=c.data(),e=JSON.parse(JSON.stringify(d,(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b));return{id:c.id,...e}}catch(b){return console.error(`Error getting client by ID ${a}:`,String(b)),null}}async function p(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=c.name,e=await (0,j.tu)("CL"),f={...a,code:e,createdAt:new Date().toISOString(),createdBy:d,balance:{USD:0,IQD:0},lastTransaction:null,useCount:0};f.password&&f.password.length>=6||delete f.password;let h=await b.collection("clients").add(f);await (0,i.iL)({userId:c.uid,userName:c.name,action:"CREATE",targetType:"CLIENT",description:`أنشأ علاقة جديدة باسم: ${f.name} (ID: ${h.id})`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts");let k={...f,id:h.id};return{success:!0,client:k}}catch(a){return console.error("Error adding client:",a),{success:!1,error:a.message}}}async function q(a){let b=await (0,f.Lf)();if(!b)return{success:!1,count:0,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,count:0,error:"Unauthorized"};try{for(let d of a){let a=b.batch(),e=b.collection("clients").doc(),f=await (0,j.tu)("CL"),g={...d,code:f,createdAt:new Date().toISOString(),createdBy:`مستورد بواسطة ${c.name}`,type:d.type||"individual",relationType:d.relationType||"client",status:d.status||"active",balance:{USD:0,IQD:0},lastTransaction:null,useCount:0,avatarUrl:""};g.password||delete g.password,a.set(e,g),await a.commit()}return await (0,i.iL)({userId:c.uid,userName:c.name,action:"CREATE",targetType:"CLIENT",description:`استورد ${a.length} علاقات جديدة من ملف.`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/relations/settings"),(0,g.revalidatePath)("/reports/debts"),{success:!0,count:a.length}}catch(a){return console.error("Error adding multiple clients: ",String(a)),{success:!1,count:0,error:"Failed to add clients."}}}async function r(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available."};let d=await (0,h.$T)();if(!d)return{success:!1,error:"Unauthorized"};try{let e=JSON.parse(JSON.stringify(b));(""===b.password||void 0===b.password||null===b.password)&&delete e.password,await c.collection("clients").doc(a).update(e),await (0,i.iL)({userId:d.uid,userName:d.name,action:"UPDATE",targetType:"CLIENT",description:`عدل بيانات العلاقة (ID: ${a})`});let f=await c.collection("clients").doc(a).get(),h=JSON.parse(JSON.stringify(f.data(),(a,b)=>b&&"object"==typeof b&&b.hasOwnProperty("seconds")&&b.hasOwnProperty("nanoseconds")?new Date(1e3*b.seconds).toISOString():b)),j={id:f.id,...h};return(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0,updatedClient:j}}catch(a){return console.error("Error updating client:",a),{success:!1,error:a.message}}}async function s(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=(await b.collection("clients").doc(a).get()).data();if(d?.useCount&&d.useCount>0)return{success:!1,error:"لا يمكن حذف هذه العلاقة لوجود معاملات مالية مرتبطة بها."};let e=d?.name||"unknown";return await b.collection("clients").doc(a).delete(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"CLIENT",description:`حذف العلاقة: ${e} (ID: ${a})`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function t(a){let b=await (0,f.Lf)();if(!b)return{success:!1,error:"Database not available."};let c=await (0,h.$T)();if(!c)return{success:!1,error:"Unauthorized"};try{let d=b.batch();return a.forEach(a=>{let c=b.collection("clients").doc(a);d.delete(c)}),await d.commit(),await (0,i.iL)({userId:c.uid,userName:c.name,action:"DELETE",targetType:"CLIENT",description:`حذف ${a.length} علاقات بشكل جماعي.`}),(0,g.revalidatePath)("/clients"),(0,g.revalidatePath)("/suppliers"),(0,g.revalidatePath)("/reports/debts"),{success:!0}}catch(a){return{success:!1,error:a.message}}}[f,h,i,j]=l.then?(await l)():l,(0,k.D)([m,n,o,p,q,r,s,t]),(0,e.A)(m,"405872236907704344162aca1c38160d1eac727fe8",null),(0,e.A)(n,"400e621b7f78c4800cffc85d668ca10cd73eb6853c",null),(0,e.A)(o,"408c94c431661ae65070856bc4a78d84f2cbfcba1c",null),(0,e.A)(p,"403331dfc341d9a7f9cbe156b5d10cfd49a20be531",null),(0,e.A)(q,"408c54ad33973364b68d8475849f76b4a4ca590722",null),(0,e.A)(r,"6023146a7bfefc423ba02712c56694a31432de707c",null),(0,e.A)(s,"4085652545b10cc37283ef55992935bd43a8ce947e",null),(0,e.A)(t,"40f4619201eea9704cbf15357e730e9458fc66e834",null),d()}catch(a){d(a)}})},96920:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{$$RSC_SERVER_ACTION_0:()=>p,default:()=>n,dynamic:()=>o});var e=c(75338),f=c(75879);c(68633),c(74515);var g=c(94848),h=c(46587),i=c(68162),j=c(18373),k=c(63195),l=c(16780),m=a([g,h]);[g,h]=m.then?(await m)():m;let o="force-dynamic",p=async function(){(0,l.revalidatePath)("/accounts/remittances")};async function n(){let[a,b,c]=await Promise.all([(0,g.UR)(),(0,h.mt)()]).then(a=>[...a,null]).catch(a=>[null,null,a.message||"فشل تحميل البيانات"]);return!c&&a&&b?(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"إدارة الحوالات الواردة"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"نظام متكامل لتسجيل وتدقيق واستلام الحوالات المالية الواردة من المكاتب الخارجية."})]}),(0,e.jsx)(k.default,{initialRemittances:a,onDataChange:p})]}):(0,e.jsxs)(i.Fc,{variant:"destructive",children:[(0,e.jsx)(j.A,{className:"h-4 w-4"}),(0,e.jsx)(i.XL,{children:"حدث خطأ!"}),(0,e.jsx)(i.TN,{children:c||"فشل تحميل بيانات الحوالات أو البيانات المرتبطة بها."})]})}(0,f.A)(p,"008e375b291b129374a1d717237693fdb7fe3fee4e",null),d()}catch(a){d(a)}})},97092:(a,b,c)=>{"use strict";c.d(b,{rN:()=>j,uJ:()=>i});let d=a=>(a??"").trim(),e=(a,b)=>Array.from(new Set([...b,...Object.keys(a||{})])).reduce((b,c)=>(b[c]=d(a?.[c]),b),{}),f=a=>Object.values(a).find(a=>a.length>0)||"",g=["tickets","visas","subscriptions","segments","profit_distribution","other"],h=["tickets","visas","subscriptions","partners","operating","cost_tickets","cost_visas","operating_salaries","operating_rent","operating_utilities","marketing"];function i(a){let b={...a?.revenueMap||{},...a?.customRevenues||{}},c={...a?.expenseMap||{},...a?.customExpenses||{}},i=e(b,g),j=e(c,h),k=d(a?.receivableAccountId||a?.arAccountId),l=d(a?.payableAccountId||a?.apAccountId),m=d(a?.generalRevenueId)||f(i),n=d(a?.generalExpenseId)||f(j);return{receivableAccountId:k,payableAccountId:l,hybridRelationAccountId:d(a?.hybridRelationAccountId),clearingAccountId:d(a?.clearingAccountId),defaultCashId:d(a?.defaultCashId),defaultBankId:d(a?.defaultBankId),arAccountId:k,apAccountId:l,generalRevenueId:m,generalExpenseId:n,preventDirectCashRevenue:!!a?.preventDirectCashRevenue,revenueMap:i,expenseMap:j}}function j(a){let b=e(a.revenueMap||{},g),c=e(a.expenseMap||{},h),i=d(a.receivableAccountId),j=d(a.payableAccountId),k=d(a.generalRevenueId)||f(b),l=d(a.generalExpenseId)||f(c);return{receivableAccountId:i,payableAccountId:j,hybridRelationAccountId:d(a.hybridRelationAccountId),clearingAccountId:d(a.clearingAccountId),defaultCashId:d(a.defaultCashId),defaultBankId:d(a.defaultBankId),preventDirectCashRevenue:!!a.preventDirectCashRevenue,generalRevenueId:k,generalExpenseId:l,arAccountId:i,apAccountId:j,revenueMap:b,customRevenues:b,expenseMap:c,customExpenses:c}}},97842:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{PR:()=>j,fO:()=>i,tu:()=>k});var e=c(75879);c(68633);var f=c(43513),g=c(51669),h=a([f]);f=(h.then?(await h)():h)[0];let l="sequences",m=[{id:"RC",label:"سند قبض",prefix:"RC"},{id:"PV",label:"سند دفع",prefix:"PV"},{id:"EX",label:"سند مصاريف",prefix:"EX"},{id:"TR",label:"سند حوالة",prefix:"TR"},{id:"DS",label:"سند قبض مخصص",prefix:"DS"},{id:"JE",label:"سند قيد محاسبي",prefix:"JE"},{id:"BK",label:"إدخال حجز",prefix:"BK"},{id:"PR",label:"ربح شهري",prefix:"PR"},{id:"VS",label:"إدخال فيزا",prefix:"VS"},{id:"SUB",label:"إنشاء اشتراك",prefix:"SUB"},{id:"SUBP",label:"دفعة قسط اشتراك",prefix:"SUBP"},{id:"RF",label:"استرجاع تذكرة",prefix:"RF"},{id:"EXC",label:"تغيير تذكرة",prefix:"EXC"},{id:"VOID",label:"إلغاء (فويد)",prefix:"VOID"},{id:"EXT",label:"معاملة بورصة",prefix:"EXT"},{id:"EXP",label:"تسديد بورصة",prefix:"EXP"},{id:"SEG",label:"سكمنت",prefix:"SEG"},{id:"CL",label:"علاقة (عميل/مورد)",prefix:"CL"}];async function i(){let a=await (0,f.Lf)();if(!a)throw Error("Database not available.");let b=await a.collection(l).get();if(b.empty){let b=a.batch(),c=m.map(a=>({...a,value:0}));return c.forEach(c=>{b.set(a.collection(l).doc(c.id),c)}),await b.commit(),c}let c=b.docs.map(a=>a.data()),d=m.filter(a=>!c.some(b=>b.id===a.id));if(d.length>0){let b=a.batch();return d.forEach(c=>{b.set(a.collection(l).doc(c.id),{...c,value:0})}),await b.commit(),i()}return c}async function j(a,b){let c=await (0,f.Lf)();if(!c)return{success:!1,error:"Database not available"};try{return await c.collection(l).doc(a).update(b),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function k(a){let b=await (0,f.Lf)();if(!b)throw Error("Database not available.");let c=b.collection(l).doc(a);try{let d=await b.runTransaction(async b=>{let d=await b.get(c),e=1,f=a,g=`سند ${a}`;if(d.exists){let b=d.data();e=(b.value||0)+1,f=b.prefix||a,g=b.label||g}return b.set(c,{value:e,prefix:f,label:g},{merge:!0}),{number:e,prefix:f}}),e=String(d.number).padStart(6,"0");return`${d.prefix}-${e}`}catch(b){return console.error(`Error getting next voucher number for prefix ${a}:`,b),`${a}-${Date.now().toString().slice(-6)}`}}(0,g.D)([i,j,k]),(0,e.A)(i,"00f8105cf2df698dda196c821059bffd2c12bb65d6",null),(0,e.A)(j,"60bfff327e3bf73dac5fa7bb6d2690e1fed6e5cf56",null),(0,e.A)(k,"40f3e2b0ca2e561c506ffb1575ff80c4dac60766e4",null),d()}catch(a){d(a)}})},99242:(a,b,c)=>{Promise.resolve().then(c.bind(c,63195))}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4586,8298,3103,9664,7180,6153,7846,9667,5446,4154,4799,3152,6587,2495],()=>b(b.s=67647));module.exports=c})();