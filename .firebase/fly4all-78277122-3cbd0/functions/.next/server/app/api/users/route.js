(()=>{var a={};a.id=318,a.ids=[318],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3896:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{INTERCEPTION_ROUTE_MARKERS:function(){return e},extractInterceptionRouteInformation:function(){return g},isInterceptionRouteAppPath:function(){return f}});let d=c(48723),e=["(..)(..)","(.)","(..)","(...)"];function f(a){return void 0!==a.split("/").find(a=>e.find(b=>a.startsWith(b)))}function g(a){let b,c,f;for(let d of a.split("/"))if(c=e.find(a=>d.startsWith(a))){[b,f]=a.split(c,2);break}if(!b||!c||!f)throw Object.defineProperty(Error("Invalid interception route: "+a+". Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>"),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(b=(0,d.normalizeAppPath)(b),c){case"(.)":f="/"===b?"/"+f:b+"/"+f;break;case"(..)":if("/"===b)throw Object.defineProperty(Error("Invalid interception route: "+a+". Cannot use (..) marker at the root level, use (.) instead."),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});f=b.split("/").slice(0,-1).concat(f).join("/");break;case"(...)":f="/"+f;break;case"(..)(..)":let g=b.split("/");if(g.length<=2)throw Object.defineProperty(Error("Invalid interception route: "+a+". Cannot use (..)(..) marker at the root level or one level up."),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});f=g.slice(0,-2).concat(f).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:b,interceptedRoute:f}}},7879:a=>{"use strict";a.exports=import("firebase-admin/firestore")},9801:a=>{"use strict";a.exports=import("firebase-admin/app")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12019:(a,b,c)=>{"use strict";c.d(b,{o:()=>e});var d=c(42255);function e(a){let b=(0,d.a)(a);return b.setHours(0,0,0,0),b}},14276:a=>{"use strict";a.exports=import("firebase-admin/auth")},19117:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{GET:()=>h});var e=c(10641),f=c(40776),g=a([f]);async function h(a){try{let a=await (0,f.lo)({all:!0});return e.NextResponse.json(a)}catch(a){return e.NextResponse.json({error:a.message},{status:500})}}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24803:a=>{"use strict";a.exports=import("firebase-admin/storage")},26295:(a,b,c)=>{"use strict";c.d(b,{Cg:()=>f,my:()=>d,s0:()=>g,w4:()=>e});let d=6048e5,e=864e5,f=6e4,g=36e5},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29559:(a,b,c)=>{"use strict";c.d(b,{R:()=>d});let d={projectId:"fly4all-78277122-3cbd0",privateKey:"-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC62eIaOJqkBGL/\nIvxqOzN8/etbwsVKx8vNMRXVQ4RbS2/jB2JBJhonNWHf0Lll36QFnnfM0v1sGzz3\nck3eCAxT4snkbI0nb71u6tLff1YSur7p7GmCOeq1LKsc6uI5sFC3G0PJLZFYj2hG\n0djgQobNoVmLFfi9m1DhReDSFvk1PpJt1hxMhKKq11KR9ER90IUE2L6vuDR0Fa1Z\n9Y72htITxAq7Wd9zAlwlt7vcK5cQAbLBYrQVqPDrrmwNS5JPyDLhiEY6fbGeyiFE\nXdFNhktEsazoFN6w/V5NQ/aJH04fn3V36lBdc9sO7+wRufWRBaeoBs1FurPhpY1q\nxKorBLllAgMBAAECggEAFjzZrby4XNZf0NUhXOREVbcjpHVbBTIfpYFWw52oOjRR\ncd/eV/oYqTtvdVNySTdTXk7Um7YtrojUWe/K6CaljvNCC3NG3l9sWG/OnoZZYFvE\n3nLCQNszPZI+IDAtMefzx0MRr3cCohtZMfqGGPSZ9g2iqky4YJqERvdJ0T8mNCmU\n8GB6+qoKUGMt2O5DzVO250CGgIcgfqFd1dqvC+8PD3S2FL1dqwEgxpHeXhg+7NUU\n78+SmNRxcCTdqlgx5V9ihqgGaajVHWmGEMfDS+XatG+BAoc+Fi/ubOHPXH9Iniwd\njJcJ9CaSyZPFz0N+sY5uFB/wk2cYIKCdjzHTrJPzmQKBgQDgm8UI7Q3GScdbv29p\nQX++BOzqJKMiO7d0nOsW/7AobFVsSpXTsU0RovAkCtYY+P67qxQDwK3RSDs36YQE\nUyRwJhHnzJOKf5zj2nVFKgHgSSJdZEolMTM1KVicESDer6knsT7EN8M+iVGXl0JO\nz277bJ5hhNMkPnB1e7dOh6zq+QKBgQDU9zLg30dvNXNwSHv0QDZqADomi9U9nkZ+\nJhgJDmi+VMUxWfb61U0W/azewShL7YIsOHdTLensrAPBj5xzuB2OftKnEuaO3Nsv\nzJeQ3jOM5wXnqHpl9EXYVvlJTzM7tCyRJuiDFyhBmezCxikLjsjxWjwlcEGhc84Z\n+7E1IAUQzQKBgBVL78TG5VV1zWdPoXqzcS9NPEF/M9CdJOnzrv7BQ6yxiO/5qncm\nCo6vimGAfYhko5KbyAwLCvAbDzJf+9qFH6FamrwF07+AFhosro3eS8s+Y/nC9pzM\nK3TQ9Mvne9xhf4J59d+ZAfQ+BPSArRLX7Ef+po3MkFCRcwxQrLLPfn/RAoGBAL1f\nuBF42sfMSwOsoPTYaMqnuw3tyEhLxzmD3FmpQ4EEVnmFG3d/V1a7aw6FyrSB1gBG\nke0YZew8JfboImJQdY/xvJYu23Bsekgt8RU0UbjY8kpGadjhd35iELicwd00YXEN\nnTJ81CJJotysY3FQneTorZVJFkNgfARk6PZpq7d9AoGBAJVxFwblg6SQ+QZMUqaU\n5dXAESNOHv08DkYd0o/LmwfX1/odY9VwkR0unwMY3NncAWVSNh7u/C3DjLciaHzJ\nJr2o/GSZ2p1HxUsUa0aqN/q4BFTkO7ryFeCFcN3AO6hfgzKnoFUFYBD4iSHPkgX/\nfrErRvbecpYKP5V4y0awUggt\n-----END PRIVATE KEY-----\n".replace(/\\n/g,"\n"),clientEmail:"firebase-adminsdk-fbsvc@fly4all-78277122-3cbd0.iam.gserviceaccount.com"}},30984:(a,b,c)=>{"use strict";c.d(b,{H:()=>e});var d=c(26295);function e(a,b){let c,e,n=b?.additionalDigits??2,o=function(a){let b,c={},d=a.split(f.dateTimeDelimiter);if(d.length>2)return c;if(/:/.test(d[0])?b=d[0]:(c.date=d[0],b=d[1],f.timeZoneDelimiter.test(c.date)&&(c.date=a.split(f.timeZoneDelimiter)[0],b=a.substr(c.date.length,a.length))),b){let a=f.timezone.exec(b);a?(c.time=b.replace(a[1],""),c.timezone=a[1]):c.time=b}return c}(a);if(o.date){let a=function(a,b){let c=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+b)+"})|(\\d{2}|[+-]\\d{"+(2+b)+"})$)"),d=a.match(c);if(!d)return{year:NaN,restDateString:""};let e=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:null===f?e:100*f,restDateString:a.slice((d[1]||d[2]).length)}}(o.date,n);c=function(a,b){var c,d,e,f,h,i,k;if(null===b)return new Date(NaN);let n=a.match(g);if(!n)return new Date(NaN);let o=!!n[4],p=j(n[1]),q=j(n[2])-1,r=j(n[3]),s=j(n[4]),t=j(n[5])-1;if(o){return(c=s,d=t,c>=1&&c<=53&&d>=0&&d<=6)?function(a,b,c){let d=new Date(0);d.setUTCFullYear(a,0,4);let e=d.getUTCDay()||7;return d.setUTCDate(d.getUTCDate()+((b-1)*7+c+1-e)),d}(b,s,t):new Date(NaN)}{let a=new Date(0);return(e=b,f=q,h=r,f>=0&&f<=11&&h>=1&&h<=(l[f]||(m(e)?29:28))&&(i=b,(k=p)>=1&&k<=(m(i)?366:365)))?(a.setUTCFullYear(b,q,Math.max(p,r)),a):new Date(NaN)}}(a.restDateString,a.year)}if(!c||isNaN(c.getTime()))return new Date(NaN);let p=c.getTime(),q=0;if(o.time&&isNaN(q=function(a){var b,c,e;let f=a.match(h);if(!f)return NaN;let g=k(f[1]),i=k(f[2]),j=k(f[3]);return(b=g,c=i,e=j,24===b?0===c&&0===e:e>=0&&e<60&&c>=0&&c<60&&b>=0&&b<25)?g*d.s0+i*d.Cg+1e3*j:NaN}(o.time)))return new Date(NaN);if(o.timezone){if(isNaN(e=function(a){var b;if("Z"===a)return 0;let c=a.match(i);if(!c)return 0;let e="+"===c[1]?-1:1,f=parseInt(c[2]),g=c[3]&&parseInt(c[3])||0;return(b=g)>=0&&b<=59?e*(f*d.s0+g*d.Cg):NaN}(o.timezone)))return new Date(NaN)}else{let a=new Date(p+q),b=new Date(0);return b.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),b.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),b}return new Date(p+q+e)}let f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},g=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,i=/^([+-])(\d{2})(?::?(\d{2}))?$/;function j(a){return a?parseInt(a):1}function k(a){return a&&parseFloat(a.replace(",","."))||0}let l=[31,null,31,30,31,30,31,31,30,31,30,31];function m(a){return a%400==0||a%4==0&&a%100!=0}},40776:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Cm:()=>u,O0:()=>t,TK:()=>r,hG:()=>s,ht:()=>o,lo:()=>p,nu:()=>q,qV:()=>w,v_:()=>v});var e=c(75879);c(68633);var f=c(14276),g=c(43513),h=c(16780),i=c(12019),j=c(70598),k=c(30984),l=c(55511),m=c(51669),n=a([f,g]);[f,g]=n.then?(await n)():n;let x=a=>{if(!a)return null;let b=JSON.parse(JSON.stringify(a));for(let a in b)b[a]&&(b[a].hasOwnProperty("_seconds")||"function"==typeof b[a].toDate)&&(b[a]=new Date(1e3*b[a]._seconds||b[a].toDate()).toISOString());return b};async function o(a){let b=await (0,g.Lf)();if(!b)return null;try{let c=b.collection("users"),d=await c.where("email","==",a).limit(1).get();if(d.empty)return null;let e=d.docs[0];return{...x(e.data()),uid:e.id}}catch(a){return console.error("Error getting user by email:",String(a)),null}}async function p({includeHrData:a=!1,all:b=!1,from:c,to:d}={}){try{let b=await (0,g.Lf)(),e=(0,f.getAuth)(),[h,l]=await Promise.all([e.listUsers(),b.collection("users").get()]),m=new Map(l.docs.map(a=>[a.id,x(a.data())])),n=h.users.map(a=>{let b=m.get(a.uid)||{};return{uid:a.uid,name:a.displayName||b.name||"No Name",username:b.username||"",email:a.email||b.email||"",phone:a.phoneNumber||b.phone||"",avatarUrl:a.photoURL||b.avatarUrl,status:b.status||(a.disabled?"blocked":"pending"),role:b.role||"viewer",department:b.department,position:b.position,boxId:b.boxId,baseSalary:b.baseSalary||0,bonuses:b.bonuses||0,deductions:b.deductions||0,notes:b.notes,attendance:b.attendance||[],ticketProfit:b.ticketProfit,visaProfit:b.visaProfit,groupProfit:b.groupProfit,changeProfit:b.changeProfit,segmentProfit:b.segmentProfit,preferences:b.preferences||{},calculatedTotalProfit:0,calculatedNetSalary:0}});if(a){let a=c?(0,i.o)(c):void 0,e=d?(0,j.D)(d):void 0,f=await b.collection("journal-vouchers").get(),g={};f.forEach(b=>{let c=b.data(),d=c.officer,f=(0,k.H)(c.date);if(d&&(!a||!e||f>=a&&f<=e)){g[d]||(g[d]=0);let a=c.originalData?.salePrice||(c.originalData?.passengers||[]).reduce((a,b)=>a+(b.salePrice||0),0),b=c.originalData?.purchasePrice||(c.originalData?.passengers||[]).reduce((a,b)=>a+(b.purchasePrice||0),0);g[d]+=a-b}}),n.forEach(a=>{a.calculatedTotalProfit=g[a.name]||0,a.calculatedNetSalary=(a.baseSalary||0)+(a.bonuses||0)-(a.deductions||0)+a.calculatedTotalProfit})}return n}catch(a){return console.error("Error fetching users:",String(a)),[]}}async function q(a){let b=await (0,f.getAuth)(),c=await (0,g.Lf)(),{email:d,password:e,name:i,phone:j,...k}=a,m=e&&e.length>=6?e:(0,l.randomBytes)(16).toString("hex"),n=j;n&&!n.startsWith("+")&&(n=n.startsWith("0")?`+964${j.substring(1)}`:`+964${j}`);let o=await b.createUser({email:d,password:m,displayName:i,phoneNumber:n,disabled:"blocked"===a.status});return await c.collection("users").doc(o.uid).set({...k,name:i,email:d,phone:n}),(0,h.revalidatePath)("/users"),{success:!0,newUser:{uid:o.uid,...a}}}async function r(a,b){let c=await (0,f.getAuth)(),d=await (0,g.Lf)(),{email:e,name:i,phone:j,password:k,status:l,avatarUrl:m,...n}=b,o={};e&&(o.email=e),i&&(o.displayName=i),j&&(o.phoneNumber=j),m&&(o.photoURL=m),k&&k.length>=6&&(o.password=k),l&&(o.disabled="blocked"===l),Object.keys(o).length>0&&await c.updateUser(a,o);let p={...n,email:e,name:i,phone:j,status:l,avatarUrl:m};Object.keys(p).forEach(a=>void 0===p[a]&&delete p[a]),Object.keys(p).length>0&&await d.collection("users").doc(a).set(p,{merge:!0}),(0,h.revalidatePath)("/users");let q=await d.collection("users").doc(a).get(),r=x(q.data());return{success:!0,updatedUser:{...r,uid:a}}}async function s(a){let b=await (0,f.getAuth)(),c=await (0,g.Lf)();return await b.deleteUser(a),await c.collection("users").doc(a).delete(),(0,h.revalidatePath)("/users"),{success:!0}}async function t(){let a=await (0,g.Lf)();return(await a.collection("roles").get()).docs.map(a=>({id:a.id,...a.data()}))}async function u(a){let b=await (0,g.Lf)(),c=a.name.toLowerCase().replace(/\s+/g,"_");return await b.collection("roles").doc(c).set(a),(0,h.revalidatePath)("/users"),{success:!0,newRole:{id:c,...a}}}async function v(a,b){let c=await (0,g.Lf)();return await c.collection("roles").doc(a).update(b),(0,h.revalidatePath)("/users"),{success:!0}}async function w(){try{let a=await (0,f.getAuth)(),b=(await a.listUsers()).users.map(a=>({uid:a.uid,email:a.email,displayName:a.displayName,creationTime:new Date(a.metadata.creationTime).toLocaleDateString()}));return{success:!0,users:b}}catch(a){return console.error("Error listing all auth users:",String(a)),{success:!1,error:a.message}}}(0,m.D)([o,p,q,r,s,t,u,v,w]),(0,e.A)(o,"406818275705b776627a9e14558eaa7857fbec9b73",null),(0,e.A)(p,"40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3",null),(0,e.A)(q,"40d4790cf5bfe15d462399ad8c52d1baec8babf86f",null),(0,e.A)(r,"601532f3b7a46dae258a5ff32f14fb4b3e2e141e9f",null),(0,e.A)(s,"40ef77a697a84cf599002575e6afc4c1de58c3cdab",null),(0,e.A)(t,"005773e734ccf3535fa61ed9b34042d47625b1ede6",null),(0,e.A)(u,"40e13d085ff779b8dfbb82e790ebb21702ce079192",null),(0,e.A)(v,"601838acb9f969bfd30fa9f583c86dd453b19524dd",null),(0,e.A)(w,"00afcee30c25fc6521aeaf596fabd0fef5e0ca707f",null),d()}catch(a){d(a)}})},42255:(a,b,c)=>{"use strict";function d(a){let b=Object.prototype.toString.call(a);return a instanceof Date||"object"==typeof a&&"[object Date]"===b?new a.constructor(+a):new Date("number"==typeof a||"[object Number]"===b||"string"==typeof a||"[object String]"===b?a:NaN)}c.d(b,{a:()=>d})},43513:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{$E:()=>q,Lf:()=>o,iS:()=>p});var e=c(75879);c(68633);var f=c(9801),g=c(14276),h=c(7879),i=c(24803),j=c(29559),k=c(51669),l=a([f,g,h,i]);[f,g,h,i]=l.then?(await l)():l;let r=null,s=null;async function m(){if((0,f.getApps)().length>0)return r=(0,f.getApp)();if(!j.R||!j.R.projectId||!j.R.privateKey||!j.R.clientEmail)throw console.error("Firebase Admin SDK Service Account object is not valid."),s=Error("Default Firebase service account is not valid in firebase-service-account.ts.");try{console.log("Initializing Firebase Admin SDK...");let a=(0,f.initializeApp)({credential:(0,f.cert)(j.R),storageBucket:`${j.R.projectId}.appspot.com`});return r=a,console.log("Firebase Admin SDK initialized successfully."),a}catch(a){throw console.error("Failed to initialize Firebase Admin SDK:",String(a)),s=a instanceof Error?a:Error(String(a))}}async function n(){if(r)return r;if(s)throw s;return await m()}async function o(){let a=await n();return(0,h.getFirestore)(a)}async function p(){let a=await n();return(0,g.getAuth)(a)}async function q(){let a=await n();return(0,i.getStorage)(a)}(0,k.D)([o,p,q]),(0,e.A)(o,"009e84f93947e0a432e28675ea07a71949bfe66943",null),(0,e.A)(p,"0084d26686615403d39adac4c095e2f442ed3af27d",null),(0,e.A)(q,"0079928ff14026085419c5483c28b98ee3311389f6",null),d()}catch(a){d(a)}})},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:a=>{"use strict";a.exports=require("crypto")},62265:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{"005773e734ccf3535fa61ed9b34042d47625b1ede6":()=>e.O0,"0079928ff14026085419c5483c28b98ee3311389f6":()=>f.$E,"0084d26686615403d39adac4c095e2f442ed3af27d":()=>f.iS,"009e84f93947e0a432e28675ea07a71949bfe66943":()=>f.Lf,"00afcee30c25fc6521aeaf596fabd0fef5e0ca707f":()=>e.qV,"40290c8e8678ea3c7dc08bc14a2b21bf84ced558a3":()=>e.lo,"406818275705b776627a9e14558eaa7857fbec9b73":()=>e.ht,"40d4790cf5bfe15d462399ad8c52d1baec8babf86f":()=>e.nu,"40e13d085ff779b8dfbb82e790ebb21702ce079192":()=>e.Cm,"40ef77a697a84cf599002575e6afc4c1de58c3cdab":()=>e.hG,"601532f3b7a46dae258a5ff32f14fb4b3e2e141e9f":()=>e.TK,"601838acb9f969bfd30fa9f583c86dd453b19524dd":()=>e.v_});var e=c(40776),f=c(43513),g=a([e,f]);[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70598:(a,b,c)=>{"use strict";c.d(b,{D:()=>e});var d=c(42255);function e(a){let b=(0,d.a)(a);return b.setHours(23,59,59,999),b}},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},93961:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{handler:()=>x,patchFetch:()=>w,routeModule:()=>y,serverHooks:()=>B,workAsyncStorage:()=>z,workUnitAsyncStorage:()=>A});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(19117),v=a([u]);u=(v.then?(await v)():v)[0];let y=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/users/route",pathname:"/api/users",filename:"route",bundlePath:"app/api/users/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/home/user/studio/src/app/api/users/route.ts",nextConfigOutput:"",userland:u}),{workAsyncStorage:z,workUnitAsyncStorage:A,serverHooks:B}=y;function w(){return(0,g.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:A})}async function x(a,b,c){var d;let e="/api/users/route";"/index"===e&&(e="/");let g=await y.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!x){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||y.isDev||x||(G=D,G="/index"===G?"/":G);let H=!0===y.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>y.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>y.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await y.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await y.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await y.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}d()}catch(a){d(a)}})},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4586,8298,7180,1692],()=>b(b.s=93961));module.exports=c})();