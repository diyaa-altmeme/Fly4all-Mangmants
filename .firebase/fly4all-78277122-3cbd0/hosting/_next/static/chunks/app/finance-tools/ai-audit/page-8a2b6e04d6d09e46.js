(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5230],{14294:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(12115);let i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:c="",children:o,iconNode:u,...p}=e;return(0,a.createElement)("svg",{ref:t,...n,width:s,height:s,stroke:r,strokeWidth:d?24*Number(l)/Number(s):l,className:i("lucide",c),...p},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),l=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:l,...d}=r;return(0,a.createElement)(s,{ref:n,iconNode:t,className:i("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),l),...d})});return r.displayName="".concat(e),r}},14585:(e,t,r)=>{"use strict";let a,i,n;r.d(t,{db:()=>n,j:()=>i,y:()=>a});var s=r(52078),l=r(19708),d=r(81328);a=(0,s.Dk)().length?(0,s.Dk)()[0]:(0,s.Wp)({apiKey:"AIzaSyCtlF3onBhtwg0Hh3iOOEjygi9mj81wxrA",authDomain:"fly4all-78277122-3cbd0.firebaseapp.com",projectId:"fly4all-78277122-3cbd0",storageBucket:"fly4all-78277122-3cbd0.firebasestorage.app",messagingSenderId:"108505683067",appId:"1:108505683067:web:3ab7755349630154e77ede"}),i=(0,d.xI)(a),n=(0,l.aU)(a)},15377:(e,t,r)=>{"use strict";r.d(t,{yZ:()=>l});let a=(e,t)=>{if(!e||!t)return!1;let r=e.trim(),a=t.trim();return!!r&&!!a&&(r===a||r.startsWith("".concat(a,"-"))||r.startsWith("".concat(a,"."))||r.startsWith("".concat(a,"/"))||r.startsWith(a))},i=(e,t)=>{for(let r of t)if(a(e,r))return!0;return!1};function n(e,t){if(!e||!t)return"other";let{defaultCashId:r,defaultBankId:n,receivableAccountId:s,arAccountId:l,payableAccountId:d,apAccountId:c,hybridRelationAccountId:o,clearingAccountId:u,revenueMap:p,expenseMap:m,generalRevenueId:y,generalExpenseId:h}=t;return a(e,r)?"cash":a(e,n)?"bank":a(e,o)?"hybrid":a(e,s)||a(e,l)?"client":a(e,d)||a(e,c)?"supplier":a(e,u)?"clearing":i(e,[y,...Object.values(p||{})])?"revenue":i(e,[h,...Object.values(m||{})])?"expense":"other"}let s=e=>{if("number"==typeof e&&!Number.isNaN(e))return e;if("string"==typeof e&&""!==e.trim()){let t=Number(e);return Number.isFinite(t)?t:0}return 0};function l(e,t){var r,a;if(Array.isArray(e.entries)&&e.entries.length>0)return e.entries.map(e=>{var r,a,i;let l=s(null!=(r=e.debit)?r:"debit"===e.type?e.amount:0),d=s(null!=(a=e.credit)?a:"credit"===e.type?e.amount:0),c=e.accountType||n(e.accountId,t);return{accountId:e.accountId,debit:l,credit:d,amount:l>0?l:d,description:null!=(i=e.description)?i:e.note,currency:e.currency,relationId:e.relationId,companyId:e.companyId,accountType:c,type:l>0?"debit":"credit"}});let i=[];if(Array.isArray(e.debitEntries))for(let a of e.debitEntries){let e=s(null!=(r=a.amount)?r:a.debit);i.push({accountId:a.accountId,debit:e,credit:0,amount:e,description:a.description,currency:a.currency,relationId:a.relationId,companyId:a.companyId,accountType:n(a.accountId,t),type:"debit"})}if(Array.isArray(e.creditEntries))for(let r of e.creditEntries){let e=s(null!=(a=r.amount)?a:r.credit);i.push({accountId:r.accountId,debit:0,credit:e,amount:e,description:r.description,currency:r.currency,relationId:r.relationId,companyId:r.companyId,accountType:n(r.accountId,t),type:"credit"})}return i}},17565:(e,t,r)=>{Promise.resolve().then(r.bind(r,86508))},18527:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},60406:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n,pY:()=>s});var a=r(2821),i=r(75889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.$)(t))}let s=(e,t,r,a)=>{let i={};return Object.keys(e).map(e=>e.toLowerCase().trim()),r.forEach(t=>{let r,n=null==a?void 0:a[t.id],s=(t.aliases||(null==n?void 0:n.aliases)||[t.label]).map(e=>e.toLowerCase().trim()),l=Array.from(new Set([t.id,t.label,...s].map(e=>e.toLowerCase().trim()))),d=Object.keys(e).find(e=>l.includes(e.toLowerCase().trim()));d&&(r=e[d]),null==r||""===String(r).trim()?i[t.id]=void 0!==t.defaultValue?t.defaultValue:"number"===t.dataType?0:"":"number"===t.dataType?i[t.id]=parseFloat(String(r).trim().replace(/,/g,""))||0:i[t.id]=String(r).trim()}),i}},80019:(e,t,r)=>{"use strict";r.d(t,{b:()=>d});var a=r(83946),i=r(47643),n=r(47734),s=r(73697),l=r(36164),d=(0,a.gu)({chartName:"LineChart",GraphicalChild:i.N,axisComponents:[{axisType:"xAxis",AxisComp:n.W},{axisType:"yAxis",AxisComp:s.h}],formatAxisMap:l.pr})},82863:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},86508:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var a=r(95155),i=r(12115),n=r(86948);let s=(0,r(14294).A)("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);var l=r(18527),d=r(60406),c=r(82863),o=r(14585),u=r(19708),p=r(26991),m=r(80019),y=r(47734),h=r(73697),f=r(23508),x=r(47643),b=r(98128),j=r(16533),g=r(14223),A=r(15377);function w(){let[e,t]=(0,i.useState)([]),[r,w]=(0,i.useState)({totalVouchers:0,balanced:0,unbalanced:0,risky:0});return(0,i.useEffect)(()=>{!async function(){let e=(0,u.rJ)(o.db,"journal-vouchers"),r=await (0,u.GG)(e),a=[],i=0,n=0,s=0;r.forEach(e=>{let t=e.data(),r=(0,A.yZ)(t),l=r.reduce((e,t)=>e+(t.debit||0),0),d=r.reduce((e,t)=>e+(t.credit||0),0),c=Math.abs(l-d),o=(e=>{if(!e)return new Date;if("string"==typeof e){let t=new Date(e);return Number.isNaN(t.getTime())?new Date:t}if(e instanceof Date)return e;if("function"==typeof e.toDate){let t=e.toDate();return t instanceof Date?t:new Date}return"number"==typeof e.seconds?new Date(1e3*e.seconds):new Date})(t.date),u="balanced",p=0;0!==c?(u="unbalanced",n++,p=80):r.some(e=>e.amount>5e4)?(u="risky",s++,p=60):i++,a.push({id:e.id,date:(0,g.GP)(o,"dd MMM yyyy"),totalDebit:l,totalCredit:d,diff:c,status:u,risk:p})}),t(a),w({totalVouchers:r.size,balanced:i,unbalanced:n,risky:s})}()},[]),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,a.jsx)(s,{className:"text-primary"})," التحليل الذكي المالي (AI Audit Assistant)"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(N,{title:"إجمالي القيود",value:r.totalVouchers,icon:s,color:"text-gray-700"}),(0,a.jsx)(N,{title:"القيود السليمة",value:r.balanced,icon:l.A,color:"text-green-600"}),(0,a.jsx)(N,{title:"القيود غير المتوازنة",value:r.unbalanced,icon:d.A,color:"text-red-600"}),(0,a.jsx)(N,{title:"عمليات عالية الخطورة",value:r.risky,icon:c.A,color:"text-orange-600"})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"تحليل توازن القيود"}),(0,a.jsx)(n.BT,{children:"الفرق بين المبالغ المدينة والدائنة على مدار الأشهر"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:300,children:(0,a.jsxs)(m.b,{data:e,children:[(0,a.jsx)(y.W,{dataKey:"date"}),(0,a.jsx)(h.h,{}),(0,a.jsx)(f.m,{}),(0,a.jsx)(x.N,{type:"monotone",dataKey:"totalDebit",stroke:"#16a34a",name:"المدين"}),(0,a.jsx)(x.N,{type:"monotone",dataKey:"totalCredit",stroke:"#2563eb",name:"الدائن"})]})})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"مستويات المخاطر"}),(0,a.jsx)(n.BT,{children:"توزيع القيود حسب مستوى الخطورة"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:300,children:(0,a.jsxs)(b.E,{data:e,children:[(0,a.jsx)(y.W,{dataKey:"date"}),(0,a.jsx)(h.h,{}),(0,a.jsx)(f.m,{}),(0,a.jsx)(j.y,{dataKey:"risk",fill:"#f59e0b",name:"نسبة الخطورة"})]})})})]})]})}function N(e){let{title:t,value:r,icon:i,color:s}=e;return(0,a.jsxs)(n.Zp,{className:"shadow-md border",children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:t}),(0,a.jsx)(i,{className:"h-5 w-5 ".concat(s)})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-right",children:r.toLocaleString()})})]})}},86948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>s,aR:()=>l,wL:()=>u});var a=r(95155),i=r(12115),n=r(64269);let s=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",r),...i})});s.displayName="Card";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-4 sm:p-6 text-right",r),...i})});l.displayName="CardHeader";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-lg sm:text-xl font-bold leading-none tracking-tight",r),...i})});d.displayName="CardTitle";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...i})});c.displayName="CardDescription";let o=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-4 sm:p-6 pt-0",r),...i})});o.displayName="CardContent";let u=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-4 sm:p-6 pt-0",r),...i})});u.displayName="CardFooter"},98128:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var a=r(83946),i=r(16533),n=r(47734),s=r(73697),l=r(36164),d=(0,a.gu)({chartName:"BarChart",GraphicalChild:i.y,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:n.W},{axisType:"yAxis",AxisComp:s.h}],formatAxisMap:l.pr})}},e=>{e.O(0,[9135,7210,4909,5111,783,4223,1583,7643,8441,1255,7358],()=>e(e.s=17565)),_N_E=e.O()}]);