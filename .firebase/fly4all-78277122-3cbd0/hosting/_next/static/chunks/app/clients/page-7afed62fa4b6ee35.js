(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5021],{6259:(e,s,t)=>{"use strict";t.d(s,{M5:()=>u,SQ:()=>f,_2:()=>p,lv:()=>x,mB:()=>j,nV:()=>h,rI:()=>o,ty:()=>m});var a=t(95155),l=t(12115),r=t(47971),n=t(63263),i=t(72251),d=t(75797),c=t(64269);let o=r.bL,m=r.l9;r.YJ,r.ZL;let x=r.Pb;r.z6;let h=l.forwardRef((e,s)=>{let{className:t,inset:l,children:i,...d}=e;return(0,a.jsxs)(r.ZP,{ref:s,className:(0,c.cn)("flex cursor-default gap-2 select-none items-center rounded-md px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l&&"pl-8",t),...d,children:[(0,a.jsx)(n.A,{className:"mr-auto h-4 w-4"}),i]})});h.displayName=r.ZP.displayName;let u=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.G5,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})});u.displayName=r.G5.displayName;let f=l.forwardRef((e,s)=>{let{className:t,sideOffset:l=4,...n}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{ref:s,sideOffset:l,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});f.displayName=r.UC.displayName;let p=l.forwardRef((e,s)=>{let{className:t,inset:l,...n}=e;return(0,a.jsx)(r.q7,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center gap-2 rounded-md px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l&&"pl-8",t),...n})});p.displayName=r.q7.displayName,l.forwardRef((e,s)=>{let{className:t,children:l,checked:n,...d}=e;return(0,a.jsxs)(r.H_,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...d,children:[(0,a.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),l]})}).displayName=r.H_.displayName,l.forwardRef((e,s)=>{let{className:t,children:l,...n}=e;return(0,a.jsxs)(r.hN,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(d.A,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=r.hN.displayName,l.forwardRef((e,s)=>{let{className:t,inset:l,...n}=e;return(0,a.jsx)(r.JU,{ref:s,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pr-8",t),...n})}).displayName=r.JU.displayName;let j=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...l})});j.displayName=r.wv.displayName},18332:(e,s,t)=>{"use strict";t.d(s,{Fc:()=>d,TN:()=>o,XL:()=>c});var a=t(95155),l=t(12115),r=t(83101),n=t(64269);let i=(0,r.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=l.forwardRef((e,s)=>{let{className:t,variant:l,...r}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,n.cn)(i({variant:l}),t),...r})});d.displayName="Alert";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",t),...l})});c.displayName="AlertTitle";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",t),...l})});o.displayName="AlertDescription"},18680:(e,s,t)=>{Promise.resolve().then(t.bind(t,75030))},20243:(e,s,t)=>{"use strict";t.d(s,{E:()=>r});var a=t(95155),l=t(64269);function r(e){let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-muted",s),...t})}},24896:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(95155),l=t(93037),r=t(34486);function n(){return(0,a.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,a.jsx)(r.P.div,{animate:{y:[0,-10,0],rotate:[0,5,0,-5,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:(0,a.jsx)(l.A,{className:"h-16 w-16 text-primary"})})})}},31120:(e,s,t)=>{"use strict";t.d(s,{T:()=>n});var a=t(95155),l=t(12115),r=t(64269);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});n.displayName="Textarea"},31868:(e,s,t)=>{"use strict";t.d(s,{default:()=>o});var a=t(95155),l=t(12115),r=t(20063),n=t(18332),i=t(7545),d=t(23451),c=t(24896);function o(e){let{children:s,requiredPermission:t}=e,{user:o,loading:m,hasPermission:x}=(0,d.A)(),h=(0,r.useRouter)(),[u,f]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{if(!m){if(!o)return void h.replace("/auth/login");t&&!x(t)?f(!1):f(!0)}},[o,m,t,x,h]),m||!u)?m||u||!o?(0,a.jsx)(c.A,{}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,a.jsxs)(n.Fc,{variant:"destructive",className:"max-w-md",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)(n.XL,{children:"وصول مرفوض!"}),(0,a.jsx)(n.TN,{children:"ليس لديك الصلاحية المطلوبة للوصول إلى هذه الصفحة. يرجى التواصل مع مدير النظام."})]})}):(0,a.jsx)(a.Fragment,{children:s})}},41052:(e,s,t)=>{"use strict";t.d(s,{C5:()=>g,MJ:()=>p,Rr:()=>j,eI:()=>u,lR:()=>f,lV:()=>c,zB:()=>m});var a=t(95155),l=t(12115),r=t(32467),n=t(22544),i=t(64269),d=t(76444);let c=n.Op,o=l.createContext({}),m=e=>{let{...s}=e;return(0,a.jsx)(o.Provider,{value:{name:s.name},children:(0,a.jsx)(n.xI,{...s})})},x=()=>{let e=l.useContext(o),s=l.useContext(h),{getFieldState:t,formState:a}=(0,n.xW)(),r=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...r}},h=l.createContext({}),u=l.forwardRef((e,s)=>{let{className:t,...r}=e,n=l.useId();return(0,a.jsx)(h.Provider,{value:{id:n},children:(0,a.jsx)("div",{ref:s,className:(0,i.cn)("space-y-2",t),...r})})});u.displayName="FormItem";let f=l.forwardRef((e,s)=>{let{className:t,...l}=e,{error:r,formItemId:n}=x();return(0,a.jsx)(d.J,{ref:s,className:(0,i.cn)(r&&"text-destructive",t),htmlFor:n,...l})});f.displayName="FormLabel";let p=l.forwardRef((e,s)=>{let{...t}=e,{error:l,formItemId:n,formDescriptionId:i,formMessageId:d}=x();return(0,a.jsx)(r.DX,{ref:s,id:n,"aria-describedby":l?"".concat(i," ").concat(d):"".concat(i),"aria-invalid":!!l,...t})});p.displayName="FormControl";let j=l.forwardRef((e,s)=>{let{className:t,...l}=e,{formDescriptionId:r}=x();return(0,a.jsx)("p",{ref:s,id:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...l})});j.displayName="FormDescription";let g=l.forwardRef((e,s)=>{var t;let{className:l,children:r,...n}=e,{error:d,formMessageId:c}=x(),o=d?String(null!=(t=null==d?void 0:d.message)?t:""):r;return o?(0,a.jsx)("p",{ref:s,id:c,className:(0,i.cn)("text-sm font-medium text-destructive",l),...n,children:o}):null});g.displayName="FormMessage"},44846:(e,s,t)=>{"use strict";t.d(s,{d:()=>i});var a=t(95155),l=t(12115),r=t(27599),n=t(64269);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.bL,{className:(0,n.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,ref:s,children:(0,a.jsx)(r.zi,{className:(0,n.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0 rtl:data-[state=checked]:-translate-x-4 rtl:data-[state=unchecked]:-translate-x-0")})})});i.displayName=r.bL.displayName},46767:(e,s,t)=>{"use strict";t.d(s,{Bc:()=>i,ZI:()=>o,k$:()=>c,m_:()=>d});var a=t(95155),l=t(12115),r=t(47520),n=t(64269);let i=r.Kq,d=r.bL,c=r.l9,o=l.forwardRef((e,s)=>{let{className:t,sideOffset:l=4,...i}=e;return(0,a.jsx)(r.UC,{ref:s,sideOffset:l,className:(0,n.cn)("z-50 whitespace-nowrap rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})});o.displayName=r.UC.displayName},53774:(e,s,t)=>{"use strict";t.d(s,{T:()=>x});var a=t(95155),l=t(17878),r=t(63263),n=t(51190),i=t(39285),d=t(64269),c=t(3998),o=t(11186),m=t(20063);function x(e){let{table:s,className:t,totalRows:x}=e,h=(0,m.useRouter)(),u=(0,m.usePathname)(),f=(0,m.useSearchParams)(),p=void 0!==x,j=s.getState().pagination.pageIndex,g=s.getState().pagination.pageSize,v=p?Math.ceil(x/g):s.getPageCount(),N=p?j>0:s.getCanPreviousPage();p||s.getCanNextPage();let b=p?e=>{let s=new URLSearchParams(f.toString());s.set("page",(e+1).toString()),h.push("".concat(u,"?").concat(s.toString()))}:s.setPageIndex;return(0,a.jsxs)("div",{className:(0,d.cn)("flex flex-col-reverse items-center justify-between gap-4 sm:flex-row sm:gap-6 lg:gap-8",t),children:[(0,a.jsxs)("div",{className:"flex-1 text-sm text-muted-foreground",children:[s.getFilteredSelectedRowModel().rows.length," من"," ",p?x:s.getFilteredRowModel().rows.length," صفوف مختارة."]}),(0,a.jsxs)("div",{className:"flex flex-col-reverse items-center gap-4 sm:flex-row sm:gap-6 lg:gap-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"صفوف لكل صفحة"}),(0,a.jsxs)(o.l6,{value:"".concat(g),onValueChange:e=>{var t;t=Number(e),p?(e=>{let s=new URLSearchParams(f.toString());s.set("limit",e.toString()),s.set("page","1"),h.push("".concat(u,"?").concat(s.toString()))})(t):s.setPageSize(t)},children:[(0,a.jsx)(o.bq,{className:"h-8 w-[70px]",children:(0,a.jsx)(o.yv,{placeholder:g})}),(0,a.jsx)(o.gC,{side:"top",children:[5,10,15,20,30,50].map(e=>(0,a.jsx)(o.eb,{value:"".concat(e),children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["صفحة ",j+1," من"," ",v]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(0,a.jsxs)(c.$,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>b(0),disabled:!N,children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,a.jsx)(l.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(c.$,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,a.jsx)(r.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(c.$,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,a.jsx)(n.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(c.$,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,a.jsx)(i.A,{className:"h-4 w-4"})]})]})]})]})}},73457:(e,s,t)=>{"use strict";t.d(s,{S:()=>d});var a=t(95155),l=t(12115),r=t(38162),n=t(72251),i=t(64269);let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.bL,{ref:s,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...l,children:(0,a.jsx)(r.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})})});d.displayName=r.bL.displayName},75030:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eI});var a=t(95155),l=t(12115),r=t(9012),n=t(18332),i=t(7545),d=t(96133),c=t(9567),o=t(30563),m=t(87270),x=t(3998),h=t(20146),u=t(5225),f=t(88964),p=t(56397),j=t(13630),g=t(50346),v=t(18527),N=t(78770),b=t(6259),w=t(98053),y=t(15894),C=t(64269),A=t(30926);let S=(0,A.createServerReference)("40c58d0bc8d4f91d67a942b18e51dcb1bf43076f6e",A.callServer,void 0,A.findSourceMapURL,"deleteClient"),R=(0,A.createServerReference)("40211bb4321aca8530a09b81e44f46cc59da30c2c4",A.callServer,void 0,A.findSourceMapURL,"deleteMultipleClients");var k=t(11647),T=t(73457),I=t(20063),E=t(52619),L=t.n(E),P=t(85897),M=t(51834),z=t(92033),_=t(73180),F=t(22544),B=t(54879),$=t(66942),U=t(41052),D=t(65142),Z=t(98634),V=t(44846);let J=B.Ik({loginIdentifier:B.Yj().min(3,"المعرف يجب أن يكون 3 أحرف على الأقل").optional().or(B.eu("")),password:B.Yj().min(6,"كلمة المرور يجب أن تكون 6 أحرف على الأقل").optional().or(B.eu("")),otpLoginEnabled:B.zM().default(!1)});function O(e){let{client:s,onCredentialsUpdated:t,children:r}=e,[n,i]=(0,l.useState)(!1),{toast:d}=(0,y.dj)(),c=(0,F.mN)({resolver:(0,$.u)(J),defaultValues:{loginIdentifier:(null==s?void 0:s.loginIdentifier)||"",password:"",otpLoginEnabled:(null==s?void 0:s.otpLoginEnabled)||!1}});l.useEffect(()=>{n&&c.reset({loginIdentifier:(null==s?void 0:s.loginIdentifier)||"",password:"",otpLoginEnabled:(null==s?void 0:s.otpLoginEnabled)||!1})},[n,s,c]);let{isSubmitting:o}=c.formState,m=async e=>{let a={};if(e.loginIdentifier!==s.loginIdentifier&&(a.loginIdentifier=e.loginIdentifier),e.password&&(a.password=e.password),e.otpLoginEnabled!==s.otpLoginEnabled&&(a.otpLoginEnabled=e.otpLoginEnabled),0===Object.keys(a).length)return void d({title:"لا توجد تغييرات",description:"لم تقم بإدخال أي بيانات جديدة.",variant:"default"});let l=await (0,Z.z)(s.id,a);l.success&&l.updatedClient?(d({title:"تم تحديث بيانات الدخول بنجاح"}),t(l.updatedClient),i(!1)):d({title:"خطأ",description:l.error,variant:"destructive"})};return(0,a.jsxs)(M.lG,{open:n,onOpenChange:i,children:[(0,a.jsx)(M.zM,{asChild:!0,children:r}),(0,a.jsx)(M.Cf,{className:"sm:max-w-md",children:(0,a.jsx)(U.lV,{...c,children:(0,a.jsxs)("form",{onSubmit:c.handleSubmit(m),children:[(0,a.jsxs)(M.c7,{children:[(0,a.jsxs)(M.L3,{children:["إدارة بيانات الدخول لـ: ",s.name]}),(0,a.jsx)(M.rr,{children:"استخدم هذا النموذج لتعيين أو تحديث معرف تسجيل الدخول وكلمة المرور."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsx)(U.zB,{control:c.control,name:"loginIdentifier",render:e=>{let{field:s}=e;return(0,a.jsxs)(U.eI,{children:[(0,a.jsx)(U.lR,{children:"معرف تسجيل الدخول"}),(0,a.jsx)(U.MJ,{children:(0,a.jsx)(D.p,{placeholder:"اختر معرفًا فريدًا للعميل",...s})}),(0,a.jsx)(U.C5,{})]})}}),(0,a.jsx)(U.zB,{control:c.control,name:"password",render:e=>{let{field:s}=e;return(0,a.jsxs)(U.eI,{children:[(0,a.jsx)(U.lR,{children:"كلمة المرور الجديدة"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(U.MJ,{children:(0,a.jsx)(D.p,{type:"password",placeholder:"اتركه فارغًا لعدم التغيير",...s,className:"pr-10"})})]}),(0,a.jsx)(U.C5,{})]})}}),(0,a.jsx)(U.zB,{control:c.control,name:"otpLoginEnabled",render:e=>{let{field:s}=e;return(0,a.jsxs)(U.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,a.jsx)("div",{className:"space-y-0.5",children:(0,a.jsx)(U.lR,{children:"تفعيل الدخول بخطوتين (OTP)"})}),(0,a.jsx)(U.MJ,{children:(0,a.jsx)(V.d,{checked:s.value,onCheckedChange:s.onChange})})]})}})]}),(0,a.jsx)(M.Es,{children:(0,a.jsxs)(x.$,{type:"submit",disabled:o,children:[o&&(0,a.jsx)(z.A,{className:"me-2 h-4 w-4 animate-spin"}),(0,a.jsx)(_.A,{className:"me-2 h-4 w-4"}),"حفظ التغييرات"]})})]})})})]})}var H=t(46767),q=t(41165),G=t(52240),K=t(90043);function X(e){let{column:s,title:t,className:l}=e;return s.getCanSort()?(0,a.jsx)("div",{className:(0,C.cn)("flex items-center space-x-2 justify-center",l),children:(0,a.jsxs)(b.rI,{children:[(0,a.jsx)(b.ty,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"ghost",size:"sm",className:"h-8 data-[state=open]:bg-accent",children:[(0,a.jsx)("span",{children:t}),"desc"===s.getIsSorted()?(0,a.jsx)(q.A,{className:"ml-2 h-4 w-4"}):"asc"===s.getIsSorted()?(0,a.jsx)(G.A,{className:"ml-2 h-4 w-4"}):(0,a.jsx)(K.A,{className:"ml-2 h-4 w-4"})]})}),(0,a.jsxs)(b.SQ,{align:"start",children:[(0,a.jsxs)(b._2,{onClick:()=>s.toggleSorting(!1),children:[(0,a.jsx)(G.A,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"تصاعدي"]}),(0,a.jsxs)(b._2,{onClick:()=>s.toggleSorting(!0),children:[(0,a.jsx)(q.A,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"تنازلي"]})]})]})}):(0,a.jsx)("div",{className:(0,C.cn)(l),children:t})}let W=e=>{let{row:s,onDataChanged:t}=e,{toast:l}=(0,y.dj)(),r=s.original,n=async e=>{let s=await S(e);s.success?(l({title:"تم الحذف بنجاح"}),t(void 0,e)):l({title:"خطأ",description:s.error,variant:"destructive"})};return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)(b.rI,{children:[(0,a.jsx)(b.ty,{asChild:!0,children:(0,a.jsx)(x.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(b.SQ,{align:"end",children:[(0,a.jsx)(b._2,{asChild:!0,children:(0,a.jsxs)(L(),{href:"/clients/".concat(r.id),className:"justify-end w-full flex items-center gap-2",children:[(0,a.jsx)("span",{children:"عرض البروفايل"}),(0,a.jsx)(u.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(c.A,{isEditing:!0,initialData:r,onClientUpdated:t,children:(0,a.jsxs)(b._2,{onSelect:e=>e.preventDefault(),className:"w-full flex justify-between",children:[(0,a.jsx)("span",{children:"تعديل"}),(0,a.jsx)(f.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(O,{client:r,onCredentialsUpdated:t,children:(0,a.jsxs)(b._2,{onSelect:e=>e.preventDefault(),className:"justify-end w-full flex items-center gap-2",children:[(0,a.jsx)("span",{children:"إدارة الدخول"}),(0,a.jsx)(p.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(b._2,{asChild:!0,children:(0,a.jsxs)(L(),{href:"/reports/account-statement?accountId=".concat(r.id),className:"justify-end w-full flex items-center gap-2",children:[(0,a.jsx)("span",{children:"كشف الحساب"}),(0,a.jsx)(u.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(w.Lt,{children:[(0,a.jsx)(w.tv,{asChild:!0,children:(0,a.jsxs)(b._2,{onSelect:e=>e.preventDefault(),className:"text-red-500 focus:text-red-600 justify-between w-full",children:[(0,a.jsx)("span",{children:"حذف"}),(0,a.jsx)(j.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(w.EO,{children:[(0,a.jsxs)(w.wd,{children:[(0,a.jsx)(w.r7,{children:"هل أنت متأكد؟"}),(0,a.jsx)(w.$v,{children:"هذا الإجراء سيحذف السجل بشكل دائم. لا يمكن حذف علاقة مرتبطة بحسابات مالية."})]}),(0,a.jsxs)(w.ck,{children:[(0,a.jsx)(w.Zr,{children:"إلغاء"}),(0,a.jsx)(w.Rx,{onClick:()=>n(r.id),className:(0,C.cn)((0,x.r)({variant:"destructive"})),children:"نعم، احذف"})]})]})]})]})]})})};function Y(e){let{table:s}=e,{toast:t}=(0,y.dj)(),l=(0,I.useRouter)(),r=async()=>{let e=s.getSelectedRowModel().rows.map(e=>e.original.id);if(0===e.length)return;let a=await R(e);a.success?(t({title:"تم حذف ".concat(e.length," سجلات بنجاح.")}),s.resetRowSelection(),l.refresh()):t({title:"خطأ",description:a.error,variant:"destructive"})};return(0,a.jsxs)("div",{className:"space-y-4",children:[s.getFilteredSelectedRowModel().rows.length>0&&(0,a.jsxs)(w.Lt,{children:[(0,a.jsx)(w.tv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"destructive",children:[(0,a.jsx)(j.A,{className:"me-2 h-4 w-4"})," حذف (",s.getFilteredSelectedRowModel().rows.length,")"]})}),(0,a.jsxs)(w.EO,{children:[(0,a.jsxs)(w.wd,{children:[(0,a.jsx)(w.r7,{children:"هل أنت متأكد تمامًا؟"}),(0,a.jsxs)(w.$v,{children:["هذا الإجراء سيقوم بحذف ",s.getFilteredSelectedRowModel().rows.length," سجلات بشكل دائم ولا يمكن التراجع عنه."]})]}),(0,a.jsxs)(w.ck,{children:[(0,a.jsx)(w.Zr,{children:"إلغاء"}),(0,a.jsx)(w.Rx,{onClick:r,className:(0,C.cn)((0,x.r)({variant:"destructive"})),children:"نعم، احذف المحدد"})]})]})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(m.XI,{children:[(0,a.jsx)(m.A0,{children:s.getHeaderGroups().map(e=>(0,a.jsx)(m.Hj,{children:e.headers.map(e=>(0,a.jsx)(m.nd,{className:"font-bold text-center",children:(0,o.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(m.BF,{children:s.getRowModel().rows.length?s.getRowModel().rows.map(e=>(0,a.jsx)(m.Hj,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,a.jsx)(m.nA,{className:"text-center",children:(0,o.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(m.Hj,{children:(0,a.jsx)(m.nA,{colSpan:s.getAllColumns().length,className:"h-48 text-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,a.jsx)(N.A,{className:"h-10 w-10"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"لا توجد نتائج"}),(0,a.jsx)("p",{className:"text-sm",children:"لم يتم العثور على سجلات تطابق الفلاتر المطبقة."})]})})})})]})})]})}var Q=t(22452),ee=t(23107),es=t(26615),et=t(88822),ea=t(55253),el=t(86948),er=t(89679),en=t(47974),ei=t(66065),ed=t(63830),ec=t(6943),eo=t(59729),em=t(27314),ex=t(10639),eh=t(20583),eu=t(14223),ef=t(19056),ep=t(86259);function ej(e){let{client:s,relationSections:t,onClientUpdated:r}=e,{cardSettings:n}=(0,eh.A)(),i=(0,I.useRouter)(),{toast:d}=(0,y.dj)(),o=async e=>{if(s.useCount&&s.useCount>0)return void d({title:"لا يمكن الحذف",description:"لا يمكن حذف هذه العلاقة لوجود معاملات مالية مرتبطة بها.",variant:"destructive"});r(void 0,e);let t=await S(e);t.success||(d({title:"خطأ",description:t.error,variant:"destructive"}),i.refresh())},{relationTypeLabel:m,Icon:N,entityTypeLabel:A,gradientStyle:R}=l.useMemo(()=>{let e,t,a={},l=n||{};switch(s.relationType){case"supplier":e=ed.A,t="مورد",a={background:"linear-gradient(to right, ".concat(l.headerSupplierColorFrom||"hsl(var(--accent))",", ").concat(l.headerSupplierColorTo||"hsl(var(--accent))",")")};break;case"both":e=ec.A,t="عميل ومورد",a={background:"linear-gradient(to right, ".concat(l.headerBothColorFrom||"hsl(var(--primary))",", ").concat(l.headerBothColorTo||"hsl(var(--accent))",")")};break;default:e=ec.A,t="عميل",a={background:"linear-gradient(to right, ".concat(l.headerClientColorFrom||"hsl(var(--primary))",", ").concat(l.headerClientColorTo||"hsl(var(--primary))",")")}}return{relationTypeLabel:t,Icon:e,entityTypeLabel:"company"===s.type?"شركة":"فرد",gradientStyle:a}},[s.relationType,s.type,n]),T=l.useMemo(()=>t.flatMap(e=>e.fields).find(e=>"paymentType"===e.id),[t]),E=l.useMemo(()=>{var e;return null==T||null==(e=T.options)?void 0:e.find(e=>e.value===s.paymentType)},[T,s.paymentType]),M=(null==E?void 0:E.label)||s.paymentType,z="credit"===s.paymentType?"bg-green-500 hover:bg-green-600":"bg-blue-500 hover:bg-blue-600",_="company"===s.type?eo.A:em.A,F=[s.country,s.province,s.streetAddress].filter(Boolean).join("، "),B=l.useMemo(()=>{if(!t||!Array.isArray(t))return[];let e=t.flatMap(e=>e.fields),a=[],l=["name","type","relationType","status","paymentType","country","province","streetAddress","avatarUrl","password","createdAt","createdBy","balance","lastTransaction","useCount","id","loginIdentifier"];return e.forEach(e=>{!l.includes(e.id)&&s[e.id]&&a.push({id:e.id,label:e.label,value:s[e.id]})}),a},[s,t]);return(0,a.jsxs)(el.Zp,{className:"flex flex-col h-full transition-all duration-300 hover:shadow-xl hover:-translate-y-1 rounded-xl",children:[(0,a.jsxs)(el.aR,{className:"relative p-4 flex flex-row items-center gap-4 text-primary-foreground rounded-t-xl",style:R,children:[(0,a.jsxs)(P.eu,{className:"h-16 w-16 border-4 border-background/50 shrink-0 shadow-sm",children:[(0,a.jsx)(P.BK,{src:s.avatarUrl,alt:s.name}),(0,a.jsx)(P.q5,{className:"text-xl text-foreground",children:(0,a.jsx)(g.A,{className:"h-10 w-10 text-muted-foreground"})})]}),(0,a.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,a.jsx)(el.ZB,{className:"font-bold text-lg truncate",title:s.name,children:(0,a.jsxs)(L(),{href:"/clients/".concat(s.id),className:"hover:underline flex items-center gap-2",children:[(0,a.jsx)(N,{className:"h-5 w-5"}),s.name,s.password&&(0,a.jsx)(H.Bc,{children:(0,a.jsxs)(H.m_,{children:[(0,a.jsx)(H.k$,{asChild:!0,children:(0,a.jsx)(v.A,{className:"h-5 w-5 text-lime-300"})}),(0,a.jsx)(H.ZI,{children:(0,a.jsx)("p",{children:"هذه العلاقة لديها حساب فعال لتسجيل الدخول."})})]})})]})}),(0,a.jsxs)(el.BT,{className:"text-xs flex items-center gap-2 mt-2 text-white/80",children:[(0,a.jsxs)(k.E,{variant:"outline",className:"bg-white/10 border-white/20 text-white",children:[(0,a.jsx)(N,{className:"me-1.5 h-3 w-3"}),m]}),(0,a.jsxs)(k.E,{variant:"outline",className:"bg-white/10 border-white/20 text-white",children:[(0,a.jsx)(_,{className:"me-1.5 h-3 w-3"}),A]})]})]}),(0,a.jsxs)(b.rI,{children:[(0,a.jsx)(b.ty,{asChild:!0,children:(0,a.jsx)(x.$,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-background/20 text-white",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(b.SQ,{align:"end",children:[(0,a.jsx)(b._2,{asChild:!0,children:(0,a.jsxs)(L(),{href:"/clients/".concat(s.id),className:"justify-end w-full flex items-center gap-2",children:[(0,a.jsx)("span",{children:"عرض البروفايل"}),(0,a.jsx)(u.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(c.A,{isEditing:!0,initialData:s,onClientUpdated:r,children:(0,a.jsxs)(b._2,{onSelect:e=>e.preventDefault(),className:"w-full flex justify-between",children:[(0,a.jsx)("span",{children:"تعديل"}),(0,a.jsx)(f.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(O,{client:s,onCredentialsUpdated:r,children:(0,a.jsxs)(b._2,{onSelect:e=>e.preventDefault(),className:"justify-end w-full flex items-center gap-2",children:[(0,a.jsx)("span",{children:"إدارة الدخول"}),(0,a.jsx)(p.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(b._2,{asChild:!0,children:(0,a.jsxs)(L(),{href:"/reports/account-statement?accountId=".concat(s.id),className:"justify-end w-full flex items-center gap-2",children:[(0,a.jsx)("span",{children:"كشف الحساب"}),(0,a.jsx)(u.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(w.Lt,{children:[(0,a.jsx)(w.tv,{asChild:!0,children:(0,a.jsxs)(b._2,{onSelect:e=>e.preventDefault(),className:"text-red-500 focus:text-red-600 justify-between w-full",children:[(0,a.jsx)("span",{children:"حذف"}),(0,a.jsx)(j.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(w.EO,{children:[(0,a.jsxs)(w.wd,{children:[(0,a.jsx)(w.r7,{children:"هل أنت متأكد؟"}),(0,a.jsx)(w.$v,{children:"هذا الإجراء سيحذف السجل بشكل دائم. لا يمكن حذف علاقة مرتبطة بحسابات مالية."})]}),(0,a.jsxs)(w.ck,{children:[(0,a.jsx)(w.Zr,{children:"إلغاء"}),(0,a.jsx)(w.Rx,{onClick:()=>o(s.id),className:(0,C.cn)((0,x.r)({variant:"destructive"})),children:"نعم، احذف"})]})]})]})]})]})]}),(0,a.jsxs)(el.Wu,{className:"px-4 py-3 flex-grow text-sm text-muted-foreground space-y-2",children:[F&&(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:F}),(0,a.jsx)(ex.A,{className:"h-4 w-4 text-primary"})]}),B.length>0&&F&&(0,a.jsx)(ep.Separator,{className:"my-2"}),B.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)("span",{className:"font-semibold text-foreground truncate",children:e.value}),(s=e.id).includes("phone")?(0,a.jsx)(er.A,{className:"h-4 w-4 text-primary"}):s.includes("email")?(0,a.jsx)(en.A,{className:"h-4 w-4 text-primary"}):(0,a.jsx)(ei.A,{className:"h-4 w-4 text-primary"})]},e.id)})]}),(0,a.jsxs)(el.wL,{className:"p-2 bg-muted/30 flex justify-between items-center text-xs border-t",children:[(0,a.jsx)(H.Bc,{children:(0,a.jsxs)(H.m_,{children:[(0,a.jsx)(H.k$,{asChild:!0,children:(0,a.jsx)(x.$,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground cursor-default",children:(0,a.jsx)(ei.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(H.ZI,{side:"top",className:"whitespace-nowrap",children:[(0,a.jsxs)("p",{children:["أضيف بواسطة: ",s.createdBy]}),(0,a.jsxs)("p",{children:["في: ",s.createdAt?(0,eu.GP)((0,ef.H)(s.createdAt),"yyyy-MM-dd"):"N/A"]})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[s.paymentType&&(0,a.jsx)(k.E,{className:(0,C.cn)("px-2 py-0.5 text-white",z),children:M}),(0,a.jsx)(k.E,{variant:"active"===s.status?"default":"destructive",className:(0,C.cn)("active"===s.status?"bg-green-500":"bg-red-500","px-2 py-0.5 text-white"),children:"active"===s.status?"نشط":"غير نشط"})]})]})]})}var eg=t(90109),ev=t(11186),eN=t(53774),eb=t(92273),ew=t(26333),ey=t(76444),eC=t(36117),eA=t(60013);function eS(e){var s;let{initialRelations:t,totalRelations:r,relationSections:n}=e,i=(0,I.useRouter)(),d=(0,I.usePathname)(),m=(0,I.useSearchParams)(),[h,u]=l.useState(t),[f,p]=l.useState("cards"),[j,N]=l.useState(!1),[b,w]=l.useState({search:m.get("search")||"",relationType:m.get("relationType")||"all",paymentType:m.get("paymentType")||"all",status:m.get("status")||"all",country:m.get("country")||"all",province:m.get("province")||"all"});l.useEffect(()=>{u(t)},[t]);let y=(e,s)=>{e?u((0,eA.jM)(s=>{let t=s.findIndex(s=>s.id===e.id);-1!==t?s[t]=e:s.unshift(e)})):s?u((0,eA.jM)(e=>e.filter(e=>e.id!==s))):i.refresh()},A=()=>{N(!0);let e=new URLSearchParams(m.toString());Object.entries(b).forEach(s=>{let[t,a]=s;a&&"all"!==a?e.set(t,a):e.delete(t)}),e.set("page","1"),i.push("".concat(d,"?").concat(e.toString()))};l.useEffect(()=>{N(!1)},[t]);let S=l.useMemo(()=>n&&Array.isArray(n)?[{id:"select",header:e=>{let{table:s}=e;return(0,a.jsx)(T.S,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"Select all"})},cell:e=>{let{row:s}=e;return(0,a.jsx)(T.S,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"Select row"})},enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:e=>{let{column:s}=e;return(0,a.jsx)(X,{column:s,title:"العلاقة"})},cell:e=>{let{row:s}=e,t=s.original;return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(P.eu,{className:"h-10 w-10",children:[(0,a.jsx)(P.BK,{src:t.avatarUrl,alt:t.name}),(0,a.jsx)(P.q5,{children:(0,a.jsx)(g.A,{className:"h-6 w-6 text-muted-foreground"})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-bold",children:t.name}),t.loginIdentifier&&(0,a.jsx)(H.Bc,{children:(0,a.jsxs)(H.m_,{children:[(0,a.jsx)(H.k$,{asChild:!0,children:(0,a.jsx)(v.A,{className:"h-5 w-5 text-green-500"})}),(0,a.jsx)(H.ZI,{children:(0,a.jsx)("p",{children:"هذه العلاقة لديها حساب فعال لتسجيل الدخول."})})]})})]}),t.code&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground font-mono",children:["(",t.code,")"]})]})]})}},...n.flatMap(e=>e.fields).filter(e=>e.visible&&!["name","code"].includes(e.id)).map(e=>({accessorKey:e.id,header:s=>{let{column:t}=s;return(0,a.jsx)(X,{column:t,title:e.label})},cell:s=>{let{row:t}=s;var l=t,r=e;let n=l.original[r.id];if(null==n||""===n)return(0,a.jsx)("div",{className:"text-center",children:"-"});switch(r.id){case"relationType":return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(k.E,{variant:"secondary",children:{client:"عميل",supplier:"مورد",both:"عميل ومورد"}[n]||n})});case"status":return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(k.E,{variant:"active"===n?"default":"destructive",className:(0,C.cn)("active"===n?"bg-green-500":""),children:{active:"نشط",inactive:"غير نشط"}[n]||n})});case"paymentType":return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(k.E,{variant:"outline",children:{cash:"نقدي",credit:"آجل"}[n]||n})});case"type":return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(k.E,{variant:"outline",children:{company:"شركة",individual:"فرد"}[n]||n})});default:return(0,a.jsx)("div",{className:"text-center",children:n})}},filterFn:(e,s,t)=>t.includes(e.getValue(s))})),{id:"actions",header:()=>(0,a.jsx)("div",{className:"text-center font-bold",children:"خيارات"}),cell:e=>{let{row:s}=e;return(0,a.jsx)(W,{row:s,onDataChanged:y})}}]:[],[n,y]),R=Math.ceil(r/(Number(m.get("limit"))||15)),E=(0,o.N4)({data:h,columns:S,pageCount:R,getCoreRowModel:(0,eb.HT)(),getPaginationRowModel:(0,eb.kW)(),manualPagination:!0,manualFiltering:!0}),L=Object.values(b).filter(e=>e&&"all"!==e&&""!==e).length;return(0,a.jsxs)(el.Zp,{children:[(0,a.jsx)(el.aR,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(el.ZB,{children:"إدارة العلاقات"}),(0,a.jsx)(el.BT,{children:"إدارة جميع العملاء والموردين في مكان واحد."})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(c.A,{onClientAdded:e=>y(e),onClientUpdated:y,children:(0,a.jsxs)(x.$,{children:[(0,a.jsx)(Q.A,{className:"me-2 h-4 w-4"})," إضافة جديدة"]})})})]})}),(0,a.jsxs)(el.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(ew.AM,{children:[(0,a.jsx)(ew.Wv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"h-8",children:[(0,a.jsx)(ee.A,{className:"me-2 h-4 w-4"}),"الفلاتر",L>0&&(0,a.jsx)(k.E,{className:"ms-2",children:L})]})}),(0,a.jsx)(ew.hl,{className:"w-80",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium leading-none",children:"الفلاتر المتقدمة"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"قم بتصفية النتائج بناءً على المعايير أدناه."})]}),(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(ey.J,{children:"نوع العلاقة"}),(0,a.jsxs)(ev.l6,{value:b.relationType,onValueChange:e=>w(s=>({...s,relationType:e})),children:[(0,a.jsx)(ev.bq,{className:"col-span-2",children:(0,a.jsx)(ev.yv,{})}),(0,a.jsxs)(ev.gC,{children:[(0,a.jsx)(ev.eb,{value:"all",children:"كل الأنواع"}),(0,a.jsx)(ev.eb,{value:"client",children:"عميل"}),(0,a.jsx)(ev.eb,{value:"supplier",children:"مورد"}),(0,a.jsx)(ev.eb,{value:"both",children:"كلاهما"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(ey.J,{children:"نوع التعامل"}),(0,a.jsxs)(ev.l6,{value:b.paymentType,onValueChange:e=>w(s=>({...s,paymentType:e})),children:[(0,a.jsx)(ev.bq,{className:"col-span-2",children:(0,a.jsx)(ev.yv,{})}),(0,a.jsxs)(ev.gC,{children:[(0,a.jsx)(ev.eb,{value:"all",children:"كل الأنواع"}),(0,a.jsx)(ev.eb,{value:"cash",children:"نقدي"}),(0,a.jsx)(ev.eb,{value:"credit",children:"آجل"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(ey.J,{children:"الحالة"}),(0,a.jsxs)(ev.l6,{value:b.status,onValueChange:e=>w(s=>({...s,status:e})),children:[(0,a.jsx)(ev.bq,{className:"col-span-2",children:(0,a.jsx)(ev.yv,{})}),(0,a.jsxs)(ev.gC,{children:[(0,a.jsx)(ev.eb,{value:"all",children:"كل الحالات"}),(0,a.jsx)(ev.eb,{value:"active",children:"نشط"}),(0,a.jsx)(ev.eb,{value:"inactive",children:"غير نشط"})]})]})]}),(0,a.jsx)(ep.Separator,{}),(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(ey.J,{children:"الدولة"}),(0,a.jsxs)(ev.l6,{value:b.country,onValueChange:e=>w(s=>({...s,country:e,province:"all"})),children:[(0,a.jsx)(ev.bq,{className:"col-span-2",children:(0,a.jsx)(ev.yv,{})}),(0,a.jsx)(ev.gC,{children:[{name:"all"},...eC.A].map(e=>(0,a.jsx)(ev.eb,{value:e.name,children:"all"===e.name?"كل الدول":e.name},e.name))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(ey.J,{children:"المحافظة"}),(0,a.jsxs)(ev.l6,{value:b.province,onValueChange:e=>w(s=>({...s,province:e})),disabled:"all"===b.country,children:[(0,a.jsx)(ev.bq,{className:"col-span-2",children:(0,a.jsx)(ev.yv,{})}),(0,a.jsxs)(ev.gC,{children:[(0,a.jsx)(ev.eb,{value:"all",children:"كل المحافظات"}),((null==(s=eC.A.find(e=>e.name===b.country))?void 0:s.provinces)||[]).map(e=>(0,a.jsx)(ev.eb,{value:e.name,children:e.name},e.name))]})]})]}),(0,a.jsx)(ep.Separator,{}),(0,a.jsxs)(x.$,{onClick:A,disabled:j,children:[j&&(0,a.jsx)(z.A,{className:"me-2 h-4 w-4 animate-spin"}),"تطبيق الفلاتر"]})]})]})})]}),(0,a.jsxs)("div",{className:"relative flex-grow sm:flex-grow-0 sm:w-72",children:[(0,a.jsx)(eg.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(D.p,{placeholder:"بحث بالاسم, الهاتف, المعرف...",value:b.search,onChange:e=>w(s=>({...s,search:e.target.value})),onKeyDown:e=>"Enter"===e.key&&A(),className:"ps-10 h-8"})]}),""!==m.toString()&&(0,a.jsxs)(x.$,{variant:"ghost",size:"sm",onClick:()=>i.push(d),children:[(0,a.jsx)(es.A,{className:"me-2 h-4 w-4"})," مسح"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(x.$,{variant:"cards"===f?"secondary":"outline",size:"sm",onClick:()=>p("cards"),children:[(0,a.jsx)(et.A,{className:"me-2 h-4 w-4"})," بطاقات"]}),(0,a.jsxs)(x.$,{variant:"table"===f?"secondary":"outline",size:"sm",onClick:()=>p("table"),children:[(0,a.jsx)(ea.A,{className:"me-2 h-4 w-4"})," جدول"]})]})]}),j?(0,a.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,a.jsx)(z.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:["table"===f?(0,a.jsx)(Y,{table:E}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:h.map(e=>(0,a.jsx)(ej,{client:e,relationSections:n,onClientUpdated:y},e.id))}),0===h.length&&(0,a.jsx)("div",{className:"col-span-full text-center p-8 border-2 border-dashed rounded-lg",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"لا توجد نتائج تطابق الفلتر."})}),(0,a.jsx)(eN.T,{table:E,totalRows:r})]})]})]})}var eR=t(20243),ek=t(31868);function eT(){var e,s;let t=(0,I.useSearchParams)(),[c,o]=l.useState([]),[m,x]=l.useState(0),[h,u]=l.useState([]),[f,p]=l.useState(!0),[j,g]=l.useState(null),v=Number(null!=(e=t.get("page"))?e:"1"),N=Number(null!=(s=t.get("limit"))?s:"15"),b=t.get("search"),w=t.get("relationType"),y=t.get("paymentType"),C=t.get("status"),A=t.get("country"),S=t.get("province"),R=t.get("sortBy");return(l.useEffect(()=>{(async()=>{p(!0);try{let[e,s]=await Promise.all([(0,r.L)({page:v,limit:N,searchTerm:b,relationType:w,paymentType:y,status:C,country:A,province:S,sortBy:R}),(0,d.m)()]);o(e.clients),x(e.total),u(s.relationSections||[])}catch(e){g(e.message||"Failed to load data")}finally{p(!1)}})()},[v,N,b,w,y,C,A,S,R]),f)?(0,a.jsx)(eR.E,{className:"h-[600px] w-full"}):j?(0,a.jsxs)(n.Fc,{variant:"destructive",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)(n.XL,{children:"حدث خطأ!"}),(0,a.jsx)(n.TN,{children:j})]}):(0,a.jsx)(eS,{initialRelations:c,totalRelations:m,relationSections:h})}function eI(){return(0,a.jsx)(ek.default,{requiredPermission:"relations:read",children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)(eR.E,{className:"h-[600px] w-full"}),children:(0,a.jsx)(eT,{})})})})}},86259:(e,s,t)=>{"use strict";t.d(s,{Separator:()=>i});var a=t(95155),l=t(12115),r=t(57268),n=t(64269);let i=l.forwardRef((e,s)=>{let{className:t,orientation:l="horizontal",decorative:i=!0,...d}=e;return(0,a.jsx)(r.b,{ref:s,decorative:i,orientation:l,className:(0,n.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",t),...d})});i.displayName=r.b.displayName},87270:(e,s,t)=>{"use strict";t.d(s,{A0:()=>i,BF:()=>d,Gg:()=>c,Hj:()=>o,XI:()=>n,nA:()=>x,nd:()=>m});var a=t(95155),l=t(12115),r=t(64269);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,r.cn)("w-full caption-bottom text-sm",t),...l})})});n.displayName="Table";let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("thead",{ref:s,className:(0,r.cn)("[&_tr]:border-b",t),...l})});i.displayName="TableHeader";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,r.cn)("[&_tr:last-child]:border-0",t),...l})});d.displayName="TableBody";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...l})});c.displayName="TableFooter";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tr",{ref:s,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...l})});o.displayName="TableRow";let m=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("th",{ref:s,className:(0,r.cn)("h-12 px-4 text-right align-middle font-bold text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...l})});m.displayName="TableHead";let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("td",{ref:s,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...l})});x.displayName="TableCell",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("caption",{ref:s,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",t),...l})}).displayName="TableCaption"},98053:(e,s,t)=>{"use strict";t.d(s,{$v:()=>p,EO:()=>x,Lt:()=>d,Rx:()=>j,Zr:()=>g,ck:()=>u,r7:()=>f,tv:()=>c,wd:()=>h});var a=t(95155),l=t(12115),r=t(35646),n=t(64269),i=t(3998);let d=r.bL,c=r.l9,o=r.ZL,m=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:s})});m.displayName=r.hJ.displayName;let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{}),(0,a.jsx)(r.UC,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l})]})});x.displayName=r.UC.displayName;let h=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};h.displayName="AlertDialogHeader";let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};u.displayName="AlertDialogFooter";let f=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hE,{ref:s,className:(0,n.cn)("text-lg font-semibold",t),...l})});f.displayName=r.hE.displayName;let p=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...l})});p.displayName=r.VY.displayName;let j=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.rc,{ref:s,className:(0,n.cn)((0,i.r)(),t),...l})});j.displayName=r.rc.displayName;let g=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.ZD,{ref:s,className:(0,n.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...l})});g.displayName=r.ZD.displayName}},e=>{e.O(0,[9135,7210,4909,9625,315,5111,4127,9967,1374,783,4223,8994,2619,43,84,13,4486,563,7881,9158,5921,4762,2312,7737,8441,1255,7358],()=>e(e.s=18680)),_N_E=e.O()}]);