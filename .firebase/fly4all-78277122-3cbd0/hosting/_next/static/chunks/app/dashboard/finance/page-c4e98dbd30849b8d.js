(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5312],{1272:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},14294:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(12115);let n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:s=2,absoluteStrokeWidth:c,className:o="",children:d,iconNode:u,...p}=e;return(0,a.createElement)("svg",{ref:t,...i,width:l,height:l,stroke:r,strokeWidth:c?24*Number(s)/Number(l):s,className:n("lucide",o),...p},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),s=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:s,...c}=r;return(0,a.createElement)(l,{ref:i,iconNode:t,className:n("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),s),...c})});return r.displayName="".concat(e),r}},14585:(e,t,r)=>{"use strict";let a,n,i;r.d(t,{db:()=>i,j:()=>n,y:()=>a});var l=r(52078),s=r(19708),c=r(81328);a=(0,l.Dk)().length?(0,l.Dk)()[0]:(0,l.Wp)({apiKey:"AIzaSyCtlF3onBhtwg0Hh3iOOEjygi9mj81wxrA",authDomain:"fly4all-78277122-3cbd0.firebaseapp.com",projectId:"fly4all-78277122-3cbd0",storageBucket:"fly4all-78277122-3cbd0.firebasestorage.app",messagingSenderId:"108505683067",appId:"1:108505683067:web:3ab7755349630154e77ede"}),n=(0,c.xI)(a),i=(0,s.aU)(a)},15377:(e,t,r)=>{"use strict";r.d(t,{yZ:()=>s});let a=(e,t)=>{if(!e||!t)return!1;let r=e.trim(),a=t.trim();return!!r&&!!a&&(r===a||r.startsWith("".concat(a,"-"))||r.startsWith("".concat(a,"."))||r.startsWith("".concat(a,"/"))||r.startsWith(a))},n=(e,t)=>{for(let r of t)if(a(e,r))return!0;return!1};function i(e,t){if(!e||!t)return"other";let{defaultCashId:r,defaultBankId:i,receivableAccountId:l,arAccountId:s,payableAccountId:c,apAccountId:o,hybridRelationAccountId:d,clearingAccountId:u,revenueMap:p,expenseMap:f,generalRevenueId:m,generalExpenseId:y}=t;return a(e,r)?"cash":a(e,i)?"bank":a(e,d)?"hybrid":a(e,l)||a(e,s)?"client":a(e,c)||a(e,o)?"supplier":a(e,u)?"clearing":n(e,[m,...Object.values(p||{})])?"revenue":n(e,[y,...Object.values(f||{})])?"expense":"other"}let l=e=>{if("number"==typeof e&&!Number.isNaN(e))return e;if("string"==typeof e&&""!==e.trim()){let t=Number(e);return Number.isFinite(t)?t:0}return 0};function s(e,t){var r,a;if(Array.isArray(e.entries)&&e.entries.length>0)return e.entries.map(e=>{var r,a,n;let s=l(null!=(r=e.debit)?r:"debit"===e.type?e.amount:0),c=l(null!=(a=e.credit)?a:"credit"===e.type?e.amount:0),o=e.accountType||i(e.accountId,t);return{accountId:e.accountId,debit:s,credit:c,amount:s>0?s:c,description:null!=(n=e.description)?n:e.note,currency:e.currency,relationId:e.relationId,companyId:e.companyId,accountType:o,type:s>0?"debit":"credit"}});let n=[];if(Array.isArray(e.debitEntries))for(let a of e.debitEntries){let e=l(null!=(r=a.amount)?r:a.debit);n.push({accountId:a.accountId,debit:e,credit:0,amount:e,description:a.description,currency:a.currency,relationId:a.relationId,companyId:a.companyId,accountType:i(a.accountId,t),type:"debit"})}if(Array.isArray(e.creditEntries))for(let r of e.creditEntries){let e=l(null!=(a=r.amount)?a:r.credit);n.push({accountId:r.accountId,debit:0,credit:e,amount:e,description:r.description,currency:r.currency,relationId:r.relationId,companyId:r.companyId,accountType:i(r.accountId,t),type:"credit"})}return n}},35033:(e,t,r)=>{Promise.resolve().then(r.bind(r,41021))},40671:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},41021:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var a=r(95155),n=r(12115),i=r(86948),l=r(94972),s=r(94374),c=r(82863),o=r(40671),d=r(1272),u=r(19708),p=r(14585),f=r(26991),m=r(98128),y=r(47734),h=r(73697),v=r(23508),x=r(16533),b=r(14223),g=r(48182),I=r(15377);function A(){let[e,t]=(0,n.useState)({revenue:0,expense:0,profit:0,cash:0,vouchers:0}),[r,A]=(0,n.useState)([]);return(0,n.useEffect)(()=>{!async function(){var e;let[r,a]=await Promise.all([(0,u.x7)((0,u.H9)(p.db,"settings","app_settings")),(0,u.GG)((0,u.rJ)(p.db,"journal-vouchers"))]),n=(0,g.uJ)(null==(e=r.data())?void 0:e.financeAccounts),i=0,l=0,s=0,c={};a.forEach(e=>{let t=e.data(),r=(0,I.yZ)(t,n),a=(0,b.GP)((e=>{if(!e)return new Date;if("string"==typeof e){let t=new Date(e);return Number.isNaN(t.getTime())?new Date:t}if(e instanceof Date)return e;if("function"==typeof e.toDate){let t=e.toDate();return t instanceof Date?t:new Date}return"number"==typeof e.seconds?new Date(1e3*e.seconds):new Date})(t.date||t.createdAt),"MMM");r.forEach(e=>{"revenue"===e.accountType&&(i+=e.credit||0),"expense"===e.accountType&&(l+=e.debit||0),("cash"===e.accountType||"bank"===e.accountType)&&(s+=(e.debit||0)-(e.credit||0))});let o=r.reduce((e,t)=>e+t.amount,0);c[a]=(c[a]||0)+o});let o=Object.entries(c).map(e=>{let[t,r]=e;return{month:t,value:r}}),d=i-l;t({revenue:i,expense:l,profit:d,cash:s,vouchers:a.size}),A(o)}()},[]),(0,a.jsxs)("div",{className:"space-y-6 p-6",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-6 w-6 text-primary"}),"لوحة القيادة المالية"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[(0,a.jsx)(j,{title:"الإيرادات الكلية",value:e.revenue,icon:s.A,color:"text-green-600"}),(0,a.jsx)(j,{title:"المصروفات الكلية",value:e.expense,icon:c.A,color:"text-red-600"}),(0,a.jsx)(j,{title:"صافي الربح",value:e.profit,icon:o.A,color:"text-blue-600"}),(0,a.jsx)(j,{title:"إجمالي النقد",value:e.cash,icon:l.A,color:"text-teal-600"}),(0,a.jsx)(j,{title:"عدد القيود",value:e.vouchers,icon:d.A,color:"text-yellow-600"})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{children:"الأداء الشهري"})}),(0,a.jsx)(i.Wu,{children:(0,a.jsx)(f.u,{width:"100%",height:300,children:(0,a.jsxs)(m.E,{data:r,children:[(0,a.jsx)(y.W,{dataKey:"month"}),(0,a.jsx)(h.h,{}),(0,a.jsx)(v.m,{}),(0,a.jsx)(x.y,{dataKey:"value",fill:"#4f46e5",radius:[4,4,0,0]})]})})})]})]})}function j(e){let{title:t,value:r,icon:n,color:l}=e;return(0,a.jsxs)(i.Zp,{className:"shadow-md border",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:t}),(0,a.jsx)(n,{className:"h-5 w-5 ".concat(l)})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold text-right",children:[r.toLocaleString()," $"]})})]})}},48182:(e,t,r)=>{"use strict";r.d(t,{rN:()=>o,uJ:()=>c});let a=e=>(null!=e?e:"").trim(),n=(e,t)=>Array.from(new Set([...t,...Object.keys(e||{})])).reduce((t,r)=>(t[r]=a(null==e?void 0:e[r]),t),{}),i=e=>Object.values(e).find(e=>e.length>0)||"",l=["tickets","visas","subscriptions","segments","profit_distribution","other"],s=["tickets","visas","subscriptions","partners","operating","cost_tickets","cost_visas","operating_salaries","operating_rent","operating_utilities","marketing"];function c(e){let t={...(null==e?void 0:e.revenueMap)||{},...(null==e?void 0:e.customRevenues)||{}},r={...(null==e?void 0:e.expenseMap)||{},...(null==e?void 0:e.customExpenses)||{}},c=n(t,l),o=n(r,s),d=a((null==e?void 0:e.receivableAccountId)||(null==e?void 0:e.arAccountId)),u=a((null==e?void 0:e.payableAccountId)||(null==e?void 0:e.apAccountId)),p=a(null==e?void 0:e.generalRevenueId)||i(c),f=a(null==e?void 0:e.generalExpenseId)||i(o);return{receivableAccountId:d,payableAccountId:u,hybridRelationAccountId:a(null==e?void 0:e.hybridRelationAccountId),clearingAccountId:a(null==e?void 0:e.clearingAccountId),defaultCashId:a(null==e?void 0:e.defaultCashId),defaultBankId:a(null==e?void 0:e.defaultBankId),arAccountId:d,apAccountId:u,generalRevenueId:p,generalExpenseId:f,preventDirectCashRevenue:!!(null==e?void 0:e.preventDirectCashRevenue),revenueMap:c,expenseMap:o}}function o(e){let t=n(e.revenueMap||{},l),r=n(e.expenseMap||{},s),c=a(e.receivableAccountId),o=a(e.payableAccountId),d=a(e.generalRevenueId)||i(t),u=a(e.generalExpenseId)||i(r);return{receivableAccountId:c,payableAccountId:o,hybridRelationAccountId:a(e.hybridRelationAccountId),clearingAccountId:a(e.clearingAccountId),defaultCashId:a(e.defaultCashId),defaultBankId:a(e.defaultBankId),preventDirectCashRevenue:!!e.preventDirectCashRevenue,generalRevenueId:d,generalExpenseId:u,arAccountId:c,apAccountId:o,revenueMap:t,customRevenues:t,expenseMap:r,customExpenses:r}}},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i,pY:()=>l});var a=r(2821),n=r(75889);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}let l=(e,t,r,a)=>{let n={};return Object.keys(e).map(e=>e.toLowerCase().trim()),r.forEach(t=>{let r,i=null==a?void 0:a[t.id],l=(t.aliases||(null==i?void 0:i.aliases)||[t.label]).map(e=>e.toLowerCase().trim()),s=Array.from(new Set([t.id,t.label,...l].map(e=>e.toLowerCase().trim()))),c=Object.keys(e).find(e=>s.includes(e.toLowerCase().trim()));c&&(r=e[c]),null==r||""===String(r).trim()?n[t.id]=void 0!==t.defaultValue?t.defaultValue:"number"===t.dataType?0:"":"number"===t.dataType?n[t.id]=parseFloat(String(r).trim().replace(/,/g,""))||0:n[t.id]=String(r).trim()}),n}},82863:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},86948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>l,aR:()=>s,wL:()=>u});var a=r(95155),n=r(12115),i=r(64269);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",r),...n})});l.displayName="Card";let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-4 sm:p-6 text-right",r),...n})});s.displayName="CardHeader";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,i.cn)("text-lg sm:text-xl font-bold leading-none tracking-tight",r),...n})});c.displayName="CardTitle";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...n})});o.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-4 sm:p-6 pt-0",r),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-4 sm:p-6 pt-0",r),...n})});u.displayName="CardFooter"},94374:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},94972:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},98128:(e,t,r)=>{"use strict";r.d(t,{E:()=>c});var a=r(83946),n=r(16533),i=r(47734),l=r(73697),s=r(36164),c=(0,a.gu)({chartName:"BarChart",GraphicalChild:n.y,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:i.W},{axisType:"yAxis",AxisComp:l.h}],formatAxisMap:s.pr})}},e=>{e.O(0,[9135,7210,4909,5111,783,4223,1583,8441,1255,7358],()=>e(e.s=35033)),_N_E=e.O()}]);